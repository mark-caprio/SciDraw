(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    338783,       8473]
NotebookOptionsPosition[    302888,       7849]
NotebookOutlinePosition[    303424,       7870]
CellTagsIndexPosition[    303381,       7867]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Header comments", "Section",ExpressionUUID->"8b06d835-ca23-4649-b341-e2c6dd6b0072"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Title", ":", " ", "FigGeometry"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Context", ":", " ", "SciDraw`"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Summary", ":", " ", 
     RowBox[{
     "Geometry", " ", "utilities", " ", "needed", " ", "by", " ", "figure", 
      " ", "objects"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Author", ":", " ", 
      RowBox[{"Mark", " ", 
       RowBox[{"A", ".", " ", "Caprio"}]}]}]}], ",", " ", 
    RowBox[{"Department", " ", "of", " ", "Physics"}], ",", " ", 
    RowBox[{"University", " ", "of", " ", "Notre", " ", "Dame"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Copyright", ":", " ", 
      RowBox[{"Copyright", " ", "FIGYEAR"}]}]}], ",", " ", 
    RowBox[{"Mark", " ", 
     RowBox[{"A", ".", " ", "Caprio"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Package", " ", 
     RowBox[{"Version", ":", " ", "FIGVERSION"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Mathematica", " ", 
     RowBox[{"Version", ":", " ", "MATHVERSION"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Discussion", ":", " ", "FIGDISCUSSION"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"History", ":", " ", 
     RowBox[{"See", " ", "main", " ", "package", " ", 
      RowBox[{"file", "."}]}]}]}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 AutoIndent->False,
 CellChangeTimes->{{3.395093723328125*^9, 3.39509375184375*^9}, {
   3.398545735296875*^9, 3.39854574365625*^9}, 3.398799700609375*^9, {
   3.43024739209375*^9, 3.43024739990625*^9}, 3.430247813015625*^9, {
   3.436819738734375*^9, 3.436819746828125*^9}, 3.436820195484375*^9, {
   3.4439959535*^9, 3.4439959773125*^9}, {3.471089562875*^9, 
   3.471089568359375*^9}, {3.471089636203125*^9, 3.471089639046875*^9}, {
   3.48681044459375*^9, 3.4868104458125*^9}, {3.489687811140625*^9, 
   3.489687812484375*^9}, {3.497222348765625*^9, 3.497222354953125*^9}, 
   3.497224390546875*^9, {3.497299514859375*^9, 3.497299515046875*^9}, {
   3.49903536659375*^9, 3.49903536784375*^9}, {3.503265433671875*^9, 
   3.5032654415*^9}, {3.50612390383225*^9, 3.5061239087385*^9}, 
   3.507509920109375*^9, {3.51481857221875*^9, 3.514818754140625*^9}, 
   3.514822657671875*^9, {3.514823216234375*^9, 3.51482323709375*^9}, {
   3.51482326921875*^9, 3.514823311671875*^9}, {3.514823375546875*^9, 
   3.514823396890625*^9}, {3.5150157615*^9, 3.515015802921875*^9}, 
   3.515278625625*^9, {3.515611052734375*^9, 3.515611062421875*^9}},
 LanguageCategory->
  "NaturalLanguage",ExpressionUUID->"0432d776-9f62-4378-8f17-2251ee80b92c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin package", "Section",ExpressionUUID->"8500306f-5309-4fa4-a94f-0fe8ac50e766"],

Cell[CellGroupData[{

Cell["Package context definition", "Subsection",ExpressionUUID->"27af69a8-3a7c-497b-a168-025c1127263e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<SciDraw`\>\"", ",", "SciDraw`Private`$ExternalContexts"}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395087747453125*^9, 3.39508775096875*^9}, {
   3.39509064290625*^9, 3.395090643234375*^9}, 3.395090710546875*^9, {
   3.395091175015625*^9, 3.395091179703125*^9}, {3.395093472375*^9, 
   3.39509347784375*^9}, {3.395093608140625*^9, 3.3950936085*^9}, {
   3.395519039875*^9, 3.395519061546875*^9}, {3.495041989453125*^9, 
   3.495042010953125*^9}, {3.495042158078125*^9, 3.495042163671875*^9}, {
   3.497222416421875*^9, 3.497222462578125*^9}, {3.497222963890625*^9, 
   3.497222994640625*^9}, 3.497223030953125*^9, {3.514818766734375*^9, 
   3.514818800625*^9}, {3.5148197104375*^9, 3.514819710671875*^9}, {
   3.514819841546875*^9, 3.51481994284375*^9}, {3.514819979578125*^9, 
   3.514820025046875*^9}, {3.5148201316875*^9, 3.514820154671875*^9}, {
   3.51482025234375*^9, 3.514820275171875*^9}, {3.514820309703125*^9, 
   3.514820406921875*^9}, {3.51482051775*^9, 3.514820571328125*^9}, {
   3.514820843296875*^9, 3.51482087146875*^9}, 3.51482140903125*^9, {
   3.514821446859375*^9, 3.514821449890625*^9}, 3.514821641390625*^9, {
   3.514821674609375*^9, 3.514821798390625*^9}, {3.514823407859375*^9, 
   3.514823433140625*^9}, 3.51501104184375*^9, 3.515275343*^9, {
   3.515276331390625*^9, 3.51527633303125*^9}, {3.51542275479725*^9, 
   3.515422755141*^9}},ExpressionUUID->"7cbde085-3728-45cb-a91f-61d316bb3c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5aa1a9ed-2130-4fca-b068-e0b8330001c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin private context", "Subsection",ExpressionUUID->"323e4ee6-2179-4271-8255-28610275ce8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.514823442859375*^9, 
  3.5148234431875*^9}},ExpressionUUID->"548ec37e-fa4d-4180-a5af-c293de7aea89"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dependencies", "Subsection",
 CellChangeTimes->{{3.514821147359375*^9, 
  3.51482114978125*^9}},ExpressionUUID->"5b95c0e7-ead6-47bf-bc51-\
0696d6f56221"],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51482113128125*^9, 3.514821158515625*^9}, {
  3.514823452421875*^9, 
  3.51482349575*^9}},ExpressionUUID->"3f25264f-770a-40d1-9895-c7aec37e37d6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar/range/region arithmetic", "Section",
 CellChangeTimes->{{3.515362381890625*^9, 3.51536238459375*^9}, {
  3.51536254696875*^9, 3.515362547921875*^9}, {3.5154385657035*^9, 
  3.515438597937875*^9}, {3.5160372882395*^9, 
  3.516037292661375*^9}},ExpressionUUID->"c62091e9-a749-49c7-952a-\
cea1abb21a6c"],

Cell[CellGroupData[{

Cell["Single parameter upgrades", "Subsection",
 CellChangeTimes->{{3.51552677265625*^9, 
  3.515526788390625*^9}},ExpressionUUID->"4d8547ee-ea55-449f-861a-\
e7f035e734f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ScalarParameterPattern", "=", 
   RowBox[{"None", "|", 
    RowBox[{"(", 
     RowBox[{"_", "?", "NumericQ"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NonNegativeScalarParameterPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", "NonNegativePattern"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7691724215304646`*^9},ExpressionUUID->"aaa64ffe-500c-4b03-871e-\
fb98780c5852"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalar", "[", "None", "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalar", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", "x"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515526790796875*^9, 
  3.51552681421875*^9}},ExpressionUUID->"46c235a7-4077-4d0c-9332-\
f406abd1a235"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interval rescaling", "Subsection",
 CellChangeTimes->{{3.51568050853125*^9, 
  3.515680510921875*^9}},ExpressionUUID->"4dd6a85d-a63f-46c6-bb81-\
33b5a5a3186e"],

Cell["\<\
lambda wrapper for Rescale[u,{u1,u2},{v1,v2}]
   returns v1+(u-u1)/(u2-u1)*(v2-v1)\
\>", "Text",
 CellChangeTimes->{{3.518435352046875*^9, 3.51843535471875*^9}, {
  3.51843540059375*^9, 3.518435438921875*^9}, {3.5830763298686514`*^9, 
  3.5830763309086523`*^9}},ExpressionUUID->"15f1d8bb-db70-4d83-b8b6-\
04430dfc7914"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RescaleInterval", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u1_", "?", "NumericQ"}], ",", 
        RowBox[{"u2_", "?", "NumericQ"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v1_", "?", "NumericQ"}], ",", 
        RowBox[{"v2_", "?", "NumericQ"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"u_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Rescale", "[", 
    RowBox[{"u", ",", 
     RowBox[{"{", 
      RowBox[{"u1", ",", "u2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515680514625*^9, 3.515680567875*^9}, {
  3.518435429171875*^9, 
  3.51843543103125*^9}},ExpressionUUID->"69bcd6db-a049-4cb2-a744-\
d5168e5d64be"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Range testing", "Subsection",
 CellChangeTimes->{{3.5155270585625*^9, 
  3.51552706028125*^9}},ExpressionUUID->"25f278a2-36e3-4099-95cf-\
15f7dd8909c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x1", "\[LessEqual]", "x"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"x", "\[LessEqual]", "x2"}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"02d35cec-f403-4773-8521-7a2e838ee975"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1_", ",", "y2_"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "x"}], "]"}], "&&", 
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2"}], "}"}], ",", "y"}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5155270635*^9, 3.51552707109375*^9}, {
  3.52045229409375*^9, 
  3.52045229459375*^9}},ExpressionUUID->"5393dc3d-90a1-4a00-9d13-\
e785496d3a98"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interval extension by coordinate amount", "Subsection",
 CellChangeTimes->{{3.51536255090625*^9, 3.515362566421875*^9}, {
  3.51536267196875*^9, 3.515362677078125*^9}, {3.51604182739575*^9, 
  3.516041828661375*^9}},ExpressionUUID->"746b32b5-a1fa-4760-8976-\
91c9cad06d60"],

Cell["\<\
1-dimensional
Note: \[OpenCurlyDoubleQuote]Absolute\[CloseCurlyDoubleQuote] is \
SciDraw`Private legacy name.  Abs is accepted as global alternative.\
\>", "Text",
 CellChangeTimes->{{3.515796781015625*^9, 3.515796782875*^9}, {
  3.824311614680909*^9, 
  3.8243116349669113`*^9}},ExpressionUUID->"ac09b5cf-ac8d-4503-b401-\
1ad60124409d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendInterval", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"PDiff", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", 
      RowBox[{"(", 
       RowBox[{"Abs", "|", "Absolute"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PDiff", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendInterval", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"PFrac", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", "Scaled"}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PFrac", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "}"}], "*", 
     RowBox[{"-", 
      RowBox[{"Subtract", "@@", "PRange"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515362576421875*^9, 3.515362581484375*^9}, {
  3.51536268640625*^9, 3.51536270134375*^9}, {3.515362838828125*^9, 
  3.51536286996875*^9}, {3.515797065078125*^9, 3.515797076484375*^9}, {
  3.516456354671875*^9, 3.51645636353125*^9}, {3.5830783443606825`*^9, 
  3.5830783447356834`*^9}, {3.824311596053011*^9, 
  3.8243116052494383`*^9}},ExpressionUUID->"682543b7-081f-4599-b3de-\
1e01e2a8b72c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector geometry", "Section",
 CellChangeTimes->{{3.515617733140625*^9, 
  3.51561773625*^9}},ExpressionUUID->"597513ae-ec61-4327-8e7e-02237e64a943"],

Cell[CellGroupData[{

Cell["Trigonometry for 2D vectors", "Subsection",ExpressionUUID->"4d020102-9393-4ff0-a19d-dc7d6b3f59be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VectorLength", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"VectorArcTan", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", "0.", ",", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516775459375*^9, 
  3.5151677566875*^9}},ExpressionUUID->"14e15596-68f2-4a55-b4bc-129550a535e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SegmentLength", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"VectorLength", "[", 
    RowBox[{"p2", "-", "p1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentTangent", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p2", "-", "p1"}], ")"}], "/", 
    RowBox[{"VectorLength", "[", 
     RowBox[{"p2", "-", "p1"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"SegmentArcTan", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"VectorArcTan", "[", 
    RowBox[{"p2", "-", "p1"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516811021875*^9, 3.51516814440625*^9}, {
  3.519724204109375*^9, 
  3.519724222421875*^9}},ExpressionUUID->"409e9c99-41df-454f-b285-\
50c707ea9a6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FromPolar", "[", 
    RowBox[{"{", 
     RowBox[{"rho_", ",", "phi_"}], "}"}], "]"}], ":=", 
   RowBox[{"rho", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], ",", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51553846121875*^9, 
  3.515538463828125*^9}},ExpressionUUID->"8fc8b59e-cd59-423a-bacc-\
a6f1a74368ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Segment interpolation", "Subsection",
 CellChangeTimes->{{3.515854402640625*^9, 
  3.51585440940625*^9}},ExpressionUUID->"054c678b-7b17-4884-8cf3-\
bf84e65878b9"],

Cell["Null segment", "Text",
 CellChangeTimes->{{3.51585465534375*^9, 
  3.515854656921875*^9}},ExpressionUUID->"1a330b16-d6b7-4097-b0ed-\
f52dbedec146"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", 
       RowBox[{"(", 
        RowBox[{"Tail", "|", "Center", "|", "Head"}], ")"}]}], ",", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "\[Equal]", "0"}], 
     ")"}]}], ":=", "p1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515854413203125*^9, 3.515854436390625*^9}, {
  3.515854482703125*^9, 3.515854538578125*^9}, {3.51585457090625*^9, 
  3.51585464740625*^9}, {3.5158546831875*^9, 
  3.515854702359375*^9}},ExpressionUUID->"3ec1e1da-1dfb-43b1-b7ff-\
da5de00fcb4e"],

Cell["\<\
Generic segment
\tCurve parameter is always in the *forward* direction (tail to head).
\tMappings for scaled coordinates:
\t\tTail [0,+1] -> [p1,p2]
\t\tCenter [-1,+1] -> [p1,p2] -- so units are scaled by factor of two \
relative to other cases, consistent with \[OpenCurlyDoubleQuote]offset\
\[CloseCurlyDoubleQuote] relative position
\t\tHead [-1,0] -> [p1,p2]\
\>", "Text",
 CellChangeTimes->{{3.515854660328125*^9, 3.51585466196875*^9}, {
  3.515854857609375*^9, 3.5158549445625*^9}, {3.515855273109375*^9, 
  3.515855285484375*^9}, {3.516554483421875*^9, 3.51655449028125*^9}, {
  3.5195627235625*^9, 
  3.5195627449375*^9}},ExpressionUUID->"e581c467-d76e-4d15-bef2-953e31886a95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", "Tail"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "!=", "0"}], ")"}]}], 
   ":=", 
   RowBox[{"p1", "+", 
    RowBox[{"x", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p2", "-", "p1"}], ")"}], "/", 
      RowBox[{"Switch", "[", 
       RowBox[{"Mode", ",", "Absolute", ",", 
        RowBox[{"SegmentLength", "[", "s", "]"}], ",", "Scaled", ",", "1"}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", "Center"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "!=", "0"}], ")"}]}], 
   ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p2", "+", "p1"}], ")"}], "/", "2"}], "+", 
    RowBox[{"x", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p2", "-", "p1"}], ")"}], "/", 
      RowBox[{"Switch", "[", 
       RowBox[{"Mode", ",", "Absolute", ",", 
        RowBox[{"SegmentLength", "[", "s", "]"}], ",", "Scaled", ",", "2"}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", "Head"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "!=", "0"}], ")"}]}], 
   ":=", 
   RowBox[{"p2", "+", 
    RowBox[{"x", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p2", "-", "p1"}], ")"}], "/", 
      RowBox[{"Switch", "[", 
       RowBox[{"Mode", ",", "Absolute", ",", 
        RowBox[{"SegmentLength", "[", "s", "]"}], ",", "Scaled", ",", "1"}], 
       "]"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585466671875*^9, 3.515854669828125*^9}, {
   3.515854709953125*^9, 3.515854849453125*^9}, {3.515854962953125*^9, 
   3.5158550233125*^9}, 3.51655450759375*^9, {3.519562752203125*^9, 
   3.519562757796875*^9}},ExpressionUUID->"3f88e183-8f29-40c2-a03b-\
60351d4f2402"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["XY pair geometry", "Section",
 CellChangeTimes->{{3.516037254661375*^9, 
  3.5160372584895*^9}},ExpressionUUID->"3fb422f7-34e5-45a9-ba42-4adbebb3eea7"],

Cell[CellGroupData[{

Cell["Numerical pair pattern", "Subsection",
 CellChangeTimes->{{3.515438631812875*^9, 3.515438636281625*^9}, {
  3.516037225848875*^9, 
  3.516037231598875*^9}},ExpressionUUID->"7f8f4404-fdb2-48b1-84db-\
a55c1e136641"],

Cell["\<\
Explicit numerical {x,y} pair
Note: Text should use FigTextOffsetPattern instead, which allows the value \
Automatic as well.\
\>", "Text",
 CellChangeTimes->{{3.51568165675*^9, 3.515681698171875*^9}, {
  3.5156817973125*^9, 
  3.515681809296875*^9}},ExpressionUUID->"1328f93a-f502-4b85-b6c4-\
e8ac752d749f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumericalPairPattern", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515681661859375*^9, 3.51568166925*^9}, {
   3.51568173871875*^9, 3.515681740046875*^9}, 
   3.515681791296875*^9},ExpressionUUID->"e72ae4bf-7ba2-42c5-b68e-\
6b2959c4f9e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pair parameter upgrades", "Subsection",
 CellChangeTimes->{
  3.516037234848875*^9},ExpressionUUID->"220d66c5-7fe0-4b41-b996-\
c79302ffa734"],

Cell["\<\
Generic upgrade to equal values -- appropriate for radii and most types of \
nonnumeric parameters\
\>", "Text",
 CellChangeTimes->{{3.515525280671875*^9, 
  3.515525299515625*^9}},ExpressionUUID->"e4c26aea-197f-42ba-a6d1-\
2326f3a27dce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePair", "[", 
    RowBox[{"a", ":", "NonListPattern"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePair", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", ":", "NonListPattern"}], ",", 
      RowBox[{"y", ":", "NonListPattern"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.51552508746875*^9, 3.5155250899375*^9}, {
   3.515610756890625*^9, 
   3.51561077403125*^9}},ExpressionUUID->"a5ef9613-ea83-4eb1-ac41-\
ec37787ed464"],

Cell["\<\
Upgrade to default horizontal or default vertical numerical pair -- as in \
classic Nudge behavior\
\>", "Text",
 CellChangeTimes->{{3.51552530759375*^9, 
  3.515525343234375*^9}},ExpressionUUID->"dd27db5e-0cfb-455f-b0ec-\
efdaede14794"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IntervalParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonNegativeIntervalParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", "NonNegativePattern", "|", 
     RowBox[{"{", 
      RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
    ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515527647796875*^9, 3.51552765653125*^9}, {
  3.51561045678125*^9, 
  3.515610472046875*^9}},ExpressionUUID->"ffc2a010-81f3-4e28-86e4-\
6a5832525bd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairEqual", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairEqual", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairEqual", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.515525069765625*^9, 3.515525171546875*^9}, {
   3.515610823484375*^9, 
   3.515610835984375*^9}},ExpressionUUID->"5e70be12-b702-46e7-9247-\
e0afdf0cbb16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairHorizontal", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairHorizontal", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairHorizontal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.515525069765625*^9, 
   3.515525171546875*^9}},ExpressionUUID->"e7ff3dc5-adee-4814-8a7a-\
a847be3fb749"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairVertical", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairVertical", "[", 
    RowBox[{"y_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairVertical", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.515525069765625*^9, 3.5155250950625*^9}, {
   3.51552514259375*^9, 
   3.51552518078125*^9}},ExpressionUUID->"b88d4355-ebd3-45e5-b608-\
c65bb4346b36"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point/anchor geometry", "Section",
 CellChangeTimes->{{3.51516648646875*^9, 3.5151664916875*^9}, {
  3.515450145094125*^9, 3.515450145766*^9}, {3.515956528703125*^9, 
  3.515956529765625*^9}},ExpressionUUID->"b3f396e4-d7b9-4d65-9b0a-\
0af3db7522fd"],

Cell[CellGroupData[{

Cell["Point pattern", "Subsection",
 CellChangeTimes->{{3.51543946635975*^9, 3.515439471687875*^9}, 
   3.515439602219125*^9, {3.515450693812875*^9, 3.515450694531625*^9}, {
   3.51561552875*^9, 3.515615530546875*^9}, 3.515953613125*^9, 
   3.515956525796875*^9},ExpressionUUID->"844cb412-d655-4434-92e1-\
43a73d497d73"],

Cell["\<\
Point specification (including anchor name or object anchor generation).\
\>", "Text",
 CellChangeTimes->{{3.515439488187875*^9, 3.5154395102035*^9}, {
  3.515530327703125*^9, 3.515530335078125*^9}, {3.51553036696875*^9, 
  3.515530367734375*^9}, {3.515530668171875*^9, 3.515530676734375*^9}, {
  3.515608246390625*^9, 3.515608283140625*^9}, {3.515685208359375*^9, 
  3.515685209734375*^9}},ExpressionUUID->"a191442b-e957-414c-92df-\
8bdae7c0fd8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigCoordinatePointPattern", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], 
     "\[IndentingNewLine]", "}"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653109659375*^9, 3.5365311166875*^9}, {
  3.53653196265625*^9, 
  3.536531987046875*^9}},ExpressionUUID->"233df456-6195-488d-8ec1-\
0efd2a3963ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigPointPattern", "=", 
   RowBox[{"(", 
    RowBox[{"FigCoordinatePointPattern", "|", 
     RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
     RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515439472969125*^9, 3.51543948604725*^9}, {
   3.515450698281625*^9, 3.515450701687875*^9}, {3.515530339265625*^9, 
   3.5155303765*^9}, {3.515530557765625*^9, 3.515530569203125*^9}, {
   3.5155975314375*^9, 3.51559754925*^9}, {3.515597792984375*^9, 
   3.51559779728125*^9}, {3.515598279671875*^9, 3.515598286234375*^9}, {
   3.515613950328125*^9, 3.51561395671875*^9}, 3.515615579109375*^9, {
   3.515615903859375*^9, 3.515615912078125*^9}, {3.51561688265625*^9, 
   3.5156168859375*^9}, {3.515685177828125*^9, 3.515685200484375*^9}, 
   3.515883397828125*^9, 3.51810490809375*^9, {3.53653113275*^9, 
   3.5365311334375*^9}, {3.53653207609375*^9, 
   3.536532076421875*^9}},ExpressionUUID->"7a012d56-331d-4d27-bd70-\
d6701b758e89"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point resolution", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
  3.515616414640625*^9, 
  3.515616416671875*^9}},ExpressionUUID->"ceff645e-1060-45e9-8085-\
806ec0cab9ea"],

Cell["\<\
Resolves a point/anchor specification into canvas coordinates.

Note: This function is technically not necessary, since any valid point \
specification can be converted to an anchor with FigAnchor[p], and then the \
point part of the anchor can be extracted.  However, this function is more \
direct for ordinary numerical points, in that it avoids unnecessary creation \
of anchors for these points.\
\>", "Text",
 CellChangeTimes->{{3.515541825421875*^9, 3.515541838140625*^9}, {
   3.5156001483125*^9, 3.515600176546875*^9}, {3.515600221875*^9, 
   3.515600281890625*^9}, {3.51560485615625*^9, 3.515604856515625*^9}, {
   3.515861223421875*^9, 3.51586124259375*^9}, 
   3.51801844496875*^9},ExpressionUUID->"dd9b043f-fdfb-474a-b7c9-\
1b4a2ec35fe4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"TFunction", "[", "]"}]}], ")"}], "@", "p"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", "p"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledTFunction", "[", "]"}]}], ")"}], "@", "p"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"a", ":", 
     RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], "]"}], ":=", 
   RowBox[{"a", "@", 
    RowBox[{"GetPoint", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"n", ":", 
     RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Object", "[", "n", "]"}], "@", 
    RowBox[{"GetPoint", "[", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.51578413475*^9, 
   3.515784134765625*^9}, 3.518018521875*^9, 
   3.5180188034375*^9},ExpressionUUID->"3eabd834-23d8-4b22-b9e7-6d0516163c14"],

Cell["Ad hoc treatment of hybrid coordinates", "Text",
 CellChangeTimes->{{3.5365308433125*^9, 3.536530862453125*^9}, 
   3.577552241511182*^9},ExpressionUUID->"ed5c4429-6c9f-4663-b7ea-\
2c33698881fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ":", 
     RowBox[{"Except", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"y", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FigResolveCoordinate", "[", 
      RowBox[{"x", ",", "1"}], "]"}], ",", 
     RowBox[{"FigResolveCoordinate", "[", 
      RowBox[{"y", ",", "2"}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653087075*^9, 3.536530887890625*^9}, {
  3.536530960421875*^9, 
  3.536530998171875*^9}},ExpressionUUID->"0b3e10a2-8396-4dcd-a757-\
641173459304"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic bounding box generation for point-like objects", "Subsection",
 CellChangeTimes->{{3.515166674140625*^9, 3.515166694546875*^9}, {
  3.51545023029725*^9, 3.5154502318285*^9}, {3.515616428796875*^9, 
  3.515616447625*^9}},ExpressionUUID->"bf32a4d5-aae9-4d01-9f6e-232ab7cd365f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigPointBoundingBox", "[", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "y"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516616575*^9, 3.51516620196875*^9}, {
   3.515166363734375*^9, 3.51516642103125*^9}, {3.5151665123125*^9, 
   3.51516652478125*^9}, 3.515167326484375*^9, {3.515167359171875*^9, 
   3.515167378671875*^9}, {3.515167540625*^9, 3.515167556453125*^9}, {
   3.51545042535975*^9, 3.515450461031625*^9}, 3.516039158067625*^9, 
   3.524070974171875*^9},ExpressionUUID->"c00fceff-65c7-4a8d-b170-\
417de8cc6e30"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displacement geometry", "Section",
 CellChangeTimes->{{3.515615972609375*^9, 3.515615975328125*^9}, {
  3.51568593528125*^9, 
  3.51568594096875*^9}},ExpressionUUID->"cd14d738-076d-4103-8665-\
e8fe1fdcae0f"],

Cell["\<\
A \[OpenCurlyDoubleQuote]displacement\[CloseCurlyDoubleQuote] is a difference \
of positions, i.e., a vector describing a translation\
\>", "Text",
 CellChangeTimes->{{3.5830761548684063`*^9, 
  3.58307619338846*^9}},ExpressionUUID->"aa49749b-0f18-4d8b-b469-\
3fc3f4f55026"],

Cell[CellGroupData[{

Cell["Displacement patterns", "Subsection",
 CellChangeTimes->{{3.5156155039375*^9, 3.515615508109375*^9}, 
   3.515615550390625*^9},ExpressionUUID->"4cd66662-0e4d-4577-91cf-\
97ff2b1f14d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FigDisplacementPattern", "=", 
   RowBox[{"None", "|", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
      RowBox[{"Scaled", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}], "|", 
      RowBox[{"Canvas", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}]}], ")"}], "|", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigDisplacementSequencePattern", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"Repeated", "[", 
    RowBox[{
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"#", ",", "FigDisplacementPattern"}], "]"}], "&"}], ")"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "Infinity"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigDisplacementSetPattern", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Repeated", "[", 
     RowBox[{
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "FigDisplacementPattern"}], "]"}], "&"}], ")"}]}],
       ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Infinity"}], "}"}]}], "]"}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561556428125*^9, 3.515615591890625*^9}, {
  3.51561568934375*^9, 3.515615695046875*^9}, {3.51561684240625*^9, 
  3.515616847796875*^9}, {3.516284387*^9, 3.516284407734375*^9}, {
  3.520031935078125*^9, 3.520031936015625*^9}, {3.5775526127767015`*^9, 
  3.5775526158517056`*^9}},ExpressionUUID->"c8ef580a-4b2e-45b6-97cf-\
9a84e5777166"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FigResolveDisplacement", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
  3.51561598071875*^9, 
  3.51561598290625*^9}},ExpressionUUID->"8a29953a-ffd5-4da8-88a3-\
e64517e6f865"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", 
    RowBox[{"d", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", "d"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"d", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", "d"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"d", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledDeltaTFunction", "[", "]"}]}], ")"}], "@", "d"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515615986265625*^9, 3.5156160985*^9}, {3.51578413478125*^9, 
   3.5157841348125*^9}, {3.5200319503125*^9, 
   3.52003195840625*^9}},ExpressionUUID->"0c8bcf3e-ac3e-4053-a0b8-\
ae4d45f9f61a"],

Cell["Ad hoc treatment of hybrid coordinates", "Text",
 CellChangeTimes->{{3.5365308433125*^9, 3.536530862453125*^9}, 
   3.577552241511182*^9},ExpressionUUID->"97cbea6d-2000-4a2d-ba40-\
9202dc994624"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ":", 
     RowBox[{"Except", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"y", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FigResolveCoordinateDisplacement", "[", 
      RowBox[{"x", ",", "1"}], "]"}], ",", 
     RowBox[{"FigResolveCoordinateDisplacement", "[", 
      RowBox[{"y", ",", "2"}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653087075*^9, 3.536530887890625*^9}, {
  3.536530960421875*^9, 3.536530998171875*^9}, {3.577552251676196*^9, 
  3.5775522636462126`*^9}, {3.625166579988096*^9, 
  3.625166581813299*^9}},ExpressionUUID->"b4f6d0f3-7b69-4f70-8677-\
7322c7ef6a03"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Offset geometry", "Section",
 CellChangeTimes->{{3.519492514984375*^9, 
  3.519492516859375*^9}},ExpressionUUID->"da8a7640-0e41-4723-8ce9-\
e10aef3b3298"],

Cell["An \[OpenCurlyDoubleQuote]offset\[CloseCurlyDoubleQuote] is a relative \
position within a rectangle", "Text",
 CellChangeTimes->{{3.583076204708476*^9, 
  3.5830762239985027`*^9}},ExpressionUUID->"d1c9531c-1440-42ff-9244-\
419e69b6a2e4"],

Cell[CellGroupData[{

Cell["Named point offsets", "Subsection",
 CellChangeTimes->{{3.51585667196875*^9, 
  3.51585667590625*^9}},ExpressionUUID->"4b9c6edd-eaee-4b18-8526-\
5f91992ada9a"],

Cell[TextData[{
 "Note: These are the offsets ",
 StyleBox["to",
  FontSlant->"Italic"],
 " the point.  The offset of text attached to the point should be the \
negative of this."
}], "Text",
 CellChangeTimes->{{3.515856679296875*^9, 
  3.515856701953125*^9}},ExpressionUUID->"16046e26-52f0-4e70-8a9f-\
44c64a416371"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NamedPointPattern", "=", 
   RowBox[{
   "Center", "|", "Left", "|", "Right", "|", "Bottom", "|", "Top", "|", 
    "TopLeft", "|", "TopRight", "|", "BottomLeft", "|", "BottomRight"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51847362190625*^9, 3.518473625921875*^9}, {
  3.518473733375*^9, 
  3.518473772203125*^9}},ExpressionUUID->"a91dc002-d55b-4ba5-8dca-\
db186b70ac26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Center", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Left", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Right", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Bottom", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Top", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"+", "1"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585658321875*^9, 3.51585664778125*^9}, {
  3.51585670484375*^9, 
  3.5158567275625*^9}},ExpressionUUID->"5d8cf0b6-b26e-4c9e-8aac-d6b2483ef9b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "TopLeft", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"+", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "TopRight", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"+", "1"}], ",", 
     RowBox[{"+", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "BottomLeft", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "BottomRight", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"+", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51847356375*^9, 
  3.518473604984375*^9}},ExpressionUUID->"ee4b2479-30a4-4e61-ad98-\
10de1f9c434c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Realizing offset", "Subsection",
 CellChangeTimes->{{3.5194922451875*^9, 
  3.519492247734375*^9}},ExpressionUUID->"8df153fa-5fc9-4a82-a833-\
4ecb68a37a1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigOffsetPattern", "=", 
   RowBox[{"NamedPointPattern", "|", "NumericalPairPattern"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519492311796875*^9, 3.519492321453125*^9}, {
  3.519492469*^9, 
  3.5194924740625*^9}},ExpressionUUID->"dbc8d15d-f406-4788-96e1-d2345ab63df1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveOffset", "[", 
    RowBox[{"Offset", ":", "NamedPointPattern"}], "]"}], ":=", 
   RowBox[{"NamedPointOffset", "[", "Offset", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveOffset", "[", 
    RowBox[{"Offset", ":", "NumericalPairPattern"}], "]"}], ":=", "Offset"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519492248640625*^9, 3.519492290796875*^9}, {
  3.519492486625*^9, 3.519492493421875*^9}, {3.519495312078125*^9, 
  3.519495316453125*^9}},ExpressionUUID->"d8a08419-811b-4c0a-a2cb-\
c0dd703c09a5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Window/panel geometry", "Section",
 CellChangeTimes->{{3.51516648646875*^9, 3.5151664916875*^9}, {
  3.515617659953125*^9, 3.515617686125*^9}, {3.515782122671875*^9, 
  3.515782123171875*^9}, {3.51578499628125*^9, 
  3.515784997953125*^9}},ExpressionUUID->"4969ee0d-7f2f-4400-a1a7-\
a4e03e8d4820"],

Cell[CellGroupData[{

Cell["Generic numerical region pattern", "Subsection",
 CellChangeTimes->{{3.515342045546875*^9, 3.515342048015625*^9}, {
  3.515342428203125*^9, 3.515342429546875*^9}, {3.51603713177075*^9, 
  3.5160371333645*^9}, {3.516037165036375*^9, 
  3.516037205192625*^9}},ExpressionUUID->"191a5e99-43ab-41bb-a550-\
aecc0d8470a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RangeParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonNegativeRangeParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", "NonNegativePattern", "|", 
     RowBox[{"{", 
      RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
      "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumericalRegionPattern", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515353469921875*^9, 3.5153535245625*^9}, {
  3.515353653453125*^9, 3.515353654515625*^9}, {3.515353694734375*^9, 
  3.5153537149375*^9}, {3.515353797671875*^9, 3.515353826796875*^9}, {
  3.51603798577075*^9, 
  3.516038001177*^9}},ExpressionUUID->"3c025dec-8170-4d34-9e70-73395dc0fb58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic numerical region upgrade", "Subsection",
 CellChangeTimes->{{3.5160371906145*^9, 
  3.51603720895825*^9}},ExpressionUUID->"0466a1aa-1d99-446c-9184-\
ee66e26aae0f"],

Cell["\<\
for numeric data

general rules
\tx -> {x,x}
\t{x,y} -> {{x,x},{y,y}}
\t{{x1,x2},{y1,y2}} left unchanged
\t
special case
\tNone -> {{0,0},{0,0}}\
\>", "Text",
 CellChangeTimes->{{3.428181708328125*^9, 3.428181714515625*^9}, {
  3.459546646359375*^9, 3.45954666640625*^9}, {3.461090186078125*^9, 
  3.461090206421875*^9}, {3.461090554328125*^9, 3.461090557796875*^9}, {
  3.46694655503125*^9, 3.466946556640625*^9}, {3.515342181828125*^9, 
  3.51534226246875*^9}, {3.515342351140625*^9, 
  3.515342395984375*^9}},ExpressionUUID->"72c68f54-3713-4dee-a446-\
a0d32ce77b71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"xy_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{"xy", ",", "xy"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "x"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "y"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1_", "?", "NumericQ"}], ",", 
        RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y1_", "?", "NumericQ"}], ",", 
        RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", "None", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.428181740703125*^9, 3.4281817943125*^9}, {
   3.428181880328125*^9, 3.428181908125*^9}, {3.428182150109375*^9, 
   3.428182171484375*^9}, {3.42818246159375*^9, 3.42818248540625*^9}, 
   3.466946390578125*^9, 3.51534217165625*^9, {3.51534228034375*^9, 
   3.515342342328125*^9}, {3.5153424063125*^9, 3.515342420765625*^9}, 
   3.515353680546875*^9},ExpressionUUID->"9159f2ea-3c30-4795-baf3-\
3cfa52d7e647"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region extension by coordinate amount", "Subsection",
 CellChangeTimes->{{3.516041839880125*^9, 
  3.516041844802*^9}},ExpressionUUID->"8517de0e-6569-4125-bd74-1cb15f9d7a22"],

Cell["\<\
2-dimensional
Note: \[OpenCurlyDoubleQuote]Absolute\[CloseCurlyDoubleQuote] is \
SciDraw`Private legacy name.  Abs is accepted as global alternative.\
\>", "Text",
 CellChangeTimes->{{3.51579679171875*^9, 3.515796793390625*^9}, {
  3.5669433672474875`*^9, 3.5669433913275213`*^9}, {3.5669434945076656`*^9, 
  3.5669435408777304`*^9}, {3.5669436014378157`*^9, 3.566943650347884*^9}, {
  3.5830783778607297`*^9, 3.5830783793657317`*^9}, {3.824311659445977*^9, 
  3.8243116596912622`*^9}},ExpressionUUID->"424d210a-cdb1-462f-bd3d-\
e352562e9bec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PDiff", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", 
      RowBox[{"(", 
       RowBox[{"Abs", "|", "Absolute"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PDiff", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PFrac", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", "Scaled"}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PFrac", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "}"}], "*", 
     RowBox[{"-", 
      RowBox[{"Subtract", "@@@", "PRange"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.470920245828125*^9, 3.470920252046875*^9}, {
   3.515362535484375*^9, 3.51536253778125*^9}, {3.515362583265625*^9, 
   3.51536260653125*^9}, {3.515362687484375*^9, 3.515362709484375*^9}, 
   3.51536284434375*^9, {3.515362895421875*^9, 3.515362906125*^9}, 
   3.51536299653125*^9, {3.515797038171875*^9, 3.51579705753125*^9}, {
   3.51645637384375*^9, 3.51645638003125*^9}, {3.824311663467658*^9, 
   3.824311665715138*^9}},ExpressionUUID->"38ac8673-986e-4b41-b6ab-\
d8d80573febb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Window region specification pattern", "Subsection",
 CellChangeTimes->{{3.515782275453125*^9, 3.515782279703125*^9}, 
   3.51578499171875*^9},ExpressionUUID->"7f3bace2-c98e-453e-9f72-\
e035a68faf24"],

Cell["\<\
Note: Pattern excludes case {_Integer,_Integer}, for panel in multipanel \
array, since this case requires special treatment.\
\>", "Text",
 CellChangeTimes->{{3.5157847563125*^9, 
  3.515784790640625*^9}},ExpressionUUID->"4fa1e9fe-ffdb-4610-8ac9-\
a9c0487ee614"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigRegionPattern", "=", 
   RowBox[{"(", 
    RowBox[{"All", "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], "|", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515782131515625*^9, 3.515782173640625*^9}, {
   3.51578220403125*^9, 3.51578225421875*^9}, {3.51578477109375*^9, 
   3.515784771390625*^9}, 3.515784983671875*^9, 
   3.51628696821875*^9},ExpressionUUID->"42f91e3f-8743-4493-99eb-\
16a1d1a7f1ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region resolution", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
   3.515616414640625*^9, 3.515616416671875*^9}, {3.515784677796875*^9, 
   3.515784694203125*^9}, 3.515784985390625*^9, {3.5162867565625*^9, 
   3.516286756890625*^9}},ExpressionUUID->"231182e7-b90a-4c25-ae3f-\
0b6ef7c04883"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"r", ":", "All"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CurrentWindow", "[", "]"}], "@", 
     RowBox[{"CanvasRegion", "[", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"r", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"TransformRegion", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"TFunction", "[", "]"}]}], ",", "r"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], "]"}], ":=",
    "r"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"TransformRegion", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledTFunction", "[", "]"}]}], ",", "r"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.515782289078125*^9, 
   3.51578232515625*^9}, {3.515784012125*^9, 3.5157840259375*^9}, {
   3.5157841345625*^9, 3.51578425153125*^9}, {3.515784491796875*^9, 
   3.51578457575*^9}, {3.515784696953125*^9, 3.5157847003125*^9}, {
   3.515784985828125*^9, 3.5157849881875*^9}, {3.51628696884375*^9, 
   3.51628697021875*^9}, {3.5334151966875*^9, 3.533415201578125*^9}, 
   3.5334152335625*^9},ExpressionUUID->"85e37387-dd84-42ed-898c-d1b1a33a073f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region extension", "Subsection",
 CellChangeTimes->{{3.5162860230625*^9, 3.51628602884375*^9}, {
  3.51628675059375*^9, 
  3.5162867515625*^9}},ExpressionUUID->"425d3d91-add6-4ff7-84ab-7fca8959119e"],

Cell["\<\
Programmer level functions -- working in canvas coordinates
Serve to resolve \[OpenCurlyDoubleQuote]delta region patterns\
\[CloseCurlyDoubleQuote] to adjustments which can be handled arithmetically \
by ExtendRegion
Here \[OpenCurlyDoubleQuote]Scaled\[CloseCurlyDoubleQuote] refers to a \
fraction of the region which is being expanded, not of the current window.\
\>", "Text",
 CellChangeTimes->{{3.516286740265625*^9, 3.51628679584375*^9}, {
  3.516286830875*^9, 3.51628684359375*^9}, {3.520528652796875*^9, 
  3.520528657046875*^9}, {3.5830801838869057`*^9, 3.5830801912501187`*^9}, {
  3.5830810836947255`*^9, 
  3.5830811069387665`*^9}},ExpressionUUID->"d462fb70-a53f-425d-8b08-\
3f50ebdb7d56"],

Cell["\<\
FigResolveRegionExtension converts a user-acceptable region extension and \
returns arguments {{{x1,x2},{y1,y2}},{dx1,dx2},{dy1,dy2},Absolute|Scaled}  \
for use with ExtendRegion.\
\>", "Text",
 CellChangeTimes->{{3.6228398100573626`*^9, 3.6228398648914585`*^9}, {
  3.6228414516326456`*^9, 3.6228414565622544`*^9}, {3.6228415244535737`*^9, 
  3.6228415522216225`*^9}},ExpressionUUID->"cd14afed-11c6-42f1-bca0-\
94459be6a40d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"d", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "0", "]"}], ",", "Absolute"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"d", ":", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "0.02", "]"}], ",", "Scaled"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"d", ":", "RangeParametersPattern"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"TransformRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CurrentWindow", "[", "]"}], "@", 
        RowBox[{"DeltaTFunction", "[", "]"}]}], ",", 
       RowBox[{"UpgradeRangeParameters", "[", "d", "]"}]}], "]"}], ",", 
     "Absolute"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Canvas", "[", 
      RowBox[{"d", ":", "RangeParametersPattern"}], "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "d", "]"}], ",", "Absolute"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Scaled", "[", 
      RowBox[{"d", ":", "RangeParametersPattern"}], "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "d", "]"}], ",", "Scaled"}], 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516286496359375*^9, 3.51628649825*^9}, {
  3.516286544375*^9, 3.51628656809375*^9}, {3.5162866254375*^9, 
  3.516286687359375*^9}, {3.516286803796875*^9, 3.516286875703125*^9}, {
  3.51628823759375*^9, 3.516288243828125*^9}, {3.5181196755625*^9, 
  3.518119676328125*^9}, {3.51811982978125*^9, 3.51811985040625*^9}, {
  3.5181199225625*^9, 3.51811992603125*^9}, {3.566943272207354*^9, 
  3.5669432722373543`*^9}, {3.5830811196371884`*^9, 3.583081141695627*^9}, {
  3.6228396474582767`*^9, 3.6228397313708243`*^9}, {3.622841387235733*^9, 
  3.622841432990613*^9}},ExpressionUUID->"c1571acb-c147-4aee-bb26-\
d0bdc9e0dfa3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General adjustment of region", "Subsection",
 CellChangeTimes->{{3.58308020895615*^9, 
  3.583080223167775*^9}},ExpressionUUID->"edbf93da-bd00-47b5-bc12-\
0319f5bd946b"],

Cell["\<\
User-level wrapper
\tReturns result as valid region specification, wrapped in Canvas[]\
\>", "Text",
 CellChangeTimes->{{3.516286908109375*^9, 3.516286915203125*^9}, {
  3.518124271375*^9, 3.518124278109375*^9}, {3.52052866159375*^9, 
  3.52052868296875*^9}},ExpressionUUID->"14ab2b9f-d408-404d-8b58-\
83c7276965d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigDeltaRegionPattern", "=", 
   RowBox[{"Automatic", "|", "None", "|", "RangeParametersPattern", "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", "RangeParametersPattern",
      "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515782131515625*^9, 3.515782173640625*^9}, {
   3.51578220403125*^9, 3.51578225421875*^9}, {3.51578477109375*^9, 
   3.515784771390625*^9}, 3.515784983671875*^9, {3.51628624659375*^9, 
   3.516286258796875*^9}, {3.516286295140625*^9, 3.51628630284375*^9}, {
   3.516286340328125*^9, 3.516286342234375*^9}, {3.5830810733363075`*^9, 
   3.583081074334709*^9}},ExpressionUUID->"39037e7f-6d5f-48e2-b431-\
497492ee088d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AdjustRegion", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RegionExtension", "\[Rule]", "None"}], ",", 
     RowBox[{"RegionDisplacement", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdjustRegion", "[", 
    RowBox[{
     RowBox[{"r", ":", "FigRegionPattern"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOptions", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Opts", ",", 
           RowBox[{"Options", "[", "AdjustRegion", "]"}]}], "}"}], "]"}]}], 
       ",", "CanvasRegion"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"validate", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "AdjustRegion", ",", "RegionDisplacement", ",", 
        "FigDisplacementPattern", ",", "FullOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "AdjustRegion", ",", "RegionExtension", ",", "FigDeltaRegionPattern", 
        ",", "FullOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "resolve", " ", "given", " ", "region", " ", "to", " ", "canvas", " ", 
        "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"FigResolveRegion", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "displacement"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"CanvasRegion", "+", 
        RowBox[{"FigResolveDisplacement", "[", 
         RowBox[{"(", 
          RowBox[{"RegionDisplacement", "/.", "FullOptions"}], ")"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "extension"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"ExtendRegion", "@@", 
        RowBox[{"FigResolveRegionExtension", "[", 
         RowBox[{"CanvasRegion", ",", 
          RowBox[{"(", 
           RowBox[{"RegionExtension", "/.", "FullOptions"}], ")"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Canvas", "[", "CanvasRegion", "]"}]}]}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "AdjustRegion", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5830791169805884`*^9, 3.583079133858348*^9}, {
  3.583079202241898*^9, 3.5830793635706263`*^9}, {3.5830795570882845`*^9, 
  3.583079561313526*^9}, {3.583079885104046*^9, 3.5830800708646708`*^9}, {
  3.583081516002678*^9, 3.5830815210726852`*^9}, {3.583081673146535*^9, 
  3.5830816749405384`*^9}, {3.5836974442451077`*^9, 3.5836974601051297`*^9}, {
  3.6228397932249327`*^9, 
  3.62283980306855*^9}},ExpressionUUID->"1842d6e7-0205-449c-a592-\
f2a2103222b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region points", "Subsection",
 CellChangeTimes->{{3.51827685290625*^9, 
  3.518276860484375*^9}},ExpressionUUID->"dae6e2ce-9c90-4940-a8b5-\
e3509f1a7586"],

Cell["User-level region point extraction", "Text",
 CellChangeTimes->{{3.518276874921875*^9, 
  3.51827688321875*^9}},ExpressionUUID->"90e37eff-d7e8-410c-b192-\
ed244d306081"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RegionPoint", "[", 
    RowBox[{
     RowBox[{"r", ":", "FigRegionPattern"}], ",", 
     RowBox[{"Offset", ":", "FigOffsetPattern"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "UsedOffset", ",", "CanvasRegion", ",", "CanvasCenter", ",", 
       "CanvasRadius"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resolve", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UsedOffset", "=", 
       RowBox[{"FigResolveOffset", "[", "Offset", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"FigResolveRegion", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{"Mean", "/@", "CanvasRegion"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"Subtract", "@@@", "CanvasRegion"}], ")"}]}], "/", "2"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "offset", " ", "point"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Canvas", "[", 
       RowBox[{"CanvasCenter", "+", 
        RowBox[{"UsedOffset", "*", "CanvasRadius"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518276869859375*^9, 3.518276948953125*^9}, {
  3.518276992453125*^9, 3.518277104421875*^9}, {3.51951058934375*^9, 
  3.51951061803125*^9}},ExpressionUUID->"1660b61f-bb6d-480e-89ca-\
cbb2daa3f384"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Object set bounding box", "Subsection",
 CellChangeTimes->{{3.51603589645825*^9, 
  3.516035901380125*^9}},ExpressionUUID->"d3db13c8-9fc5-4c98-a0d8-\
7b4a5d0414d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractBoundingBox", "[", 
    RowBox[{
     RowBox[{"Object", "[", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], "]"}], "|", 
     RowBox[{"(", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], ")"}]}], "]"}],
    ":=", 
   RowBox[{"FigPointBoundingBox", "[", 
    RowBox[{
     RowBox[{"Object", "[", "n", "]"}], "@", 
     RowBox[{"GetPoint", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractBoundingBox", "[", 
    RowBox[{
     RowBox[{"Object", "[", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], "]"}], "|", 
     RowBox[{"(", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}]}], "]"}],
    ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Object", "[", "n", "]"}], "@", 
     RowBox[{"MakeBoundingBox", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51603773045825*^9, 3.516037752630125*^9}, {
  3.51603778345825*^9, 
  3.516037850130125*^9}},ExpressionUUID->"c195e96c-075b-45ad-bd1c-\
d236e968698c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ObjectCanvasBox", "[", 
    RowBox[{"ObjectList", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectPattern", "[", "FigObject", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}], 
       ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RegionList", ",", "ExtremumLists"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionList", "=", 
       RowBox[{"(", 
        RowBox[{"ExtractBoundingBox", "/@", "ObjectList"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtremumLists", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", "RegionList", ",", "2"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xminlist", ",", "xmaxlist"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"yminlist", ",", "ymaxlist"}], "}"}]}], "}"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Max", ",", 
        RowBox[{"MapAt", "[", 
         RowBox[{"Min", ",", "ExtremumLists", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516037549973875*^9, 3.516037630848875*^9}, {
   3.516037863911375*^9, 3.516037898255125*^9}, {3.51603849195825*^9, 
   3.5160386641145*^9}, {3.516038847942625*^9, 3.516038848848875*^9}, {
   3.516038953223875*^9, 3.516038959161375*^9}, 3.51604321702075*^9, {
   3.516043256630125*^9, 
   3.51604328527075*^9}},ExpressionUUID->"0343383c-c517-40d8-a256-\
87a2da2ba6b8"],

Cell["User-level bounding region function", "Text",
 CellChangeTimes->{{3.583082700711568*^9, 
  3.583082710455468*^9}},ExpressionUUID->"2e679560-f799-413a-9978-\
f1b1bc131487"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BoundingBox", "[", "\[IndentingNewLine]", 
    RowBox[{"ObjectList", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectPattern", "[", "FigObject", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}], 
       ".."}], "}"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "BoundingBox", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Canvas", "[", 
       RowBox[{"ObjectCanvasBox", "[", "ObjectList", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BoundingBox", "[", "\[IndentingNewLine]", 
    RowBox[{"obj", ":", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
        RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}], "|", 
        RowBox[{"ObjectPattern", "[", "FigObject", "]"}], "|", 
        RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}], 
      ")"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"BoundingBox", "[", 
    RowBox[{"{", "obj", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "BoundingBox", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516037549973875*^9, 3.516037630848875*^9}, {
  3.516037863911375*^9, 3.516037898255125*^9}, {3.51603849195825*^9, 
  3.5160386641145*^9}, {3.516038847942625*^9, 3.516038848848875*^9}, {
  3.516038953223875*^9, 3.516038959161375*^9}, {3.51604318177075*^9, 
  3.516043185630125*^9}, {3.516285789828125*^9, 3.516285817*^9}, {
  3.51827666221875*^9, 3.518276690953125*^9}, {3.518277205515625*^9, 
  3.51827721*^9}, {3.518277416671875*^9, 3.518277417234375*^9}, {
  3.583082644399453*^9, 3.583082692317689*^9}, {3.7098176886636157`*^9, 
  3.709817708553651*^9}, {3.7098178530879045`*^9, 
  3.7098178570035114`*^9}},ExpressionUUID->"3c1a43ef-97b4-4e48-884c-\
50034a54a186"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Edge-type parameter list interpretation", "Section",
 CellChangeTimes->{{3.515342435171875*^9, 3.515342438984375*^9}, {
  3.516037020661375*^9, 3.5160370247395*^9}, {3.516037068927*^9, 
  3.516037072755125*^9}},ExpressionUUID->"5fc14890-069c-405f-afa0-\
f638f7f5479d"],

Cell[TextData[{
 "modeled on FrameLabel, etc.\n\ngeneral rules\n\t[B -> {B,B} -- contrary to ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " FrameLabel behavior {B,X}]\n\t\tThis case is usually only reasonable a \
boolean parameter or a style parameter.  \n\t\t\tPattern: \
EdgeXYSameParametersPattern[patt]\n\t\tOther properties are XY properties, \
and a value appropriate to X should never propagate to Y, except perhaps the \
value None.\n\t\t\tPatterns: EdgeXYUniqueParametersPattern[patt]\n\t\tIt is \
up to the *pattern* to exclude other possibilities, such as AxisLabel->\
\[CloseCurlyDoubleQuote]x\[CloseCurlyDoubleQuote].\n\t{B,L} -> {{L,X},{B,X}}  \
  no mirroring\n\t\tor {{L,L},{B,B}}    mirroring\n\t{{L,R},{B,T}} left \
unchanged\nlegacy list format rules\n\t{B} was legitimate legacy case but is \
disallowed in present conversion\n\t{B,L,T} was legitimate legacy case but is \
disallowed in present conversion\n\t{B,L,T,R}->{{L,R},{B,T}}\nwhere X is \
given filler\n\nNo special treatment is imposed on the value None.  For \
instance, it is not translated into Filler."
}], "Text",
 CellChangeTimes->{{3.428181708328125*^9, 3.428181714515625*^9}, {
   3.459546646359375*^9, 3.45954666640625*^9}, {3.461090186078125*^9, 
   3.461090206421875*^9}, {3.461090554328125*^9, 3.461090557796875*^9}, {
   3.46694655503125*^9, 3.466946556640625*^9}, {3.515342181828125*^9, 
   3.51534226246875*^9}, {3.515342351140625*^9, 3.515342395984375*^9}, {
   3.515342455484375*^9, 3.515342456296875*^9}, {3.5153424865625*^9, 
   3.515342722703125*^9}, {3.515343454640625*^9, 3.51534347678125*^9}, {
   3.515343518859375*^9, 3.51534356825*^9}, {3.515352454421875*^9, 
   3.515352461703125*^9}, 3.515352506265625*^9, {3.515353016171875*^9, 
   3.5153530378125*^9}, 3.516037036317625*^9, {3.5163893819375*^9, 
   3.516389413859375*^9}, {3.516389500359375*^9, 3.516389507171875*^9}, {
   3.516389546109375*^9, 3.516389573234375*^9}, {3.516389608390625*^9, 
   3.51638961084375*^9}, {3.516389642671875*^9, 3.516389692671875*^9}, {
   3.516389761671875*^9, 3.51638995615625*^9}, {3.516390130078125*^9, 
   3.5163901309375*^9}, {3.5163909391875*^9, 3.5163909453125*^9}, {
   3.5163911913125*^9, 3.516391221421875*^9}, {3.51639199809375*^9, 
   3.51639202265625*^9}, {3.516461558421875*^9, 
   3.516461601984375*^9}},ExpressionUUID->"53ffffb5-0818-445e-9cb4-\
aa15b8bf4f5c"],

Cell["\<\
example usage: 
\tEdgeParametersPattern[NonListPattern]) -- includes None as allowable case
\tNone|EdgeParametersPattern[FlatListPattern]\
\>", "Text",
 CellChangeTimes->{{3.51579191709375*^9, 3.515791919203125*^9}, {
  3.515791977453125*^9, 3.51579200184375*^9}, {3.51579204621875*^9, 
  3.51579205353125*^9}, {3.515792145578125*^9, 
  3.5157921623125*^9}},ExpressionUUID->"97acfb9b-e7b2-4459-8965-77bcb23f9ee8"],

Cell[CellGroupData[{

Cell["Masking of edge options", "Subsection",
 CellChangeTimes->{{3.5163955378125*^9, 
  3.516395540625*^9}},ExpressionUUID->"d7b6ac20-dfbf-4350-b533-ea3833a632d7"],

Cell["\<\
EdgeMaskingFunction[DataEntry_,MaskEntry_,ExteriorEdgeMaskEntry_,Filler_] \
masks DataEntry, i.e., returning either DataEntry or Filler.  DataEntry is \
returned if the mask value is True or is Exterior on an exterior edge (as \
indicated by ExteriorEdgeMaskEntry).\
\>", "Text",
 CellChangeTimes->{{3.579102750238942*^9, 
  3.5791028246354723`*^9}},ExpressionUUID->"8bf8a1ab-2247-404a-bf1e-\
09263d052af4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EdgeMaskingFunction", "[", 
    RowBox[{
    "DataEntry_", ",", "MaskEntry_", ",", "ExteriorEdgeMaskEntry_", ",", 
     "Filler_"}], "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"MaskEntry", "===", "True"}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MaskEntry", "===", "Exterior"}], ")"}], "&&", 
        "ExteriorEdgeMaskEntry"}], ")"}]}], ",", "\[IndentingNewLine]", 
     "DataEntry", ",", "\[IndentingNewLine]", "Filler"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5164602644375*^9, 3.51646040815625*^9}, {
  3.516460634953125*^9, 
  3.516460635828125*^9}},ExpressionUUID->"991715bf-ba9f-460c-8427-\
b3017936153d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MaskEdgeOption", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Mask", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exterior", "|", "LogicalPattern"}], ",", 
          RowBox[{"Exterior", "|", "LogicalPattern"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exterior", "|", "LogicalPattern"}], ",", 
          RowBox[{"Exterior", "|", "LogicalPattern"}]}], "}"}]}], "}"}]}], 
     ",", 
     RowBox[{"ExteriorEdgeMask", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LogicalPattern", ",", "LogicalPattern"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"LogicalPattern", ",", "LogicalPattern"}], "}"}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", "Filler_"}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"EdgeMaskingFunction", "[", 
       RowBox[{"##", ",", "Filler"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Data", ",", "Mask", ",", "ExteriorEdgeMask"}], "}"}], ",", 
     "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516395320109375*^9, 3.51639548109375*^9}, {
  3.516460135921875*^9, 3.51646021159375*^9}, {3.516460251640625*^9, 
  3.51646026215625*^9}, {3.516460507125*^9, 3.516460513171875*^9}, {
  3.516460636296875*^9, 
  3.516460643921875*^9}},ExpressionUUID->"02474cad-029a-489a-a29b-\
93ef01389a2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Automatic values for edge options", "Subsection",
 CellChangeTimes->{{3.5163955378125*^9, 3.516395540625*^9}, {
  3.579102839549099*^9, 
  3.579102845289909*^9}},ExpressionUUID->"a380a186-0162-406b-a519-\
91cca1467c6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResolveAutomaticEdgeOption", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Defaults", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#1", ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", "\[Rule]", "#2"}], "}"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Data", ",", "Defaults"}], "}"}], ",", "\[IndentingNewLine]", 
     "2"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516395320109375*^9, 3.51639548109375*^9}, {
   3.516460135921875*^9, 3.51646021159375*^9}, {3.516460251640625*^9, 
   3.51646026215625*^9}, {3.516460507125*^9, 3.516460513171875*^9}, {
   3.516460636296875*^9, 3.516460643921875*^9}, {3.5791028530431223`*^9, 
   3.5791029554261026`*^9}, 
   3.5791044306453896`*^9},ExpressionUUID->"3d8afee7-cab1-45e1-ac73-\
f94ee02fe18d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResolveAutomaticEdgeOption", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "Automatic"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "8"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.579104379115317*^9, 3.579104394875339*^9}, {
  3.579104437145398*^9, 
  3.5791044381253996`*^9}},ExpressionUUID->"b2d9a979-b36e-4fac-8a6f-\
530f686c5e88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.579104396425341*^9, {3.5791044338453937`*^9, 
   3.5791044385053997`*^9}},ExpressionUUID->"37f65caf-037e-4cc5-8ed9-\
39b348fc603b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single-coordinate geometry", "Section",
 CellChangeTimes->{{3.516047466036375*^9, 
  3.51604747252075*^9}},ExpressionUUID->"37225bb2-d265-4afe-b3d9-\
facf8beba937"],

Cell[CellGroupData[{

Cell["Single-coordinate pattern", "Subsection",
 CellChangeTimes->{{3.51604749777075*^9, 
  3.51604750070825*^9}},ExpressionUUID->"3ef2ced8-a5dc-4628-9bad-\
342d878058e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigCoordinatePattern", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
      RowBox[{"(", 
       RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}], "|", "FigPointPattern"}],
     ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516047483817625*^9, 3.516047488973875*^9}, {
  3.51604754014575*^9, 
  3.516047540927*^9}},ExpressionUUID->"bd8ceb63-716e-4be9-a5e0-1a7e8789849f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Complementary coordinate index", "Subsection",
 CellChangeTimes->{{3.51846246559375*^9, 
  3.518462470828125*^9}},ExpressionUUID->"01ea9b72-98dc-419e-b8ee-\
398ba4a4e3d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AntiCoordinateIndex", "[", "1", "]"}], "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AntiCoordinateIndex", "[", "2", "]"}], "=", "1"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518462472265625*^9, 
  3.518462495203125*^9}},ExpressionUUID->"f9aab622-8215-459e-b311-\
d68ccf5a5155"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpret Horizontal/Vertical as coordinate indices", "Subsection",
 CellChangeTimes->{{3.516047836130125*^9, 3.51604784989575*^9}, {
  3.5833521853867435`*^9, 
  3.5833521882167473`*^9}},ExpressionUUID->"422130ac-c03e-4a59-a822-\
3da098ea415e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateIndex", "[", "Horizontal", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateIndex", "[", "Vertical", "]"}], "=", "2"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.5833521912667513`*^9, 
   3.5833522121567802`*^9}},ExpressionUUID->"c4a922a3-ad46-42ef-8889-\
f8c03596e92c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion of coordinate system for individual coordinate", "Subsection",
 CellChangeTimes->{{3.5160473852395*^9, 
  3.516047397802*^9}},ExpressionUUID->"93583acd-124e-4427-99ff-4d51c443bb24"],

Cell["\<\
must come *after* point geometry, since uses FigPointPattern
can be used eith to convert a single coordinate to canvas coordinates or to \
extract canvas coordinate from a point\
\>", "Text",
 CellChangeTimes->{{3.516293167375*^9, 3.5162931786875*^9}, {
  3.5184615730625*^9, 3.51846158109375*^9}, {3.5184616460625*^9, 
  3.518461646640625*^9}, {3.518461720234375*^9, 
  3.518461752*^9}},ExpressionUUID->"075a172e-2790-49d0-bee3-96236b6b031a"],

Cell["Conversions", "Text",
 CellChangeTimes->{{3.516047858411375*^9, 
  3.516047864598875*^9}},ExpressionUUID->"ec4f886c-041c-47aa-a0c3-\
2de6c93cdc1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolvePoint", "[", 
     RowBox[{"x", "*", 
      RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolvePoint", "[", 
     RowBox[{"Scaled", "[", 
      RowBox[{"x", "*", 
       RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "]"}], 
    "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolvePoint", "[", "p", "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.5184621599375*^9, 
   3.518462185796875*^9}},ExpressionUUID->"ae24056b-9377-48b9-9b6a-\
b614ad996ad0"],

Cell["Interpret Horizontal/Vertical as arguments", "Text",
 CellChangeTimes->{{3.516047836130125*^9, 
  3.51604784989575*^9}},ExpressionUUID->"ca48d755-cb8e-4e07-b916-\
bf9723a86ea6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x_", ",", "Horizontal"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x_", ",", "Vertical"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 
   3.5160478323645*^9}},ExpressionUUID->"d2e6cdff-d228-4056-ad7f-\
0c0383659f06"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion of coordinate system for individual coordinate", "Subsection",
 CellChangeTimes->{{3.5160473852395*^9, 
  3.516047397802*^9}},ExpressionUUID->"19367298-6d27-4738-9eb3-3546ff854236"],

Cell["Conversions", "Text",
 CellChangeTimes->{{3.516047858411375*^9, 
  3.516047864598875*^9}},ExpressionUUID->"587e0f7f-82e0-47aa-bdf3-\
a82102082fd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolveDisplacement", "[", 
     RowBox[{"x", "*", 
      RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolveDisplacement", "[", 
     RowBox[{"Scaled", "[", 
      RowBox[{"x", "*", 
       RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "]"}], 
    "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolveDisplacement", "[", "p", "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.5184621599375*^9, 3.518462185796875*^9}, {3.5775521056959915`*^9, 
   3.5775521493110523`*^9}},ExpressionUUID->"6ee15a68-bea9-4b45-8338-\
679c9cb3af4f"],

Cell["Interpret Horizontal/Vertical as arguments", "Text",
 CellChangeTimes->{{3.516047836130125*^9, 
  3.51604784989575*^9}},ExpressionUUID->"a5caf2a9-74ef-4d1a-ab06-\
6630d19666f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x_", ",", "Horizontal"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x_", ",", "Vertical"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.577552122316015*^9, 
   3.5775521265760207`*^9}},ExpressionUUID->"7e25327e-0833-4870-a3fa-\
ee11ba519b8f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point set geometry", "Section",
 CellChangeTimes->{{3.515953547734375*^9, 
  3.515953550140625*^9}},ExpressionUUID->"55ca212a-8061-4119-a86b-\
8487a7ec2f65"],

Cell[CellGroupData[{

Cell["Point set pattern", "Subsection",
 CellChangeTimes->{{3.515883408046875*^9, 3.515883414421875*^9}, {
  3.5159535560625*^9, 
  3.515953556546875*^9}},ExpressionUUID->"673c594a-37af-42c9-b867-\
8aa006d0f39d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigPointSetPattern", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Repeated", "[", 
     RowBox[{"FigPointPattern", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Infinity"}], "}"}]}], "]"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515439472969125*^9, 3.51543948604725*^9}, {
   3.515450698281625*^9, 3.515450701687875*^9}, {3.515530339265625*^9, 
   3.5155303765*^9}, {3.515530557765625*^9, 3.515530569203125*^9}, {
   3.5155975314375*^9, 3.51559754925*^9}, {3.515597792984375*^9, 
   3.51559779728125*^9}, {3.515598279671875*^9, 3.515598286234375*^9}, {
   3.515613950328125*^9, 3.51561395671875*^9}, 3.515615579109375*^9, {
   3.515615903859375*^9, 3.515615912078125*^9}, {3.51561688265625*^9, 
   3.5156168859375*^9}, {3.515685177828125*^9, 3.515685200484375*^9}, {
   3.515883397828125*^9, 3.51588342459375*^9}, {3.515953558234375*^9, 
   3.51595355859375*^9}},ExpressionUUID->"acde4043-b29b-4a43-9fb8-\
3f476e160137"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Centroid of point set", "Subsection",
 CellChangeTimes->{{3.515605128859375*^9, 
  3.51560513228125*^9}},ExpressionUUID->"9647cacc-7d36-4c65-8fdd-\
1ae26076d57c"],

Cell["\<\
Note: Returns a Canvas point specification, rather than just a canvas \
coordinate pair.  This is so the user can use PointCentroid[] as a point \
specification.\
\>", "Text",
 CellChangeTimes->{{3.515614705796875*^9, 3.515614728171875*^9}, {
  3.515953573375*^9, 
  3.5159536025625*^9}},ExpressionUUID->"97ad8d2c-bc00-4058-a968-1950d1929bdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CentroidPoint", "[", 
    RowBox[{"PointSet", ":", 
     RowBox[{"FigPointSetPattern", "[", "1", "]"}]}], "]"}], ":=", 
   RowBox[{"Canvas", "[", 
    RowBox[{"Mean", "[", 
     RowBox[{"FigResolvePoint", "/@", "PointSet"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51560881140625*^9, 3.51560881715625*^9}, {
  3.515608865109375*^9, 3.515608866390625*^9}, {3.5156164674375*^9, 
  3.515616468625*^9}, {3.516035884848875*^9, 
  3.516035886973875*^9}},ExpressionUUID->"d1b6a2af-7aad-4091-ae5e-\
79f20098b7c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bounding box of point set", "Subsection",
 CellChangeTimes->{{3.515166674140625*^9, 3.515166694546875*^9}, {
  3.51545023029725*^9, 3.5154502318285*^9}, {3.515616428796875*^9, 
  3.515616447625*^9}, {3.5240709911875*^9, 
  3.52407099534375*^9}},ExpressionUUID->"7412832a-e299-41c2-9535-\
804d3c7effb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigPointSetBoundingBox", "[", 
    RowBox[{"PointSet", ":", 
     RowBox[{"FigPointSetPattern", "[", "1", "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"First", "/@", "PointSet"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"First", "/@", "PointSet"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"Last", "/@", "PointSet"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Last", "/@", "PointSet"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516616575*^9, 3.51516620196875*^9}, {
   3.515166363734375*^9, 3.51516642103125*^9}, {3.5151665123125*^9, 
   3.51516652478125*^9}, 3.515167326484375*^9, {3.515167359171875*^9, 
   3.515167378671875*^9}, {3.515167540625*^9, 3.515167556453125*^9}, {
   3.51545042535975*^9, 3.515450461031625*^9}, 3.516039158067625*^9, 
   3.524070974171875*^9},ExpressionUUID->"fc679e6f-db08-4de4-938c-\
b89291c1cdac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle/ellipse geometry", "Section",
 CellChangeTimes->{{3.515612120984375*^9, 3.515612123390625*^9}, {
  3.515615859109375*^9, 3.515615859828125*^9}, {3.515619430953125*^9, 
  3.515619431921875*^9}, {3.515854053390625*^9, 3.515854054609375*^9}, {
  3.5194943288125*^9, 
  3.519494332171875*^9}},ExpressionUUID->"9029cb78-6555-4809-a05b-\
038ca30af5d7"],

Cell[CellGroupData[{

Cell["Radius pattern", "Subsection",
 CellChangeTimes->{{3.515610554171875*^9, 
  3.51561055915625*^9}},ExpressionUUID->"1ac65988-63d7-4d9e-948b-\
e5bad3c9f92b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigRadiusPattern", "=", 
   RowBox[{"NonNegativeIntervalParametersPattern", "|", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical", "|", "Canvas", "|", "Scaled"}], 
       ")"}], "[", "NonNegativeIntervalParametersPattern", "]"}], ")"}], "|", 
    
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561057296875*^9, 3.515610592296875*^9}, {
  3.515611154578125*^9, 3.515611156109375*^9}, {3.515611416296875*^9, 
  3.515611429078125*^9}, {3.515612473546875*^9, 3.5156124871875*^9}, {
  3.515612659125*^9, 3.515612676546875*^9}, {3.5775525711766434`*^9, 
  3.577552576796651*^9}},ExpressionUUID->"1b2cde44-c8a7-439f-aff7-\
38b1a461dcde"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geometry calculations", "Subsection",
 CellChangeTimes->{{3.519494339390625*^9, 
  3.519494341953125*^9}},ExpressionUUID->"9c781b72-03b3-499b-a727-\
d00c406a7dd3"],

Cell["\<\
calculate {CanvasCenter,CanvasRadius,CanvasPivot,RotationAngle} for a rectangle
this function takes care of point resolution for the arguments but does no \
option validation\
\>", "Text",
 CellChangeTimes->{{3.5666623228196354`*^9, 3.566662336259654*^9}, {
   3.566662531059927*^9, 3.5666625458299475`*^9}, 
   3.840630224479713*^9},ExpressionUUID->"63a16512-0218-4cef-a7d7-\
089e33397da0"],

Cell["given center (with option Radius)", "Text",
 CellChangeTimes->{{3.515857538046875*^9, 
  3.515857549203125*^9}},ExpressionUUID->"c3c95ba5-bfe7-4819-836e-\
0d8db1599c76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRectangleGeometry", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", "FullOptions_List"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Anchor", ",", "UsedAnchorOffset", ",", "UsedPivotOffset", ",", 
       "\[IndentingNewLine]", "CanvasCenter", ",", "CanvasRadius", ",", 
       "CanvasPivot", ",", "RotationAngle"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resolve", " ", "arguments"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{"FigResolveRadius", "[", 
        RowBox[{"(", 
         RowBox[{"Radius", "/.", "FullOptions"}], ")"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UsedAnchorOffset", "=", 
       RowBox[{"FigResolveOffset", "[", 
        RowBox[{"(", 
         RowBox[{"AnchorOffset", "/.", "FullOptions"}], ")"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UsedPivotOffset", "=", 
       RowBox[{"FigResolveOffset", "[", 
        RowBox[{"ResolveOption", "[", 
         RowBox[{"PivotOffset", ",", 
          RowBox[{"{", 
           RowBox[{"Automatic", "\[Rule]", "UsedAnchorOffset"}], "}"}], ",", 
          "FullOptions"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RotationAngle", "=", 
       RowBox[{"UpgradeScalar", "[", 
        RowBox[{"ResolveOption", "[", 
         RowBox[{"Rotate", ",", 
          RowBox[{"{", 
           RowBox[{"Automatic", "\[Rule]", 
            RowBox[{"AnchorAngle", "[", "Anchor", "]"}]}], "}"}], ",", 
          "FullOptions"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"derived", " ", "geometry"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{
        RowBox[{"FigResolvePoint", "[", "Anchor", "]"}], "-", 
        RowBox[{"UsedAnchorOffset", "*", "CanvasRadius"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasPivot", "=", 
       RowBox[{"CanvasCenter", "+", 
        RowBox[{"UsedPivotOffset", "*", "CanvasRadius"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"combined", " ", "answer"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51949340609375*^9, 3.51949361109375*^9}, 
   3.519493832640625*^9, {3.51949386959375*^9, 3.519493884828125*^9}, {
   3.5194939371875*^9, 3.5194941966875*^9}, {3.51949431403125*^9, 
   3.51949431565625*^9}, 
   3.519497099984375*^9},ExpressionUUID->"18d408a8-975e-4292-a455-\
e6e87b6c43e3"],

Cell["given diametric corners", "Text",
 CellChangeTimes->{{3.5158575525*^9, 
  3.515857557328125*^9}},ExpressionUUID->"7c9b8bfb-27ee-4e9a-97b6-\
f2efdc07d295"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRectangleGeometry", "[", 
    RowBox[{
     RowBox[{"p1", ":", "FigPointPattern"}], ",", 
     RowBox[{"p2", ":", "FigPointPattern"}], ",", "FullOptions_List"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "CanvasCorner1", ",", "CanvasCorner2", ",", "CanvasCenter", ",", 
       "CanvasPivot", ",", "CanvasRadius", ",", "RotationAngle", ",", 
       "UsedRoundingRadius"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CanvasCorner1", "=", 
       RowBox[{"FigResolvePoint", "[", "p1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCorner2", "=", 
       RowBox[{"FigResolvePoint", "[", "p2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CanvasCorner2", "+", "CanvasCorner1"}], ")"}], "/", "2"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CanvasCorner2", "-", "CanvasCorner1"}], ")"}], "/", "2"}], 
        "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Abs", " ", "allows", " ", "any", " ", "two", " ", "points", " ", 
         "to", " ", "be", " ", "taken"}], ",", " ", 
        RowBox[{
        "not", " ", "just", " ", "lower", " ", "left", " ", "to", " ", 
         "upper", " ", "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"invoke", " ", "base", " ", "form"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRectangleGeometry", " ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasCenter", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AnchorOffset", "\[Rule]", "Center"}], ",", 
            RowBox[{"Radius", "\[Rule]", 
             RowBox[{"Canvas", "[", "CanvasRadius", "]"}]}]}], "}"}], ",", 
          "FullOptions"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51510150784375*^9, 3.51510165284375*^9}, {
   3.5151018264375*^9, 3.515101837625*^9}, {3.515160729234375*^9, 
   3.5151607388125*^9}, {3.515160815109375*^9, 3.515160905421875*^9}, {
   3.515429900281625*^9, 3.5154299283285*^9}, {3.515432005344125*^9, 
   3.51543202310975*^9}, {3.515432080625375*^9, 3.515432260875375*^9}, {
   3.515432559875375*^9, 3.515432618141*^9}, {3.515432654812875*^9, 
   3.515432706531625*^9}, {3.515433020406625*^9, 3.515433023781625*^9}, {
   3.515442053016*^9, 3.5154420783285*^9}, {3.51544252460975*^9, 
   3.515442586281625*^9}, {3.5154469192035*^9, 3.515446929391*^9}, {
   3.5154471764535*^9, 3.515447183094125*^9}, {3.515447219250375*^9, 
   3.515447220250375*^9}, {3.515447301531625*^9, 3.5154473044535*^9}, 
   3.515448155969125*^9, {3.515449235594125*^9, 3.515449253000375*^9}, 
   3.51545048954725*^9, {3.51545052173475*^9, 3.5154505228285*^9}, {
   3.51561162565625*^9, 3.51561168884375*^9}, {3.515613185078125*^9, 
   3.51561321028125*^9}, {3.515618454140625*^9, 3.51561845509375*^9}, {
   3.515618558328125*^9, 3.5156186138125*^9}, {3.515618681625*^9, 
   3.51561873415625*^9}, {3.51561877528125*^9, 3.515618818671875*^9}, {
   3.51561889240625*^9, 3.515618944546875*^9}, {3.515618982953125*^9, 
   3.515619023359375*^9}, {3.515619092859375*^9, 3.515619138140625*^9}, {
   3.515619171359375*^9, 3.515619215109375*^9}, {3.51562323090625*^9, 
   3.515623257734375*^9}, {3.51562330753125*^9, 3.515623308109375*^9}, {
   3.515681444234375*^9, 3.515681508125*^9}, 3.51568187259375*^9, {
   3.515682018390625*^9, 3.51568221309375*^9}, {3.51568226515625*^9, 
   3.5156822661875*^9}, {3.515682919375*^9, 3.5156829705625*^9}, {
   3.51568384184375*^9, 3.515683846484375*^9}, {3.515684146515625*^9, 
   3.51568417878125*^9}, {3.515684224390625*^9, 3.515684240109375*^9}, {
   3.515684273125*^9, 3.515684274734375*^9}, {3.515684459265625*^9, 
   3.515684461609375*^9}, {3.51568454121875*^9, 3.515684560484375*^9}, {
   3.51568461046875*^9, 3.515684631296875*^9}, {3.51568532846875*^9, 
   3.515685330359375*^9}, {3.5156861304375*^9, 3.515686149703125*^9}, 
   3.515686398875*^9, {3.515857189484375*^9, 3.515857194375*^9}, {
   3.515857228125*^9, 3.515857237625*^9}, {3.51585727684375*^9, 
   3.515857366875*^9}, 3.515857417078125*^9, {3.515857447453125*^9, 
   3.5158575215625*^9}, {3.51585999478125*^9, 3.515860005375*^9}, {
   3.51586171846875*^9, 3.515861718828125*^9}, 3.5158652513125*^9, {
   3.5158655109375*^9, 3.51586551628125*^9}, 3.51595888284375*^9, {
   3.516291600171875*^9, 3.5162916071875*^9}, 3.51949437234375*^9, {
   3.51949474809375*^9, 3.519494849203125*^9}, {3.5666623714097033`*^9, 
   3.5666624079497547`*^9}, {3.5666624573398237`*^9, 
   3.5666624854498625`*^9}, {3.566662564779974*^9, 3.5666625688899794`*^9}, {
   3.624758806941062*^9, 
   3.6247588594050627`*^9}},ExpressionUUID->"c42cf060-04d7-48c2-8ec4-\
c5eb16536aa0"],

Cell["given region specification", "Text",
 CellChangeTimes->{{3.515857562734375*^9, 
  3.515857567828125*^9}},ExpressionUUID->"13ef4a8c-5559-41ac-920d-\
7467f28351b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRectangleGeometry", "[", 
    RowBox[{
     RowBox[{"r", ":", "FigRegionPattern"}], ",", "FullOptions_List"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "CanvasRegion", ",", "CanvasCorner1", ",", "CanvasCorner2", ",", 
       "CanvasCenter", ",", "CanvasPivot", ",", "CanvasRadius", ",", 
       "RotationAngle", ",", "UsedRoundingRadius"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"FigResolveRegion", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CanvasCorner1", ",", "CanvasCorner2"}], "}"}], "=", 
       RowBox[{"Transpose", "@", "CanvasRegion"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CanvasCorner2", "+", "CanvasCorner1"}], ")"}], "/", "2"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CanvasCorner2", "-", "CanvasCorner1"}], ")"}], "/", "2"}], 
        "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Abs", " ", "allows", " ", "any", " ", "two", " ", "points", " ", 
         "to", " ", "be", " ", "taken"}], ",", " ", 
        RowBox[{
        "not", " ", "just", " ", "lower", " ", "left", " ", "to", " ", 
         "upper", " ", "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"invoke", " ", "base", " ", "form"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRectangleGeometry", " ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasCenter", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AnchorOffset", "\[Rule]", "Center"}], ",", 
            RowBox[{"Radius", "\[Rule]", 
             RowBox[{"Canvas", "[", "CanvasRadius", "]"}]}]}], "}"}], ",", 
          "FullOptions"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51510150784375*^9, 3.51510165284375*^9}, {
   3.5151018264375*^9, 3.515101837625*^9}, {3.515160729234375*^9, 
   3.5151607388125*^9}, {3.515160815109375*^9, 3.515160905421875*^9}, {
   3.515429900281625*^9, 3.5154299283285*^9}, {3.515432005344125*^9, 
   3.51543202310975*^9}, {3.515432080625375*^9, 3.515432260875375*^9}, {
   3.515432559875375*^9, 3.515432618141*^9}, {3.515432654812875*^9, 
   3.515432706531625*^9}, {3.515433020406625*^9, 3.515433023781625*^9}, {
   3.515442053016*^9, 3.5154420783285*^9}, {3.51544252460975*^9, 
   3.515442586281625*^9}, {3.5154469192035*^9, 3.515446929391*^9}, {
   3.5154471764535*^9, 3.515447183094125*^9}, {3.515447219250375*^9, 
   3.515447220250375*^9}, {3.515447301531625*^9, 3.5154473044535*^9}, 
   3.515448155969125*^9, {3.515449235594125*^9, 3.515449253000375*^9}, 
   3.51545048954725*^9, {3.51545052173475*^9, 3.5154505228285*^9}, {
   3.51561162565625*^9, 3.51561168884375*^9}, {3.515613185078125*^9, 
   3.51561321028125*^9}, {3.515618454140625*^9, 3.51561845509375*^9}, {
   3.515618558328125*^9, 3.5156186138125*^9}, {3.515618681625*^9, 
   3.51561873415625*^9}, {3.51561877528125*^9, 3.515618818671875*^9}, {
   3.51561889240625*^9, 3.515618944546875*^9}, {3.515618982953125*^9, 
   3.515619023359375*^9}, {3.515619092859375*^9, 3.515619138140625*^9}, {
   3.515619171359375*^9, 3.515619215109375*^9}, {3.51562323090625*^9, 
   3.515623257734375*^9}, {3.51562330753125*^9, 3.515623308109375*^9}, {
   3.515681444234375*^9, 3.515681508125*^9}, 3.51568187259375*^9, {
   3.515682018390625*^9, 3.51568221309375*^9}, {3.51568226515625*^9, 
   3.5156822661875*^9}, {3.515682919375*^9, 3.5156829705625*^9}, {
   3.51568384184375*^9, 3.515683846484375*^9}, {3.515684146515625*^9, 
   3.51568417878125*^9}, {3.515684224390625*^9, 3.515684240109375*^9}, {
   3.515684273125*^9, 3.515684274734375*^9}, {3.515684459265625*^9, 
   3.515684461609375*^9}, {3.51568454121875*^9, 3.515684560484375*^9}, {
   3.51568461046875*^9, 3.515684631296875*^9}, {3.51568532846875*^9, 
   3.515685330359375*^9}, {3.5156861304375*^9, 3.515686149703125*^9}, 
   3.515686398875*^9, {3.515857189484375*^9, 3.515857194375*^9}, {
   3.515857228125*^9, 3.515857237625*^9}, {3.51585727684375*^9, 
   3.515857366875*^9}, 3.515857417078125*^9, {3.515857447453125*^9, 
   3.5158575215625*^9}, {3.515857619859375*^9, 3.515857621234375*^9}, {
   3.51585765746875*^9, 3.51585769365625*^9}, 3.515860007921875*^9, {
   3.5158617195625*^9, 3.51586172084375*^9}, 3.515865255828125*^9, {
   3.515865521609375*^9, 3.515865535234375*^9}, {3.515865578796875*^9, 
   3.51586557909375*^9}, 3.5159588880625*^9, {3.516287250515625*^9, 
   3.516287251265625*^9}, {3.516291610375*^9, 3.516291614703125*^9}, 
   3.519494373265625*^9, 3.51949488159375*^9, {3.5666624992798824`*^9, 
   3.5666625195499105`*^9}, {3.566662556219962*^9, 3.5666625840300007`*^9}, {
   3.624758850125532*^9, 
   3.6247588647333674`*^9}},ExpressionUUID->"2cf635ad-5e26-49d4-94cc-\
bc109eb42bc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make region given rectangle specification", "Subsection",
 CellChangeTimes->{{3.566663311151019*^9, 
  3.566663316491027*^9}},ExpressionUUID->"bc6c8c2c-27ed-40b6-b9b0-\
f08cf23b81e4"],

Cell["\<\
User-level function to convert a rectangle specification to a Canvas region \
specification
For rotated rectangle, circumscribing bounding box is used\
\>", "Text",
 CellChangeTimes->{{3.566663356801083*^9, 
  3.5666633970411396`*^9}},ExpressionUUID->"a745c6e0-e5a8-4b5b-a7f9-\
3f923696e96e"],

Cell["TODO option resultion and validation", "Text",
 CellChangeTimes->{{3.566663736575616*^9, 
  3.566663741215622*^9}},ExpressionUUID->"e1444801-8a4e-4f08-9264-\
20405bec94a4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"RectangleRegion", "[", "Args___", "]"}], ":=", 
    RowBox[{"Canvas", "[", 
     RowBox[{"FigRectangleBoundingBox", "@@", 
      RowBox[{"MakeRectangleGeometry", "[", "Args", "]"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5666633238710375`*^9, 3.5666633755211096`*^9}, {
  3.566663408181155*^9, 3.566663420321172*^9}, {3.5666637340006123`*^9, 
  3.566663734625613*^9}},ExpressionUUID->"cad749e8-2009-4294-a6fa-\
aafbd1e462ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard rectangle geometry options", "Subsection",
 CellChangeTimes->{{3.5154308919535*^9, 3.515430894656625*^9}, {
  3.51543111848475*^9, 3.51543111998475*^9}, {3.515681194203125*^9, 
  3.515681195296875*^9}, {3.51949454353125*^9, 3.5194945450625*^9}, {
  3.519557889453125*^9, 
  3.519557891640625*^9}},ExpressionUUID->"f207f47b-677b-4af0-a386-\
3e0ee3429e61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigRectangleOptions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "geometry", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Radius", "\[Rule]", "1"}], ",", 
     RowBox[{"AnchorOffset", "\[Rule]", "Center"}], ",", 
     RowBox[{"PivotOffset", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Rotate", "\[Rule]", "None"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515430903687875*^9, 3.515430989031625*^9}, {
   3.515431026844125*^9, 3.515431030625375*^9}, {3.515431105094125*^9, 
   3.5154311113285*^9}, 3.515609867390625*^9, {3.515610068609375*^9, 
   3.51561007096875*^9}, {3.5156102813125*^9, 3.515610326796875*^9}, {
   3.515611182890625*^9, 3.515611184453125*^9}, {3.51561123521875*^9, 
   3.5156112356875*^9}, {3.5156812055*^9, 3.51568120890625*^9}, {
   3.515681963703125*^9, 3.515681982015625*^9}, {3.519493122078125*^9, 
   3.519493136890625*^9}, {3.519493371640625*^9, 3.519493373203125*^9}, {
   3.519493924953125*^9, 3.519493929265625*^9}, 3.519494362*^9, {
   3.519557624046875*^9, 3.519557624578125*^9}, 
   3.519557847625*^9},ExpressionUUID->"4c142c50-7678-4680-b73e-f8b94400c2ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckRectangleOptions", "[", "Self_Object", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "Radius", ",", "FigRadiusPattern", ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "AnchorOffset", ",", "FigOffsetPattern", ",", 
        "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "PivotOffset", ",", 
        RowBox[{"Automatic", "|", "FigOffsetPattern"}], ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "Rotate", ",", 
        RowBox[{"Automatic", "|", "ScalarParameterPattern"}], ",", 
        "FigOptions"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5156100370625*^9, 3.515610074328125*^9}, {
   3.515610247703125*^9, 3.515610278484375*^9}, {3.51561033215625*^9, 
   3.5156103411875*^9}, {3.51561118840625*^9, 3.515611213953125*^9}, {
   3.515681221765625*^9, 3.515681251484375*^9}, {3.515681835359375*^9, 
   3.515681860875*^9}, {3.515681987921875*^9, 3.515681996453125*^9}, {
   3.515708374421875*^9, 3.51570837446875*^9}, {3.51570843621875*^9, 
   3.5157084375*^9}, {3.519493202875*^9, 3.519493243390625*^9}, {
   3.519493366375*^9, 3.519493367765625*^9}, {3.519493918171875*^9, 
   3.51949392159375*^9}, 3.5194943625*^9, 
   3.51955788621875*^9},ExpressionUUID->"e6dabc90-1baf-4b0a-a227-\
bf58f4aa1750"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FigResolveRadius", "Subsection",
 CellChangeTimes->{{3.515612142890625*^9, 
  3.515612146890625*^9}},ExpressionUUID->"9001db16-9dfc-4ba0-8eac-\
802accec4de9"],

Cell["\<\
closely related to FigResolveDisplacement:
\t-- upgrades single radius argument
\t-- allows for \[OpenCurlyDoubleQuote]vertical\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]horizontal\[CloseCurlyDoubleQuote] units
\t-- requires nonnegative arguments\
\>", "Text",
 CellChangeTimes->{{3.577552303241268*^9, 
  3.577552386006384*^9}},ExpressionUUID->"b3f844f5-a258-4499-9448-\
f9ab2060ac50"],

Cell["User coordinates: None or r or {rx,ry}", "Text",
 CellChangeTimes->{{3.515612317875*^9, 
  3.515612350390625*^9}},ExpressionUUID->"ec9e6aa8-5f74-40d1-8f65-\
b54e3ffd3c4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", 
    RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612152828125*^9, 3.515612227046875*^9}, {
   3.51561228878125*^9, 3.515612301140625*^9}, 
   3.515784134828125*^9},ExpressionUUID->"e4f31443-c54d-4fb3-9c70-\
e73920150f2c"],

Cell["\<\
Horizontal user coordinates: Horizontal[None] or Horizontal[r] or \
Horizontal[{rx,ry}]\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 
  3.51561238440625*^9}},ExpressionUUID->"3c28b024-15bd-4603-8fd2-\
5bd444327d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Horizontal", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "LengthUnit", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LengthUnit", "=", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CurrentWindow", "[", "]"}], "@", 
           RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LengthUnit", "*", 
       RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
    3.515612549875*^9}, 
   3.51578413484375*^9},ExpressionUUID->"e327ad35-c076-4c29-abb7-\
3428adcd2cd5"],

Cell["\<\
Vertical user coordinates: Vertical[None] or Vertical[r] or Vertical[{rx,ry}]\
\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 3.51561238440625*^9}, {
  3.515612588296875*^9, 
  3.5156125901875*^9}},ExpressionUUID->"c1a3e333-5b3c-4fd7-af01-6092b8ab20f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Vertical", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "LengthUnit", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LengthUnit", "=", 
       RowBox[{"Last", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CurrentWindow", "[", "]"}], "@", 
           RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LengthUnit", "*", 
       RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
    3.51561259175*^9}, 
   3.515784134859375*^9},ExpressionUUID->"6db39fca-9aca-4e89-8fe4-\
c2b1a1e10cf6"],

Cell["\<\
Canvas coordinates: Canvas[None] or Canvas[r] or Canvas[{rx,ry}]\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 3.51561238440625*^9}, {
  3.515612588296875*^9, 
  3.515612626015625*^9}},ExpressionUUID->"5e931837-fee9-4eea-9169-\
7eb0afb38638"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{"UpgradePairEqual", "[", "r", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
   3.51561259175*^9}, {3.51561262853125*^9, 
  3.515612638796875*^9}},ExpressionUUID->"e1a763f1-094b-4596-9eb9-\
19623aecc636"],

Cell["\<\
Scaled coordinates: Scaled[None] or Scaled[r] or Scaled[{rx,ry}]\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 3.51561238440625*^9}, {
  3.515612588296875*^9, 3.515612626015625*^9}, {3.515612721078125*^9, 
  3.515612722625*^9}},ExpressionUUID->"68d4fa72-2b3a-4526-8a9c-4577d62fe881"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledDeltaTFunction", "[", "]"}]}], ")"}], "@", 
    RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
    3.51561259175*^9}, {3.51561262853125*^9, 3.515612638796875*^9}, {
   3.5156127235*^9, 3.51561273265625*^9}, {3.515612774234375*^9, 
   3.51561277878125*^9}, 
   3.515784134890625*^9},ExpressionUUID->"ecd29be6-740b-40af-a415-\
0318c3e6520c"],

Cell["Ad hoc treatment of hybrid coordinates", "Text",
 CellChangeTimes->{{3.5365308433125*^9, 3.536530862453125*^9}, 
   3.5775516678053784`*^9},ExpressionUUID->"086a3630-051b-41d2-84d0-\
9995791d85f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ":", 
     RowBox[{"Except", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"y", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigResolveDisplacement", "[", "p", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653087075*^9, 3.536530887890625*^9}, {
   3.536530960421875*^9, 3.536530998171875*^9}, 3.5775516748953886`*^9, {
   3.5775517490554924`*^9, 3.577551751385495*^9}, {3.5775524291664443`*^9, 
   3.577552473066506*^9}},ExpressionUUID->"b48c954a-d25b-45bf-9354-\
001e0d8b68a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle \[OpenCurlyDoubleQuote]circumference\[CloseCurlyDoubleQuote] \
points", "Subsection",
 CellChangeTimes->{{3.51585621278125*^9, 
  3.51585621846875*^9}},ExpressionUUID->"315a16a7-7bf8-455a-8ffd-\
19365dfe98ed"],

Cell["used also for circle geometry", "Text",
 CellChangeTimes->{{3.5158562263125*^9, 
  3.515856232375*^9}},ExpressionUUID->"893319f7-c5f2-4e09-b028-84c8e6c0203b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RectangleOffsetPoint", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Offset", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{"RotationAngle", ",", "CanvasPivot"}], "]"}], "@", 
    RowBox[{"(", 
     RowBox[{"CanvasCenter", "+", 
      RowBox[{"CanvasRadius", "*", "Offset"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585567546875*^9, 3.515855770515625*^9}, {
   3.51585585721875*^9, 3.515855861734375*^9}, {3.5158563874375*^9, 
   3.515856391078125*^9}, {3.515857048875*^9, 3.515857049875*^9}, 
   3.5158570894375*^9},ExpressionUUID->"b429441f-b60a-4653-9a3f-b7589f1d4d51"],

Cell["\<\
segments orientations are in the \[OpenCurlyDoubleQuote]upward\
\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]rightward\
\[CloseCurlyDoubleQuote] directions (with respect to the original unrotated \
rectangle)\
\>", "Text",
 CellChangeTimes->{{3.515856289578125*^9, 
  3.515856317984375*^9}},ExpressionUUID->"ff6f5481-0f29-4a48-96e8-\
eb57ae0bf04f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Left"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Right"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Bottom"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Top"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585567546875*^9, 3.515855770515625*^9}, {
  3.51585585721875*^9, 3.515855861734375*^9}, {3.5158562369375*^9, 
  3.515856285171875*^9}, {3.515856320421875*^9, 3.5158564296875*^9}, {
  3.51585708996875*^9, 3.515857093671875*^9}, {3.515864340796875*^9, 
  3.51586434390625*^9}},ExpressionUUID->"7460a864-dce1-4d88-b39f-\
205c330b60d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle anchors", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 3.515619463203125*^9}, {
  3.515854266515625*^9, 
  3.5158542678125*^9}},ExpressionUUID->"90f821f2-b9a5-4a62-87f9-087404e52d13"],

Cell["A \[OpenCurlyDoubleQuote]rectangle\[CloseCurlyDoubleQuote] here more \
generally means a tilted rectangle", "Text",
 CellChangeTimes->{{3.51561946596875*^9, 3.51561947509375*^9}, {
  3.51585427165625*^9, 
  3.515854275765625*^9}},ExpressionUUID->"4f722cb1-4fb3-4a7c-aaaf-\
e640a11f4801"],

Cell["\<\
Named points: Center (default), Left/Right, Bottom/Top
\tidentical to circle, sans AngleRange parameter\
\>", "Text",
 CellChangeTimes->{{3.515683659515625*^9, 3.51568367915625*^9}, {
   3.515854295015625*^9, 3.515854314734375*^9}, 3.5665957020770273`*^9, 
   3.5665958654805136`*^9},ExpressionUUID->"67ed1771-6925-4989-b61a-\
b69aed3240cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "NamedPointPattern"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], ",", 
     "RotationAngle"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, 
   3.51561961984375*^9, 3.51568066303125*^9, {3.51568074428125*^9, 
   3.5156807529375*^9}, {3.5156833859375*^9, 3.515683449140625*^9}, {
   3.515683529125*^9, 3.51568352978125*^9}, {3.515683574328125*^9, 
   3.51568360171875*^9}, 3.515686652203125*^9, 3.515855486375*^9, {
   3.51585589378125*^9, 3.51585589428125*^9}, {3.515856060390625*^9, 
   3.5158560630625*^9}, 3.515856410328125*^9, {3.51585677471875*^9, 
   3.51585680621875*^9}, {3.515856858390625*^9, 3.515856863640625*^9}, 
   3.51585709596875*^9, 3.518018926578125*^9, {3.51847384828125*^9, 
   3.518473851484375*^9}, {3.519647287125*^9, 
   3.519647328328125*^9}},ExpressionUUID->"83fade24-20fd-4f48-a3d1-\
7268706e1029"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Offset"}], ",", "\[IndentingNewLine]", 
     RowBox[{"OffsetValue", ":", "FigOffsetPattern"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"FigResolveOffset", "[", "OffsetValue", "]"}]}], "]"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "RotationAngle"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51956759509375*^9, 3.51956769671875*^9}, 
   3.519647303921875*^9, {3.51964747875*^9, 
   3.519647479515625*^9}},ExpressionUUID->"e9607b60-e9a2-488e-8466-\
62860abdb8d0"],

Cell["\<\
Side interpolations: {Left|Right|Bottom|Top,x}
Note: Simple side points could be absorbed as special case by making x \
default to 0 but are already handled as named points above.
Reference:(Tail|Center|Head):Center,Mode:(Absolute|Scaled):Scaled\
\>", "Text",
 CellChangeTimes->{{3.515683659515625*^9, 3.51568367915625*^9}, {
  3.515854295015625*^9, 3.515854314734375*^9}, {3.515855561890625*^9, 
  3.515855625140625*^9}, {3.515864215734375*^9, 3.51586424396875*^9}, {
  3.51964565225*^9, 3.519645675921875*^9}, {3.51964740409375*^9, 
  3.5196474663125*^9}},ExpressionUUID->"2ebeeaba-db8e-492f-826b-4432b170a2ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right", "|", "Bottom", "|", "Top"}], ")"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Canvas", "[", "\[IndentingNewLine]", 
      RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RectangleSideSegment", "[", 
         RowBox[{
         "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
          "RotationAngle", ",", "Name"}], "]"}], ",", "\[IndentingNewLine]", 
        "Center", ",", "Scaled", ",", "x"}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"-", 
      RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], ",", 
     "\[IndentingNewLine]", "RotationAngle"}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, {
   3.51561962175*^9, 3.515619730953125*^9}, {3.515619773140625*^9, 
   3.515619811484375*^9}, {3.51562215609375*^9, 3.5156221565*^9}, {
   3.51562352409375*^9, 3.51562353096875*^9}, {3.515680635890625*^9, 
   3.515680669921875*^9}, {3.5156807540625*^9, 3.51568075928125*^9}, {
   3.51568342634375*^9, 3.51568345734375*^9}, {3.515683530296875*^9, 
   3.515683533984375*^9}, {3.51568357875*^9, 3.51568360446875*^9}, {
   3.51585429221875*^9, 3.51585434665625*^9}, {3.515855461015625*^9, 
   3.51585546246875*^9}, {3.515855507375*^9, 3.51585551225*^9}, {
   3.51585587759375*^9, 3.51585588034375*^9}, {3.515855985375*^9, 
   3.5158560140625*^9}, {3.515856116921875*^9, 3.515856171609375*^9}, {
   3.5158564421875*^9, 3.515856445046875*^9}, {3.515856475828125*^9, 
   3.51585657578125*^9}, {3.515856889671875*^9, 3.51585690059375*^9}, {
   3.515863975046875*^9, 3.515863983828125*^9}, {3.515864204734375*^9, 
   3.515864207421875*^9}, 3.518018928671875*^9, {3.51964734409375*^9, 
   3.51964734834375*^9}, {3.51964739053125*^9, 3.51964739146875*^9}, {
   3.51964745184375*^9, 3.5196474560625*^9}, {3.52002508840625*^9, 
   3.520025093484375*^9}},ExpressionUUID->"6393b46a-38b3-4bdf-805f-\
2bac89c50777"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle bounding box", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 3.515619463203125*^9}, {
  3.515854266515625*^9, 3.5158542678125*^9}, {3.5158594105625*^9, 
  3.515859412515625*^9}},ExpressionUUID->"119def20-e74c-4f49-82dd-\
93c3e038f11d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleBoundingBox", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"FigPointSetBoundingBox", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", "Offset"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Offset", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585942346875*^9, 
  3.5158595128125*^9}},ExpressionUUID->"eb772ea5-a470-40e3-937f-2b7f32740c6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circle anchors", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 
  3.515619463203125*^9}},ExpressionUUID->"d14cb426-a917-4473-8770-\
d181b23bddd9"],

Cell["A \[OpenCurlyDoubleQuote]circle\[CloseCurlyDoubleQuote] here more \
generally means a tilted ellipse", "Text",
 CellChangeTimes->{{3.51561946596875*^9, 
  3.51561947509375*^9}},ExpressionUUID->"b9cffe91-6e02-42b5-97ad-\
5dc6aa5924ff"],

Cell["Named points: Center (default), Left/Right, Bottom/Top", "Text",
 CellChangeTimes->{{3.515683659515625*^9, 
  3.51568367915625*^9}},ExpressionUUID->"7f1f7cde-148b-42e0-b634-\
a9939cdc75bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{
       "Center", "|", "Left", "|", "Right", "|", "Bottom", "|", "Top"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], ",", 
     "RotationAngle"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, 
   3.51561961984375*^9, 3.51568066303125*^9, {3.51568074428125*^9, 
   3.5156807529375*^9}, {3.5156833859375*^9, 3.515683449140625*^9}, {
   3.515683529125*^9, 3.51568352978125*^9}, {3.515683574328125*^9, 
   3.51568360171875*^9}, 3.515686652203125*^9, 3.515855486375*^9, {
   3.51585589378125*^9, 3.51585589428125*^9}, {3.515856060390625*^9, 
   3.5158560630625*^9}, 3.515856410328125*^9, {3.51585677471875*^9, 
   3.51585680621875*^9}, 3.5158570951875*^9, 3.518018907359375*^9, {
   3.519647305734375*^9, 3.519647306796875*^9}, {3.519651750765625*^9, 
   3.519651753296875*^9}, 3.5202765048125*^9, 3.566595702638628*^9, 
   3.566595865496114*^9},ExpressionUUID->"b44dd5cc-d4b5-4dd3-b47e-\
8fc5f423881e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Offset"}], ",", "\[IndentingNewLine]", 
     RowBox[{"OffsetValue", ":", "FigOffsetPattern"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"FigResolveOffset", "[", "OffsetValue", "]"}]}], "]"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "RotationAngle"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51956759509375*^9, 3.519567659296875*^9}, 
   3.519647307984375*^9, 3.566595703106629*^9, 
   3.566595865496114*^9},ExpressionUUID->"0e30c5f1-9c58-4485-884b-\
120129fcb209"],

Cell[TextData[{
 "For a circle, the conventional direction is the \"positive theta\" \
direction from polar coordinates, i.e., CCW.  For instance, this is the \
convention followed by the ordering of the arc angle arguments \
{theta1,theta2} in the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Circle and Disk primatives.  However, it is more natural for the text \
baseline to follow the \"negative theta\" tangent, so that the text \"sits on\
\" the outside of the circle.  This is the convention adopted with the \
anchors for Point, for instance.  For the most part, TextRectify renders this \
problem irrelevant.  However, the orientation of the tangent also affect \
arrowheads.  "
}], "Text",
 CellChangeTimes->{{3.51568368459375*^9, 3.515683699953125*^9}, {
  3.51596956909375*^9, 3.5159695745625*^9}, {3.566596935201379*^9, 
  3.566597008631481*^9}},ExpressionUUID->"367fda31-d9f2-4831-9785-\
c10aedb9c052"],

Cell["\<\
Curve anchors:
\tNormal/Tangent, t|Scaled[t]\
\>", "Text",
 CellChangeTimes->{{3.51568370453125*^9, 3.51568372775*^9}, {
   3.515683799265625*^9, 3.51568382240625*^9}, {3.51596953903125*^9, 
   3.515969565*^9}, 3.5195646395625*^9, {3.51964578821875*^9, 
   3.519645812046875*^9}, {3.566597123661642*^9, 3.566597125991646*^9}, {
   3.5665971672317033`*^9, 
   3.5665971689217057`*^9}},ExpressionUUID->"6796f733-1303-4aa1-b021-\
e57a12f47c19"],

Cell["\<\
Previously: FigCircle sorted the AngleRange angles to *enforce* a CCW curve.  \
The solution was to use the \"negative theta\" tangent, but still have the \
scaled curve parameter run from 0=Tail to 1=Head going CCW, and then flip the \
tangent used in drawing arrowheads (with \
RotateAnchor[Self@MakeAnchor[Tail,None],Pi],RotateAnchor[Self@MakeAnchor[Head,\
None],Pi]).\
\>", "Text",
 CellChangeTimes->{{3.51568368459375*^9, 3.515683699953125*^9}, {
  3.51596956909375*^9, 3.5159695745625*^9}, {3.566596935201379*^9, 
  3.5665969941814613`*^9}, {3.5665977351724987`*^9, 
  3.5665977436225104`*^9}},ExpressionUUID->"c4a25967-c964-4b26-aebd-\
2628957bee43"],

Cell["\<\
FigCircleAnchor[
   CanvasCenter : {_?NumericQ, _?NumericQ}, CanvasRadius : {_?NumericQ, \
_?NumericQ}, AngleRange : {theta1_?NumericQ, theta2_?NumericQ}, CanvasPivot : \
{_?NumericQ, _?NumericQ}, RotationAngle_?NumericQ,
   OrthoMode : (Normal | Tangent), Arg : ((t_?NumericQ) | \
Scaled[t_?NumericQ])
   ] := Module[
   {theta, AnchorPoint, TangentAngle, AnchorAngle, AnchorOffset},
   
   theta = Switch[
     Arg,
     _?NumericQ, t, (* literal angle, before rotation *)
     Scaled[_?NumericQ], RescaleInterval[{0, 1}, {theta1, theta2}][t]  (* \
scaled from 0 to 1 on displayed arc *)
     ];
   AnchorPoint = RotationTransform[RotationAngle, CanvasPivot]@(CanvasCenter \
+ CanvasRadius*{Cos[theta], Sin[theta]});
   AnchorOffset = Switch[OrthoMode, Normal, {-1, 0}, Tangent, {0, -1}];
   TangentAngle = VectorArcTan[CanvasRadius*{Sin[theta], -Cos[theta]}] + \
RotationAngle; (* tangent vector in negative theta sense *)
   AnchorAngle = TangentAngle + Switch[OrthoMode, Normal, +Pi/2, Tangent, 0];
   
   FigAnchor[Canvas[AnchorPoint], AnchorOffset, AnchorAngle]
   ];\
\>", "Program",
 CellChangeTimes->{{3.51562248925*^9, 3.515622550609375*^9}, {
   3.51562259421875*^9, 3.515622770515625*^9}, {3.515622819828125*^9, 
   3.51562290796875*^9}, {3.515623667421875*^9, 3.515623667875*^9}, {
   3.51562374040625*^9, 3.5156238078125*^9}, 3.515623878640625*^9, {
   3.515623915140625*^9, 3.515623923640625*^9}, 3.515624255578125*^9, 
   3.515624289046875*^9, 3.515624322640625*^9, {3.515680598203125*^9, 
   3.515680612328125*^9}, 3.515680671671875*^9, {3.5156808*^9, 
   3.515680806640625*^9}, {3.515683432125*^9, 3.51568353646875*^9}, {
   3.51568358396875*^9, 3.51568360671875*^9}, {3.515683790921875*^9, 
   3.515683817*^9}, {3.515855906578125*^9, 3.515855910234375*^9}, 
   3.5180189155*^9, 3.519564636328125*^9, 3.519565432015625*^9, {
   3.519645741390625*^9, 3.51964577971875*^9}, {3.519645824046875*^9, 
   3.519645841515625*^9}, 3.5665957046978316`*^9, 3.566595865511714*^9, 
   3.583516245635868*^9},ExpressionUUID->"97703f55-f5d9-4692-90b6-\
cfb7ca53da60"],

Cell["\<\
Revised: FigCircle leaves the angles unsorted, so curve sense can be either \
way.  The d(theta) for the tangent is in the same sense as the delta(theta) \
of the angles.  The scaled curve parameter runs from 0=Tail to 1=Head.\
\>", "Text",
 CellChangeTimes->{{3.51568368459375*^9, 3.515683699953125*^9}, {
   3.51596956909375*^9, 3.5159695745625*^9}, {3.566596935201379*^9, 
   3.5665969941814613`*^9}, {3.56659702876151*^9, 3.5665970707915688`*^9}, {
   3.5665974743421335`*^9, 3.566597481462143*^9}, {3.584015739599758*^9, 
   3.584015825337509*^9}, 
   3.5840158901400228`*^9},ExpressionUUID->"a31b350c-c8da-4fbc-9e5b-\
1157416b8869"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"OrthoMode", ":", 
      RowBox[{"(", 
       RowBox[{"Normal", "|", "Tangent"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{"{", 
         RowBox[{"\"\<Angle\>\"", ",", 
          RowBox[{"t_", "?", "NumericQ"}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theta", ",", "AnchorPoint", ",", "TangentAngle", ",", "AnchorAngle", 
       ",", "AnchorOffset", ",", "ArcSense"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"arc", " ", 
       RowBox[{"sense", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"+", "1"}], " ", "for", " ", "CCW", " ", "or"}], " ", "-", 
         RowBox[{"1", " ", "for", " ", "CW"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArcSense", "=", 
       RowBox[{"Sign", "[", 
        RowBox[{"theta2", "-", "theta1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{"Arg", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Angle\>\"", ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "t", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"literal", " ", "angle"}], ",", " ", 
           RowBox[{"before", " ", "rotation"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{
          RowBox[{"RescaleInterval", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"theta1", ",", "theta2"}], "}"}]}], "]"}], "[", "t", 
          "]"}]}], "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "scaled", " ", "from", " ", "0", " ", "to", " ", "1", " ", "on", " ",
           "displayed", " ", "arc"}], " ", "*)"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AnchorPoint", "=", 
       RowBox[{
        RowBox[{"RotationTransform", "[", 
         RowBox[{"RotationAngle", ",", "CanvasPivot"}], "]"}], "@", 
        RowBox[{"(", 
         RowBox[{"CanvasCenter", "+", 
          RowBox[{"CanvasRadius", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "theta", "]"}], ",", 
             RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AnchorOffset", "=", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"OrthoMode", ",", "Normal", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", "Tangent", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", "ArcSense"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "trig", " ", "gives", " ", "tangent", " ", "vector", " ", "in", " ", 
         "negative", " ", "theta", " ", 
         RowBox[{"sense", " ", "--"}], " ", "for", " ", "arc", " ", 
         "tangent"}], ",", " ", 
        RowBox[{
         RowBox[{
         "this", " ", "must", " ", "be", " ", "flipped", " ", "if", " ", 
          "delta", " ", "theta", " ", "is", " ", "positive"}], ";", " ", 
         RowBox[{"for", " ", "outward", " ", "normal"}]}], ",", " ", 
        RowBox[{"this", " ", "must", " ", "have", " ", 
         RowBox[{"Pi", "/", "2"}], " ", "added"}]}], "  ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"TangentAngle", "=", 
       RowBox[{
        RowBox[{"VectorArcTan", "[", 
         RowBox[{"CanvasRadius", "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "theta", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}]}], "]"}], "+", 
        "RotationAngle"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "trig", " ", "gives", " ", "tangent", " ", "vector", " ", "in", " ", 
         "negative", " ", "theta", " ", "sense"}], ",", " ", 
        RowBox[{"which", " ", "y"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AnchorAngle", "=", 
       RowBox[{"TangentAngle", "+", 
        RowBox[{"Switch", "[", 
         RowBox[{"OrthoMode", ",", "Normal", ",", 
          RowBox[{
           RowBox[{"+", "Pi"}], "/", "2"}], ",", "Tangent", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{"ArcSense", ",", 
            RowBox[{"+", "1"}], ",", "Pi", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "|", "0"}], ",", "0"}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "AnchorPoint", "]"}], ",", "AnchorOffset", ",",
         "AnchorAngle"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"OrthoMode", ":", 
      RowBox[{"(", 
       RowBox[{"Normal", "|", "Tangent"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "\[IndentingNewLine]", 
     "OrthoMode", ",", "0.5"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51562248925*^9, 3.515622550609375*^9}, {
   3.51562259421875*^9, 3.515622770515625*^9}, {3.515622819828125*^9, 
   3.51562290796875*^9}, {3.515623667421875*^9, 3.515623667875*^9}, {
   3.51562374040625*^9, 3.5156238078125*^9}, 3.515623878640625*^9, {
   3.515623915140625*^9, 3.515623923640625*^9}, 3.515624255578125*^9, 
   3.515624289046875*^9, 3.515624322640625*^9, {3.515680598203125*^9, 
   3.515680612328125*^9}, 3.515680671671875*^9, {3.5156808*^9, 
   3.515680806640625*^9}, {3.515683432125*^9, 3.51568353646875*^9}, {
   3.51568358396875*^9, 3.51568360671875*^9}, {3.515683790921875*^9, 
   3.515683817*^9}, {3.515855906578125*^9, 3.515855910234375*^9}, 
   3.5180189155*^9, 3.519564636328125*^9, 3.519565432015625*^9, {
   3.519645741390625*^9, 3.51964577971875*^9}, {3.519645824046875*^9, 
   3.519645841515625*^9}, 3.5665957046978316`*^9, 3.566595865511714*^9, {
   3.5665973726719913`*^9, 3.5665974943121614`*^9}, {3.56659753637222*^9, 
   3.5665975511922407`*^9}, 3.566597867942684*^9, {3.5665979308827724`*^9, 
   3.566597934757778*^9}, {3.56659813875869*^9, 3.5665981489767084`*^9}, {
   3.5665993598066673`*^9, 3.566599415370021*^9}, {3.5835189416845284`*^9, 
   3.5835189595465593`*^9}, {3.5835189946310205`*^9, 3.583519007329443*^9}, {
   3.5835191977785077`*^9, 3.5835192222705507`*^9}, {3.5840161439056683`*^9, 
   3.5840162685678873`*^9}, {3.5840163089095583`*^9, 
   3.5840163956301107`*^9}},ExpressionUUID->"943b1d9e-debf-4fae-91eb-\
fee55293f537"],

Cell["Head/Tail anchors -- tangent at endpoint of arc", "Text",
 CellChangeTimes->{{3.5665971736917124`*^9, 
  3.566597184201727*^9}},ExpressionUUID->"10624c2f-9137-43e5-a2f0-\
7e8faaf8f543"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Tail"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "Tangent", ",", "0"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Head"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "Tangent", ",", "1"}], "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515683625984375*^9, 3.515683646890625*^9}, {
  3.515683810796875*^9, 3.515683811484375*^9}, {3.515855497171875*^9, 
  3.515855498296875*^9}, {3.515855899234375*^9, 3.51585590309375*^9}, {
  3.519647308984375*^9, 3.51964730965625*^9}, {3.519651832625*^9, 
  3.519651837796875*^9}, {3.520277971359375*^9, 3.520277976140625*^9}, {
  3.5665957034654293`*^9, 3.5665957044170313`*^9}, {3.566595865511714*^9, 
  3.566595865511714*^9}, {3.5665970146014895`*^9, 3.5665970159614916`*^9}, {
  3.5835269632193575`*^9, 
  3.583526965619361*^9}},ExpressionUUID->"fe4d46a4-25d5-465f-bb60-\
8f41a74dd336"],

Cell["\<\
Bounding radii
\tdefault text offset chosen to put labels outside if arc is in CCW \
(positive) sense\
\>", "Text",
 CellChangeTimes->{{3.5767712565270863`*^9, 3.576771257542088*^9}, {
   3.576771409782301*^9, 3.5767714113873034`*^9}, 3.576771869080945*^9, {
   3.5767731940498266`*^9, 
   3.576773217232682*^9}},ExpressionUUID->"1539d336-3366-4704-ae27-\
4361a55e98ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"HeadRadius", "|", "TailRadius"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", 
      RowBox[{"(", 
       RowBox[{"p_", "?", "NumericQ"}], ")"}]}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CenterPoint", ",", "EndPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CenterPoint", "=", 
       RowBox[{"FigResolvePoint", "[", 
        RowBox[{"FigCircleAnchor", "[", 
         RowBox[{
         "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
          "CanvasPivot", ",", "RotationAngle", ",", "Center", ",", "None"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"EndPoint", "=", 
       RowBox[{"FigResolvePoint", "[", 
        RowBox[{"FigCircleAnchor", "[", 
         RowBox[{
         "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
          "CanvasPivot", ",", "RotationAngle", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "Name", ",", "HeadRadius", ",", "Head", ",", "TailRadius", ",", 
            "Tail"}], "]"}], ",", "None"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCurveAnchorFromPoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"CenterPoint", ",", "EndPoint"}], "}"}], ",", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "Name", ",", "HeadRadius", ",", "Left", ",", "TailRadius", ",", 
          "Right"}], "]"}], ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"HeadRadius", "|", "TailRadius"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "\[IndentingNewLine]", "Name", 
     ",", "0.5"}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, 
   3.51561961984375*^9, 3.51568066303125*^9, {3.51568074428125*^9, 
   3.5156807529375*^9}, {3.5156833859375*^9, 3.515683449140625*^9}, {
   3.515683529125*^9, 3.51568352978125*^9}, {3.515683574328125*^9, 
   3.51568360171875*^9}, 3.515686652203125*^9, 3.515855486375*^9, {
   3.51585589378125*^9, 3.51585589428125*^9}, {3.515856060390625*^9, 
   3.5158560630625*^9}, 3.515856410328125*^9, {3.51585677471875*^9, 
   3.51585680621875*^9}, 3.5158570951875*^9, 3.518018907359375*^9, {
   3.519647305734375*^9, 3.519647306796875*^9}, {3.519651750765625*^9, 
   3.519651753296875*^9}, 3.5202765048125*^9, 3.566595702638628*^9, 
   3.566595865496114*^9, {3.5767713637272367`*^9, 3.576771460347372*^9}, {
   3.5767715066124363`*^9, 3.5767715190674543`*^9}, {3.576771807910859*^9, 
   3.576771942791048*^9}, {3.5767730199921527`*^9, 3.5767730241197166`*^9}, {
   3.5767731004908895`*^9, 3.5767731037684393`*^9}, {3.5767731912397833`*^9, 
   3.576773191564788*^9}, {3.5767732407155433`*^9, 3.5767732522657204`*^9}, {
   3.576773359907374*^9, 3.57677337270757*^9}, {3.576773476491665*^9, 
   3.576773513160978*^9}},ExpressionUUID->"eba71194-cce8-49de-8ec6-\
90d0fa139378"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circle bounding box", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 3.515619463203125*^9}, {
  3.515854266515625*^9, 3.5158542678125*^9}, {3.5158594105625*^9, 
  3.515859412515625*^9}, {3.515860078078125*^9, 
  3.515860079015625*^9}},ExpressionUUID->"6855f0a2-aced-475d-8145-\
d65ea6df9e01"],

Cell["\<\
currently just calculated as bounding box of principal axis end points
\t-- works for nonrotated ellipse
\t-- will underestimage bounding box for tilted ellipse
\t-- neglects possible restriction to arc\
\>", "Text",
 CellChangeTimes->{{3.51586008065625*^9, 
  3.5158601953125*^9}},ExpressionUUID->"f06a1957-99fb-4adc-8ebe-a4d936cf15bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleBoundingBox", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"FigPointSetBoundingBox", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", "Offset"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Offset", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585942346875*^9, 3.5158595128125*^9}, 
   3.5158601023125*^9, {3.515860177234375*^9, 3.51586020246875*^9}, 
   3.566595704978632*^9, 
   3.5665958655273137`*^9},ExpressionUUID->"35bd0df5-0357-46fe-b125-\
bad891509c84"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor manipulation and retrieval", "Section",
 CellChangeTimes->{{3.516036002505125*^9, 3.516036006911375*^9}, {
   3.516039281380125*^9, 3.51603928558325*^9}, 3.519492527984375*^9, {
   3.566665386039364*^9, 3.566665401733261*^9}, {3.625170085020852*^9, 
   3.625170088624459*^9}},ExpressionUUID->"9436bc2c-5a58-4537-a88b-\
0615f8eb7d7b"],

Cell[CellGroupData[{

Cell["Anchor translation (displacement)", "Subsection",
 CellChangeTimes->{{3.51595657415625*^9, 3.51595657834375*^9}, {
  3.51603597177075*^9, 
  3.516035974786375*^9}},ExpressionUUID->"eab35f1d-7b7a-4c68-9ad1-\
d64d543f907f"],

Cell["\<\
\tNote: These functions return an anchor *object*, not an anchor name.
\tThese definitions must come after all relevant argument patterns have been \
defined above.\
\>", "Text",
 CellChangeTimes->{{3.515614705796875*^9, 3.51561471359375*^9}, {
   3.51595655615625*^9, 3.51595657075*^9}, {3.51603599058325*^9, 
   3.516035997661375*^9}, {3.516285088953125*^9, 3.516285121140625*^9}, {
   3.516285172265625*^9, 3.5162852559375*^9}, {3.516285722578125*^9, 
   3.5162857229375*^9}, 3.518105071890625*^9, {3.518200813046875*^9, 
   3.5182008155*^9}, {3.625169911673348*^9, 3.62516991273415*^9}, {
   3.6251700170359335`*^9, 
   3.625170039999173*^9}},ExpressionUUID->"6e7e72f8-ec0b-4f60-a3f9-\
f6212eacfeb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DisplacePoint", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"Args", ":", 
      RowBox[{"FigDisplacementSequencePattern", "[", "0", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "CanvasPoint"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "DisplacePoint", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasPoint", "=", 
       RowBox[{
        RowBox[{"a", "@", 
         RowBox[{"GetPoint", "[", "]"}]}], "+", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{"FigResolveDisplacement", "/@", 
           RowBox[{"{", "Args", "}"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "DisplacePoint", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515861009296875*^9, 3.515861025171875*^9}, {3.515861290765625*^9, 
   3.515861293328125*^9}, 3.51586143853125*^9, 3.516283558390625*^9, {
   3.516284480625*^9, 3.516284488890625*^9}, 3.516284603328125*^9, {
   3.51628507803125*^9, 3.516285083796875*^9}, {3.5162857265625*^9, 
   3.516285736234375*^9}, {3.5162880086875*^9, 3.516288009328125*^9}, 
   3.51801887934375*^9, 3.51810507484375*^9, {3.625164428242117*^9, 
   3.6251644282577167`*^9}, {3.6251673547790565`*^9, 
   3.6251673708158855`*^9}, {3.6251687134498434`*^9, 
   3.625168718488652*^9}},ExpressionUUID->"a5f88697-d8c7-4310-b9b0-\
362422f6ed87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProjectPoint", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"CoordinateIndexName", ":", 
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
     RowBox[{"x", ":", "FigCoordinatePattern"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CoordinateIndex", ",", "xc", ",", "a", ",", "CanvasPoint"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "ProjectPoint", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resolve", " ", "coordinate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CoordinateIndex", "=", 
       RowBox[{
       "FigResolveCoordinateIndex", "[", "CoordinateIndexName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xc", "=", 
       RowBox[{"FigResolveCoordinate", "[", 
        RowBox[{"x", ",", "CoordinateIndex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"substitute", " ", "coordinate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasPoint", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "@", 
           RowBox[{"GetPoint", "[", "]"}]}], ")"}], ",", 
         RowBox[{"CoordinateIndex", "\[Rule]", "xc"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "ProjectPoint", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515861009296875*^9, 3.515861025171875*^9}, {3.515861290765625*^9, 
   3.515861293328125*^9}, 3.51586143853125*^9, 3.516283558390625*^9, {
   3.516284480625*^9, 3.516284488890625*^9}, 3.516284603328125*^9, {
   3.51628507803125*^9, 3.516285083796875*^9}, {3.5162857265625*^9, 
   3.516285736234375*^9}, {3.5162880086875*^9, 3.516288009328125*^9}, 
   3.51801887934375*^9, 3.51810507484375*^9, {3.625164428242117*^9, 
   3.6251644282577167`*^9}, {3.625166974029188*^9, 3.6251670039968405`*^9}, 
   3.625167098985408*^9, {3.625167163787922*^9, 3.625167340895033*^9}, {
   3.625167407397949*^9, 3.625167412514758*^9}, {3.6251687219674587`*^9, 
   3.625168727630268*^9}, 3.6251687709359446`*^9, {3.62534276399308*^9, 
   3.6253427669414854`*^9}},ExpressionUUID->"4a25313d-05de-4bb5-bcfc-\
daebe52a3b5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplaceAlongAnchor", "[", 
     RowBox[{
      RowBox[{"p", ":", "FigPointPattern"}], ",", 
      RowBox[{"d_", "?", "NumericQ"}]}], "]"}], "/;", 
    RowBox[{"(", "SciDraw`Private`$InFigure", ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "theta", ",", "CanvasPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "DisplacePoint", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"a", "@", 
        RowBox[{"GetAngle", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasPoint", "=", 
       RowBox[{
        RowBox[{"a", "@", 
         RowBox[{"GetPoint", "[", "]"}]}], "+", 
        RowBox[{"d", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "DisplaceAlongAnchor", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515861009296875*^9, 3.515861025171875*^9}, {3.515861290765625*^9, 
   3.515861293328125*^9}, 3.51586143853125*^9, {3.516036046130125*^9, 
   3.516036154380125*^9}, 3.51628355946875*^9, 3.51628512365625*^9, {
   3.516285739765625*^9, 3.516285740015625*^9}, {3.51628801021875*^9, 
   3.516288010859375*^9}, 3.518018887046875*^9, 3.518105077640625*^9, {
   3.51820080809375*^9, 3.51820080990625*^9}, 3.6251644282577167`*^9, 
   3.625166611780952*^9, {3.625167381252303*^9, 3.625167392609123*^9}, {
   3.625168730126273*^9, 
   3.6251687344942803`*^9}},ExpressionUUID->"5717155a-3261-4bf0-b1eb-\
9a0f4292f210"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor rotation", "Subsection",
 CellChangeTimes->{{3.515956585390625*^9, 3.515956604296875*^9}, {
  3.51603601983325*^9, 
  3.51603602120825*^9}},ExpressionUUID->"c5a8f3bf-142d-475d-9a2f-\
fac178e1b1df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotateAnchor", "[", 
     RowBox[{
      RowBox[{"p", ":", "FigPointPattern"}], ",", 
      RowBox[{"theta", ":", "ScalarParameterPattern"}]}], "]"}], "/;", 
    RowBox[{"(", "SciDraw`Private`$InFigure", ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Anchor", ",", "CanvasPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "RotateAnchor", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", 
         RowBox[{"Anchor", "@", 
          RowBox[{"GetPoint", "[", "]"}]}], "]"}], ",", 
        RowBox[{"Anchor", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Anchor", "@", 
          RowBox[{"GetAngle", "[", "]"}]}], "+", 
         RowBox[{"UpgradeScalar", "[", "theta", "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515685960203125*^9, 3.515686035375*^9}, {3.515861301453125*^9, 
   3.5158613055625*^9}, 3.516285140375*^9, {3.51628576609375*^9, 
   3.516285771078125*^9}, 3.518018893609375*^9, 
   3.5181050800625*^9},ExpressionUUID->"b46e65f5-e5f6-4264-8ad2-b4437021e4ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor angle retrieval", "Subsection",
 CellChangeTimes->{{3.516039288677*^9, 
  3.516039293942625*^9}},ExpressionUUID->"b271bbc9-2798-49b3-92a8-\
e1c3bc2cf6ac"],

Cell["User-level anchor retrieval functions", "Text",
 CellChangeTimes->{{3.5666646506490803`*^9, 
  3.5666646614492464`*^9}},ExpressionUUID->"4f27f78d-8627-49a9-8dbc-\
aee5b9fc9b98"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnchorAngle", "[", 
    RowBox[{"p", ":", "FigPointPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Anchor", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "AnchorAngle", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Anchor", "@", 
       RowBox[{"GetAngle", "[", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.51603926645825*^9, {3.51603929883325*^9, 3.5160393302395*^9}, 
   3.516285143046875*^9, {3.516285773984375*^9, 3.516285778828125*^9}, 
   3.518105080953125*^9, 
   3.566664649116557*^9},ExpressionUUID->"921df90d-9c98-4de0-99a9-\
0afe4005b576"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor offset retrieval", "Subsection",
 CellChangeTimes->{{3.516039288677*^9, 3.516039293942625*^9}, {
  3.5796312984017916`*^9, 
  3.5796312992317924`*^9}},ExpressionUUID->"ee1987dc-d220-4ff3-926b-\
79b05188eafd"],

Cell["User-level anchor retrieval functions", "Text",
 CellChangeTimes->{{3.5666646506490803`*^9, 
  3.5666646614492464`*^9}},ExpressionUUID->"3151d00b-35bc-4bd3-943d-\
64c500b9aa63"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnchorOffset", "[", 
    RowBox[{"p", ":", "FigPointPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Anchor", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "AnchorAngle", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Anchor", "@", 
       RowBox[{"GetOffset", "[", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.51603926645825*^9, {3.51603929883325*^9, 3.5160393302395*^9}, 
   3.516285143046875*^9, {3.516285773984375*^9, 3.516285778828125*^9}, 
   3.518105080953125*^9, 3.566664649116557*^9, {3.579631303651799*^9, 
   3.5796313111218095`*^9}},ExpressionUUID->"7e33fd43-0b1a-4a4d-8df7-\
d710babdda97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor point retrieval -- in user coordinates", "Subsection",
 CellChangeTimes->{{3.516039288677*^9, 3.516039293942625*^9}, {
  3.5666102060712814`*^9, 3.566610206695283*^9}, {3.5666646658668146`*^9, 
  3.5666646686168566`*^9}},ExpressionUUID->"42533957-f700-4762-b8a8-\
3e4b38b77eb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnchorCoordinates", "[", 
    RowBox[{"p", ":", "FigPointPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Anchor", ",", "CanvasCoordinates"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "AnchorCoordinates", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasCoordinates", "=", 
       RowBox[{"Anchor", "@", 
        RowBox[{"GetPoint", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CurrentWindow", "[", "]"}], "@", 
         RowBox[{"InverseTFunction", "[", "]"}]}], ")"}], "@", 
       "CanvasCoordinates"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566664353770233*^9, 3.5666644346382627`*^9}, {
  3.566664523324625*^9, 3.5666645890531344`*^9}, {3.5666646332613134`*^9, 
  3.5666646423814535`*^9}, {3.5666818751319184`*^9, 3.5666818859895377`*^9}, {
  3.566935770248131*^9, 
  3.5669357994481716`*^9}},ExpressionUUID->"7dd0dcb7-f208-4bc2-af9b-\
dc58c78ed1b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Canvas angle for ray between anchors", "Subsection",
 CellChangeTimes->{{3.5666656315404053`*^9, 3.5666656346595836`*^9}, {
  3.5666656767709923`*^9, 
  3.566665680659215*^9}},ExpressionUUID->"d13d086d-626c-4878-bdf3-\
7ed6e1f82970"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CanvasRayAngle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", "FigPointPattern"}], ",", 
      RowBox[{"p2", ":", "FigPointPattern"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CanvasCoordinates1", ",", "CanvasCoordinates2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "CanvasAngle", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VectorArcTan", "[", 
       RowBox[{
        RowBox[{"FigResolvePoint", "[", "p2", "]"}], "-", 
        RowBox[{"FigResolvePoint", "[", "p1", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566664353770233*^9, 3.5666644346382627`*^9}, {
  3.566664523324625*^9, 3.5666645890531344`*^9}, {3.5666646332613134`*^9, 
  3.5666646423814535`*^9}, {3.5666656481193533`*^9, 3.5666657733325157`*^9}, {
  3.5666658778294926`*^9, 
  3.566665878212514*^9}},ExpressionUUID->"c18aba31-17ff-4806-9493-\
221125f0faa0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve geometry", "Section",
 CellChangeTimes->{{3.51516648646875*^9, 3.5151664916875*^9}, {
  3.515617659953125*^9, 
  3.515617686125*^9}},ExpressionUUID->"02b01af3-b007-4e61-81b4-ff7d1677ce0e"],

Cell[CellGroupData[{

Cell["Curve pattern", "Subsection",
 CellChangeTimes->{{3.515883408046875*^9, 3.515883414421875*^9}, {
  3.51595348815625*^9, 
  3.5159534889375*^9}},ExpressionUUID->"7bb03c93-0b31-41eb-b777-696879545d30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FigCurvePointPattern", "=", 
   RowBox[{"FigPointPattern", "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DisplaceTail", "|", "DisplaceHead"}], ")"}], "[", 
     RowBox[{"FigDisplacementSequencePattern", "[", "0", "]"}], "]"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DisplaceAlongTail", "|", "DisplaceAlongHead"}], ")"}], "[", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ProjectTail", "|", "ProjectHead"}], ")"}], "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical"}], ")"}], ",", 
      "FigCoordinatePattern"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FigCurvePointSetPattern", "=", 
   RowBox[{"{", 
    RowBox[{"Repeated", "[", 
     RowBox[{"FigCurvePointPattern", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "Infinity"}], "}"}]}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FigCurvePattern", "=", 
   RowBox[{"FigCurvePointSetPattern", "|", 
    RowBox[{"(", "_Graphics", ")"}], "|", 
    RowBox[{"(", "_ContourGraphics", ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516283186265625*^9, 3.51628318815625*^9}, {
  3.5162832189375*^9, 3.51628329253125*^9}, {3.5162835826875*^9, 
  3.5162836025*^9}, {3.5162837275625*^9, 3.51628374403125*^9}, {
  3.516283788109375*^9, 3.51628381334375*^9}, {3.516284513390625*^9, 
  3.5162845241875*^9}, {3.6253416716323614`*^9, 3.6253417003364115`*^9}, {
  3.6254525300423994`*^9, 3.625452557186447*^9}, {3.6254530234556665`*^9, 
  3.625453035951288*^9}},ExpressionUUID->"a99f6009-ad9f-4ae8-b359-\
f3bb1f9474a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard curve options", "Subsection",
 CellChangeTimes->{{3.51568126209375*^9, 3.515681269890625*^9}, {
  3.516046314177*^9, 
  3.5160463161145*^9}},ExpressionUUID->"962a3146-39fb-4e35-bfa2-0d6ef9f94334"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigCurveOptions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"curve", " ", "geometry"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TailRecess", "\[Rule]", "None"}], ",", 
     RowBox[{"HeadRecess", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"curve", " ", "extraction"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["Line",
       InitializationCell->True], 
      StyleBox["\[Rule]",
       InitializationCell->True], "1"}]}], 
    StyleBox["\[IndentingNewLine]",
     InitializationCell->True], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515430903687875*^9, 3.515430989031625*^9}, {
   3.515431026844125*^9, 3.515431030625375*^9}, {3.515431105094125*^9, 
   3.5154311113285*^9}, 3.515609867390625*^9, {3.515610068609375*^9, 
   3.51561007096875*^9}, {3.515787829515625*^9, 3.515787850234375*^9}, {
   3.5160413966145*^9, 
   3.516041420942625*^9}},ExpressionUUID->"db645404-d0fa-4500-bb6a-\
0de957e49236"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckCurveOptions", "[", "Self_Object", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "TailRecess", ",", "ScalarParameterPattern", ",", 
        "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "HeadRecess", ",", "ScalarParameterPattern", ",", 
        "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"FigCheckOption", "[", 
        RowBox[{"Self", ",", "Line", ",", 
         RowBox[{"Join", "|", "All", "|", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", "_Integer", ")"}], "?", "Positive"}], ")"}]}], ",", 
         "FigOptions"}], "]"}],
       InitializationCell->True], 
      StyleBox[";",
       InitializationCell->True]}]}], 
    StyleBox["\[IndentingNewLine]",
     InitializationCell->True], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5156100370625*^9, 3.515610074328125*^9}, {
   3.515610247703125*^9, 3.515610248765625*^9}, 3.515611180921875*^9, 
   3.5157083741875*^9, {3.515708423828125*^9, 3.515708423953125*^9}, {
   3.51578785253125*^9, 3.51578789315625*^9}, {3.51604140527075*^9, 
   3.51604141270825*^9}},ExpressionUUID->"b47a2ff1-ff7e-40b4-bbc7-\
8d246daf030e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve resolution -- point set", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
  3.515616414640625*^9, 3.515616416671875*^9}, {3.515883295578125*^9, 
  3.5158832963125*^9}, {3.516039564177*^9, 
  3.51603956602075*^9}},ExpressionUUID->"eb23eaa0-c86a-4a33-94d7-\
6ad9117cca07"],

Cell["\<\
Resolves list of two or more points into canvas coordinates, making use of \
the special curve options for head and tail positioning.\
\>", "Text",
 CellChangeTimes->{{3.515541825421875*^9, 3.515541838140625*^9}, {
  3.5156001483125*^9, 3.515600176546875*^9}, {3.515600221875*^9, 
  3.515600281890625*^9}, {3.51560485615625*^9, 3.515604856515625*^9}, {
  3.515861223421875*^9, 3.51586124259375*^9}, {3.515883302390625*^9, 
  3.515883324203125*^9}},ExpressionUUID->"c3a4942e-9246-4b22-8306-\
32a8f83abfe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "figcurveref"}], "=", 
   "\"\<Circular reference in curve specification, with tail point `1` and \
head point `2`.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5162839851875*^9, 3.51628400759375*^9}, 
   3.51628776475*^9},ExpressionUUID->"5fc87673-89fa-4461-a27d-d2377d7c978e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCurve", "[", 
    RowBox[{"Self_Object", ",", 
     RowBox[{"Points", ":", "FigCurvePointSetPattern"}], ",", 
     "FullOptions_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p1", ",", "p2", ",", "DereferencedPoints", ",", "CanvasPoints", ",", 
       "CanvasHead", ",", "CanvasTail"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "resolve", " ", "tail", " ", "and", " ", "head", " ", "displacement", 
       " ", "references"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", "=", 
       RowBox[{"First", "[", "Points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Last", "[", "Points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"sanity", " ", 
          RowBox[{"checks", " ", "--"}], " ", "head", " ", "cannot", " ", 
          "be", " ", "relative", " ", "to", " ", "head"}], ",", " ", 
         RowBox[{
         "tail", " ", "cannot", " ", "be", " ", "relative", " ", "to", " ", 
          "tail"}], ",", " ", 
         RowBox[{"and", " ", "head", " ", 
          RowBox[{"can", "'"}], "t", " ", "be", " ", "chasing", " ", "tail", 
          " ", "circularly"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"p1", ",", 
           RowBox[{
            RowBox[{"(", "_DisplaceTail", ")"}], "|", 
            RowBox[{"(", "_DisplaceAlongTail", ")"}], "|", 
            RowBox[{"(", "_ProjectTail", ")"}]}]}], "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"p2", ",", 
           RowBox[{
            RowBox[{"(", "_DisplaceHead", ")"}], "|", 
            RowBox[{"(", "_DisplaceAlongHead", ")"}], "|", 
            RowBox[{"(", "_ProjectHead", ")"}]}]}], "]"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"p1", ",", 
             RowBox[{
              RowBox[{"(", "_DisplaceHead", ")"}], "|", 
              RowBox[{"(", "_DisplaceAlongHead", ")"}], "|", 
              RowBox[{"(", "_ProjectHead", ")"}]}]}], "]"}], "&&", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"p2", ",", 
             RowBox[{
              RowBox[{"(", "_DisplaceTail", ")"}], "|", 
              RowBox[{"(", "_DisplaceAlongTail", ")"}], "|", 
              RowBox[{"(", "_ProjectTail", ")"}]}]}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FigError", "[", 
         RowBox[{"Self", ",", "\"\<figcurveref\>\"", ",", "p1", ",", "p2"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DereferencedPoints", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"Points", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"DisplaceTail", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            RowBox[{"DisplacePoint", "[", 
             RowBox[{"p1", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ProjectTail", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ProjectPoint", "[", 
             RowBox[{"p1", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DisplaceAlongTail", "[", "ArgSeq___", "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"DisplaceAlongAnchor", "[", 
             RowBox[{"p1", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DisplaceHead", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            RowBox[{"DisplacePoint", "[", 
             RowBox[{"p2", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ProjectHead", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ProjectPoint", "[", 
             RowBox[{"p2", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DisplaceAlongHead", "[", "ArgSeq___", "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"DisplaceAlongAnchor", "[", 
             RowBox[{"p2", ",", "ArgSeq"}], "]"}]}]}], "\[IndentingNewLine]", 
          "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resolve", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasPoints", "=", 
       RowBox[{"FigResolvePoint", "/@", "DereferencedPoints"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "tail", " ", "and", " ", "head", " ", "recess"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasTail", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", "2"}], "]"}], ",", 
         "\[IndentingNewLine]", "Tail", ",", "Absolute", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"UpgradeScalar", "[", 
          RowBox[{"(", 
           RowBox[{"TailRecess", "/.", "FullOptions"}], ")"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasHead", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", "\[IndentingNewLine]", "Head", 
         ",", "Absolute", ",", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"UpgradeScalar", "[", 
           RowBox[{"(", 
            RowBox[{"HeadRecess", "/.", "FullOptions"}], ")"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"CanvasPoints", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "CanvasTail"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", "CanvasHead"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.51578413475*^9, 
   3.515784134765625*^9}, {3.5158833268125*^9, 3.515883339609375*^9}, {
   3.5158834336875*^9, 3.515883664703125*^9}, {3.515883697390625*^9, 
   3.515883702359375*^9}, {3.515883763125*^9, 3.5158837834375*^9}, {
   3.516039730223875*^9, 3.516039733067625*^9}, 3.516041458442625*^9, {
   3.516283690546875*^9, 3.516283692015625*^9}, {3.5162837529375*^9, 
   3.516283782609375*^9}, {3.51628382984375*^9, 3.516283855359375*^9}, {
   3.51628388653125*^9, 3.5162839798125*^9}, {3.5162840126875*^9, 
   3.516284094875*^9}, {3.516284135125*^9, 3.51628416175*^9}, {
   3.516287709125*^9, 3.516287721984375*^9}, {3.51628800634375*^9, 
   3.516288007140625*^9}, {3.51951355859375*^9, 3.519513605671875*^9}, {
   3.6251644284293165`*^9, 3.6251644284293165`*^9}, {3.6251666043865385`*^9, 
   3.62516660490134*^9}, {3.625341741504884*^9, 3.625341886117138*^9}, {
   3.6254525703528705`*^9, 3.62545263868099*^9}, {3.625452676947858*^9, 
   3.6254527487235837`*^9}, {3.6254530179020567`*^9, 
   3.6254530487901106`*^9}},ExpressionUUID->"31f6d5f2-0e2f-4e6d-82da-\
4eedfd0e3ec3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve resolution -- from graphics", "Subsection",
 CellChangeTimes->{{3.51543991717225*^9, 3.515439949641*^9}, 
   3.515449053281625*^9, {3.515449138891*^9, 3.515449139687875*^9}, {
   3.516039575130125*^9, 
   3.516039577067625*^9}},ExpressionUUID->"d105aff9-a39a-4077-9215-\
59051d8589a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCurve", "[", 
    RowBox[{"Self_Object", ",", 
     RowBox[{"G", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", "_Graphics", ")"}], "|", 
        RowBox[{"(", "_ContourGraphics", ")"}]}], ")"}]}], ",", 
     "FullOptions_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "GrabbedPoints", ",", "CanvasPoints", ",", "CanvasTail", ",", 
       "CanvasHead"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resolve", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"GrabbedPoints", "=", 
       RowBox[{"GrabPoints", "[", 
        RowBox[{"G", ",", 
         RowBox[{"FilterRules", "[", 
          RowBox[{"FullOptions", ",", 
           RowBox[{"Options", "[", "GrabPoints", "]"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"flatten", " ", "a", " ", "list", " ", "of", " ", "curves"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Line", "/.", "FullOptions"}], ")"}], "\[Equal]", "All"}],
           ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "GrabbedPoints", "]"}], "\[NotEqual]", 
           "0"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"GrabbedPoints", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"GrabbedPoints", ",", "1"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckValue", "[", 
       RowBox[{"Self", ",", "GrabbedPoints", ",", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"NumericalPairPattern", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "Infinity"}], "}"}]}], "]"}], "}"}], ",", 
        "\"\<list of extracted points\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasPoints", "=", 
       RowBox[{"FigResolvePoint", "/@", "GrabbedPoints"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "tail", " ", "and", " ", "head", " ", "recess"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasTail", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", "2"}], "]"}], ",", 
         "\[IndentingNewLine]", "Tail", ",", "Absolute", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"UpgradeScalar", "[", 
          RowBox[{"(", 
           RowBox[{"TailRecess", "/.", "FullOptions"}], ")"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasHead", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", "\[IndentingNewLine]", "Head", 
         ",", "Absolute", ",", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"UpgradeScalar", "[", 
           RowBox[{"(", 
            RowBox[{"HeadRecess", "/.", "FullOptions"}], ")"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"CanvasPoints", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "CanvasTail"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", "CanvasHead"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.51578413475*^9, 
   3.515784134765625*^9}, {3.5158833268125*^9, 3.515883339609375*^9}, {
   3.5158834336875*^9, 3.515883664703125*^9}, {3.515883697390625*^9, 
   3.515883702359375*^9}, {3.515883763125*^9, 3.5158837834375*^9}, {
   3.516039730223875*^9, 3.516039733067625*^9}, {3.5160414647395*^9, 
   3.516041467536375*^9}, {3.516041517348875*^9, 3.5160415202395*^9}, {
   3.516041566880125*^9, 3.516041684411375*^9}, {3.516283659921875*^9, 
   3.516283666140625*^9}, {3.516554463296875*^9, 3.516554471078125*^9}, {
   3.538849781453125*^9, 3.538849801171875*^9}, {3.53884989434375*^9, 
   3.538849897390625*^9}, {3.570135398645577*^9, 
   3.570135481438099*^9}},ExpressionUUID->"40b753a6-40bd-46e5-b10f-\
03581097ea3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve point geometry", "Subsection",
 CellChangeTimes->{{3.515166674140625*^9, 3.515166694546875*^9}, {
  3.519648423203125*^9, 3.519648429890625*^9}, {3.583350744594946*^9, 
  3.58335074693495*^9}},ExpressionUUID->"8389f1db-b38f-4147-a7a3-\
f6ed2ffb532e"],

Cell["\<\
Generation of underlying interpolation functions
Returns: {fRx,fRy} where fRx and fRy are scalar-valued functions of the \
scaled arc-length parameter [0,1]
\tfRx: u -> Rx
\tfRy: u -> Ry
The curve which these functions interpolate along is the simple \
segment-by-segment linear interpolation of the given curve points.\t\
\>", "Text",
 CellChangeTimes->{{3.5833503929560165`*^9, 3.5833504365241857`*^9}, {
  3.583350514875389*^9, 3.583350681352435*^9}, {3.583353219847192*^9, 
  3.5833532803422766`*^9}},ExpressionUUID->"ab580001-ed81-489d-b40f-\
ca2a87793ed8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "LinearInterpolationFunctionsRxRy", "[", "CanvasPoints_List", "]"}], ":=", 
   
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "Segments", ",", "SegmentLengths", ",", "TotalLength", ",", 
       "CurveParameterValues", ",", "\[IndentingNewLine]", "XFunction", ",", 
       "YFunction", ",", "DXFunction", ",", "DYFunction"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Segments", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"CanvasPoints", ",", "2", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SegmentLengths", "=", 
       RowBox[{"SegmentLength", "/@", "Segments"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveParameterValues", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Accumulate", "[", "SegmentLengths", "]"}], ",", "0"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TotalLength", "=", 
       RowBox[{"Last", "[", "CurveParameterValues", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveParameterValues", "=", 
       RowBox[{"CurveParameterValues", "/", "TotalLength"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "up", " ", "curve", " ", "interpolation"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"functions", " ", "for", " ", 
         RowBox[{"x", "[", "d", "]"}]}], ",", " ", 
        RowBox[{"y", "[", "d", "]"}], ",", " ", 
        RowBox[{"theta", "[", "d", "]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"XFunction", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurveParameterValues", ",", 
            RowBox[{"First", "/@", "CanvasPoints"}]}], "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"YFunction", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurveParameterValues", ",", 
            RowBox[{"Last", "/@", "CanvasPoints"}]}], "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"XFunction", ",", "YFunction"}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5162908211875*^9, 3.51629085715625*^9}, {
   3.520541559109375*^9, 3.520541560109375*^9}, {3.52054178821875*^9, 
   3.52054179059375*^9}, {3.5205420005*^9, 3.520542162859375*^9}, {
   3.520542347953125*^9, 3.520542355609375*^9}, {3.520542426984375*^9, 
   3.520542468265625*^9}, {3.520542553875*^9, 3.520542644640625*^9}, 
   3.5205427534375*^9, {3.5205428831875*^9, 3.520542895140625*^9}, {
   3.5833531409770813`*^9, 
   3.5833531853271437`*^9}},ExpressionUUID->"63938740-489f-44b0-bc04-\
51ea1b9bb387"],

Cell["\<\
Interpolation functions -- LEGACY packaging

Generation of underlying interpolation functions
\tfor curve itself and for tangent
Returns: {R,T} where R and T are vector-valued functions of the scaled \
arc-length parameter [0,1]
\tR: u -> {Rx,Ry}
\tT: u -> {Tx,Ty}
The curve which these functions interpolate along is the simple \
segment-by-segment linear interpolation of the given curve points.\t\
\>", "Text",
 CellChangeTimes->{{3.5833503929560165`*^9, 3.5833504365241857`*^9}, {
   3.583350514875389*^9, 3.583350681352435*^9}, 3.583353219847192*^9, {
   3.583353307672315*^9, 3.5833533299723463`*^9}, {3.58335353976764*^9, 
   3.583353550262655*^9}},ExpressionUUID->"facbe1ca-c57e-437a-8467-\
daed48b58e5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LinearInterpolationFunctionPair", "[", "CanvasPoints_List", "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "XFunction", ",", "YFunction", ",", "DXFunction", ",", "DYFunction"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"XFunction", ",", "YFunction"}], "}"}], "=", 
       RowBox[{
       "LinearInterpolationFunctionsRxRy", "[", "CanvasPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DXFunction", ",", "DYFunction"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "/@", 
        RowBox[{"{", 
         RowBox[{"XFunction", ",", "YFunction"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"construct", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"note", ":", " ", 
         RowBox[{
         "use", " ", "of", " ", "With", " ", "is", " ", "necessary", " ", 
          "to", " ", "force", " ", "correct", " ", "functions", " ", "into", 
          " ", "pure", " ", "function", " ", "definitions"}]}], ",", " ", 
        RowBox[{
        "rather", " ", "than", " ", "just", " ", "leaving", " ", "references",
          " ", "to", " ", "the", " ", "local", " ", "symbols", " ", 
         "XFunction"}], ",", " ", 
        RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "=", "XFunction"}], ",", 
          RowBox[{"y", "=", "YFunction"}], ",", 
          RowBox[{"dx", "=", "DXFunction"}], ",", 
          RowBox[{"dy", "=", "DYFunction"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "#", "]"}], ",", 
             RowBox[{"y", "[", "#", "]"}]}], "}"}], "&"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dx", "[", "#", "]"}], ",", 
             RowBox[{"dy", "[", "#", "]"}]}], "}"}], "&"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5162908211875*^9, 3.51629085715625*^9}, {
   3.520541559109375*^9, 3.520541560109375*^9}, {3.52054178821875*^9, 
   3.52054179059375*^9}, {3.5205420005*^9, 3.520542162859375*^9}, {
   3.520542347953125*^9, 3.520542355609375*^9}, {3.520542426984375*^9, 
   3.520542468265625*^9}, {3.520542553875*^9, 3.520542644640625*^9}, 
   3.5205427534375*^9, {3.5205428831875*^9, 3.520542895140625*^9}, {
   3.5833534722875457`*^9, 
   3.583353524507619*^9}},ExpressionUUID->"270ba7f2-54bd-4c3a-9b28-\
1d882e7f7f56"],

Cell["Segment extraction", "Text",
 CellChangeTimes->{{3.583350737060133*^9, 
  3.5833507393689365`*^9}},ExpressionUUID->"ae1911d4-0209-48f3-bef3-\
091906a37d48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CurveSegment", "::", "badsegment"}], "=", 
   "\"\<A curve with `1` points does not have a segment numbered `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CurveSegment", "::", "badsegmentzero"}], "=", 
   "\"\<Zero is not a valid segment number.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51949611628125*^9, 3.5194961466875*^9}, {
  3.519496259609375*^9, 
  3.519496286515625*^9}},ExpressionUUID->"e12c4aca-79ed-4233-bb28-\
c12b953faaba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurveSegment", "[", 
    RowBox[{"Points_List", ",", "s_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Points", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", ">", 
        RowBox[{"n", "-", "1"}]}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{
        "CurveSegment", ",", "\"\<badsegment\>\"", ",", "n", ",", "s"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "<", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{
        "CurveSegment", ",", "\"\<badsegment\>\"", ",", "n", ",", "s"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "\[Equal]", "0"}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurveSegment", ",", "\"\<badsegmentzero\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"s", ">", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", 
         RowBox[{"s", ";;", 
          RowBox[{"s", "+", "1"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "<", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"s", "-", "1"}], ";;", "s"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519496050109375*^9, 3.519496102953125*^9}, {
  3.519496179078125*^9, 3.51949624621875*^9}, {3.519496300828125*^9, 
  3.51949637259375*^9}, {3.51949663690625*^9, 3.519496638390625*^9}, {
  3.583351136951235*^9, 
  3.5833511436592464`*^9}},ExpressionUUID->"67be76ff-6c59-4ad8-9a7f-\
0caff2aec96a"],

Cell["Point extraction", "Text",
 CellChangeTimes->{{3.583351542285843*^9, 
  3.583351544415846*^9}},ExpressionUUID->"9a333f1f-0c51-40ab-84b8-\
991801f040ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CurvePoint", "::", "badpoint"}], "=", 
   "\"\<A curve with `1` points does not have a point numbered `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CurvePoint", "::", "badpointzero"}], "=", 
   "\"\<Zero is not a valid segment number.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516289231890625*^9, 3.516289257859375*^9}, {
  3.5195154558125*^9, 3.51951546165625*^9}, {3.519515525296875*^9, 
  3.51951554675*^9}},ExpressionUUID->"d9438c2c-73a0-4b20-b45a-e834c48b1491"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurvePoint", "[", 
    RowBox[{"Points_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Points", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", ">", "n"}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurvePoint", ",", "\"\<badsegment\>\"", ",", "n", ",", "k"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "<", 
        RowBox[{"-", "n"}]}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurvePoint", ",", "\"\<badsegment\>\"", ",", "n", ",", "k"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "0"}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurvePoint", ",", "\"\<badsegmentzero\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"k", ">", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "<", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51951551075*^9, 3.519515576375*^9}, 
   3.5195156611875*^9},ExpressionUUID->"9ec51478-8b7d-425b-9c4b-c6d4bff7273b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Wrapper for case where interpolation should be linear interpolation of points\
\
\>", "Subsection",
 CellChangeTimes->{
  3.5833516185259495`*^9},ExpressionUUID->"96c92f09-199d-4601-a29b-\
eea0d31de146"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "generate", " ", "interpolating", " ", "functions", " ", "and", " ", "pass",
    " ", "these", " ", "through", " ", "to", " ", "FigCurveAnchor", " ", 
   "functions", " ", 
   RowBox[{"(", 
    RowBox[{
    "or", " ", "pass", " ", "dummies", " ", "None", " ", "if", " ", 
     "interpolating", " ", "functions", " ", "not", " ", "needed"}], ")"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7098545017012367`*^9, 3.7098545554901314`*^9}, {
  3.709854612289831*^9, 
  3.709854613678233*^9}},ExpressionUUID->"23b9e74b-ddf1-4eef-871d-\
1c48425513c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchorFromPoints", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"Name", ":", 
      RowBox[{
      "Left", "|", "Center", "|", "Right", "|", "Head", "|", "Tail"}]}], ",", 
     "Arg_"}], "]"}], ":=", 
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points", ",", 
     RowBox[{"LinearInterpolationFunctionPair", "[", "Points", "]"}], ",", 
     "Name", ",", "Arg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchorFromPoints", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"Name", ":", "Point"}], ",", "Arg_"}], "]"}], ":=", 
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points", ",", 
     RowBox[{"{", 
      RowBox[{"None", ",", "None"}], "}"}], ",", "Name", ",", "Arg"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516291345609375*^9, 3.516291394421875*^9}, {
   3.519651488390625*^9, 3.519651500046875*^9}, {3.520542242359375*^9, 
   3.520542245453125*^9}, 3.52054276134375*^9, {3.7098544582863607`*^9, 
   3.7098544968808284`*^9}, {3.709854606517821*^9, 
   3.709854608904625*^9}},ExpressionUUID->"890216dd-f9af-4de6-bfaa-\
6fed8d3ba3b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchor -- on a segment", "Subsection",
 CellChangeTimes->{{3.5833509859585695`*^9, 
  3.5833509965665884`*^9}},ExpressionUUID->"4b1b2b1b-ebe3-42e2-b30e-\
b3bc3d731510"],

Cell["\<\
wraps recursive call to FigCurveAnchor zooming on given segment

Argument: {s,...} -- within segment s\
\>", "Text",
 CellChangeTimes->{{3.583351000107795*^9, 3.5833510130558176`*^9}, {
  3.5833511783069077`*^9, 
  3.5833511814425135`*^9}},ExpressionUUID->"5348deef-b22c-4fef-851c-\
ec6130345979"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Name_", ",", 
     RowBox[{"{", 
      RowBox[{"s_Integer", ",", "Arg_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"FigCurveAnchorFromPoints", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CurveSegment", "[", 
      RowBox[{"Points", ",", "s"}], "]"}], ",", "\[IndentingNewLine]", "Name",
      ",", "\[IndentingNewLine]", "Arg"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5833510296854467`*^9, 3.583351127372818*^9}, {
   3.5833511866529226`*^9, 3.5833512856654835`*^9}, {3.5833516349259725`*^9, 
   3.5833516758560295`*^9}, 
   3.709854426836705*^9},ExpressionUUID->"135bd993-7478-45ec-8385-\
cad0185c97c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchors relative to full curve -- Left/Center/Right", "Subsection",
 CellChangeTimes->{{3.5833507512405577`*^9, 3.5833507735017967`*^9}, {
  3.5833508423759174`*^9, 3.5833508476487265`*^9}, {3.5833513293755445`*^9, 
  3.583351331005547*^9}, {3.583351391005631*^9, 
  3.583351403445648*^9}},ExpressionUUID->"5b633170-b2a3-46c1-b405-\
220908dd3675"],

Cell["Argument: None -- resolves to scaled arc length 0.5", "Text",
 CellChangeTimes->{{3.583351359635587*^9, 3.5833513791356144`*^9}, {
  3.5833514463657084`*^9, 
  3.5833514477557106`*^9}},ExpressionUUID->"acaac66f-022d-4746-ba1e-\
083f7f0764b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", "None"}], 
    "]"}], ":=", 
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{
    "Points", ",", "InterpolationFunctionPair", ",", "Name", ",", "0.5"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519651668*^9, 3.519651695421875*^9}, {3.5205421875*^9, 
  3.5205422019375*^9}, {3.520542682296875*^9, 3.52054269153125*^9}, {
  3.520542754921875*^9, 3.520542755796875*^9}, {3.7098543829382277`*^9, 
  3.7098543885074377`*^9}},ExpressionUUID->"f9ba3b2f-150d-4d80-b9aa-\
e53d1c90babc"],

Cell["Argument: u -- scaled arc length", "Text",
 CellChangeTimes->{{3.583350856259942*^9, 3.5833508748863745`*^9}, {
   3.583350912622841*^9, 3.583350957004919*^9}, {3.5833511762633038`*^9, 
   3.5833511765285044`*^9}, 
   3.583351449765713*^9},ExpressionUUID->"29037edf-6991-4561-bfa2-\
553370660b92"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"u", ":", 
      RowBox[{"(", 
       RowBox[{"_", "?", "NumericQ"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Canvas", "[", 
        RowBox[{"InterpolationFunction", "[", "u", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"Name", ",", "Right", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"+", "1"}]}], "}"}], ",", "Center", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "Left", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"TangentFunction", "[", "u", "]"}], "]"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"InterpolatingFunction", "::", "dmval"}], "}"}]}], "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "allow", " ", "anchors", " ", "past", " ", "end", " ", "of", " ", 
      "line"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516288605859375*^9, 3.516288606140625*^9}, 
   3.5162887196875*^9, {3.5162888203125*^9, 3.516288864875*^9}, {
   3.516288997890625*^9, 3.51628899990625*^9}, {3.51629023153125*^9, 
   3.51629023346875*^9}, {3.516290271109375*^9, 3.516290273875*^9}, {
   3.5162903079375*^9, 3.516290309765625*^9}, 3.516290356953125*^9, 
   3.51801893303125*^9, 3.5194957400625*^9, {3.519651547234375*^9, 
   3.519651610390625*^9}, 3.519651659203125*^9, {3.519728616296875*^9, 
   3.51972864125*^9}, 3.5197287649375*^9, {3.5205421776875*^9, 
   3.520542206140625*^9}, 3.52054275425*^9, {3.6347579621728563`*^9, 
   3.63475797547968*^9}, {3.7098543968222523`*^9, 
   3.7098543978986545`*^9}},ExpressionUUID->"ab9b8320-6a64-4b5f-81e7-\
640d306d0bf5"],

Cell["\<\
Arg: {DisplaceAlongHead|DisplaceAlongTail,d} -- tangent displacement from \
tail/head\
\>", "Text",
 CellChangeTimes->{{3.522196309140625*^9, 3.5221963134375*^9}, {
  3.5833477625915565`*^9, 3.5833477711966887`*^9}, {3.5833488139100037`*^9, 
  3.583348827702716*^9}, {3.5833517009260645`*^9, 3.5833517444261255`*^9}, {
  3.58335185457628*^9, 3.5833518620162907`*^9}, {3.583351920496372*^9, 
  3.583351920826373*^9}, {3.625454537216856*^9, 
  3.625454537652881*^9}},ExpressionUUID->"9b0c022f-477e-455e-8031-\
68ee42e4bbae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"DisplaceAlongTail", ",", 
       RowBox[{"d_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"DisplaceAlongAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "0"}], 
      "]"}], ",", "\[IndentingNewLine]", "d"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"DisplaceAlongHead", ",", 
       RowBox[{"d_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"DisplaceAlongAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "1"}], 
      "]"}], ",", "\[IndentingNewLine]", "d"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52219633125*^9, 3.522196341078125*^9}, {
  3.522196396234375*^9, 3.522196469515625*^9}, {3.522196565890625*^9, 
  3.52219656940625*^9}, {3.583347774771744*^9, 3.58334778885196*^9}, {
  3.625166606976144*^9, 3.625166610064949*^9}, {3.625454538728943*^9, 
  3.625454539519988*^9}, {3.709854398429055*^9, 
  3.709854398928256*^9}},ExpressionUUID->"925b6722-ad41-4dd1-95ca-\
b7800382c7ab"],

Cell["\<\
Arg: {Horizontal|Vertical,x} -- at given horizontal/vertical coordinate (with \
x in general syntax for individual coordinate)

Arg: {Horizontal|Vertical,x,{u0,u1},iRoot} -- at given horizontal/vertical \
coordinate (with x in general syntax for individual coordinate), seeking root \
using starting guesses {u0,u1} (default {0,1}) for the curve parameter (see \
help for FindRoot) and taking root indexed by iRoot (default -1, i.e., last \
root)\
\>", "Text",
 CellChangeTimes->{{3.522196309140625*^9, 3.5221963134375*^9}, {
  3.5833477625915565`*^9, 3.5833477711966887`*^9}, {3.5833488139100037`*^9, 
  3.583348827702716*^9}, {3.5833517009260645`*^9, 3.5833517444261255`*^9}, {
  3.58335185457628*^9, 3.5833518620162907`*^9}, {3.583351941816402*^9, 
  3.5833519766564507`*^9}, {3.7111400106047535`*^9, 3.7111400845176835`*^9}, {
  3.7111407232920055`*^9, 
  3.7111407529476576`*^9}},ExpressionUUID->"38537657-6d59-43c0-89bf-\
194b32deedd6"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FigCurveAnchor", "[", 
     RowBox[{"Points_List", ",", 
      RowBox[{"InterpolationFunctionPair", ":", 
       RowBox[{"{", 
        RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
      ",", 
      RowBox[{"Name", ":", 
       RowBox[{"(", 
        RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CoordinateIndexName", ":", 
         RowBox[{"(", 
          RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
        RowBox[{"x", ":", "FigCoordinatePattern"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fRc", ",", "xc", ",", "uRule", ",", "u", ",", "CoordinateIndex", ",", 
        "CanvasPoint"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fRc", "=", 
        RowBox[{"LinearInterpolationFunctionsRxRy", "[", "Points", "]"}]}], 
       ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{"AD", " ", 
         RowBox[{"HOC", " ", "--"}], " ", "perhaps", " ", "to", " ", "be", 
         " ", "revised", " ", "if", " ", "these", " ", "become", " ", "the", 
         " ", "stored", " ", "interpolation", " ", "functions"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"CoordinateIndex", "=", 
        RowBox[{
        "FigResolveCoordinateIndex", "[", "CoordinateIndexName", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"xc", "=", 
        RowBox[{"FigResolveCoordinate", "[", 
         RowBox[{"x", ",", "CoordinateIndex"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"recover", " ", "curve", " ", "parameter"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"uRule", "=", "\[IndentingNewLine]", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"fRc", "[", 
                RowBox[{"[", "CoordinateIndex", "]"}], "]"}], "[", "u", "]"}],
               "-", "xc"}], ",", 
             RowBox[{"{", 
              RowBox[{"u", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"u", "=", 
           RowBox[{"Last", "@", 
            RowBox[{"Last", "@", "uRule"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"CanvasPoint", "=", 
           RowBox[{"InterpolationFunction", "[", "u", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{"Name", ",", "Right", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"+", "1"}]}], "}"}], ",", "Center", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "Left", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorArcTan", "[", 
             RowBox[{"TangentFunction", "[", "u", "]"}], "]"}]}], " ", 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"InterpolatingFunction", "::", "dmval"}], "}"}]}], "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "allow", " ", "anchors", " ", "past", " ", "end", " ", "of", " ", 
          "line"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52219633125*^9, 3.522196341078125*^9}, {
   3.522196396234375*^9, 3.522196469515625*^9}, {3.522196565890625*^9, 
   3.52219656940625*^9}, {3.583347774771744*^9, 3.58334778885196*^9}, {
   3.5833520134765024`*^9, 3.583352026736521*^9}, {3.5833520943366156`*^9, 
   3.5833521264766607`*^9}, {3.58335591533827*^9, 3.58335592922829*^9}, {
   3.583355961678335*^9, 3.583355987418371*^9}, {3.5835089821272354`*^9, 
   3.58350899404392*^9}, {3.5913934729327726`*^9, 3.591393668213916*^9}, {
   3.5913937186956043`*^9, 3.5913938085361624`*^9}, {3.5913938508278365`*^9, 
   3.591393876193481*^9}, {3.591394001368101*^9, 3.5913940030061035`*^9}, {
   3.5913940370297637`*^9, 3.591394118071906*^9}, {3.5913942191600833`*^9, 
   3.591394249564537*^9}, {3.5913942930886135`*^9, 3.5913943096246424`*^9}, {
   3.634757018542799*^9, 3.634757032146023*^9}, {3.6347571925455046`*^9, 
   3.634757295677286*^9}, 3.634757853144265*^9, {3.634757939038016*^9, 
   3.6347579427820225`*^9}, 3.634758044993402*^9, {3.7098543995678573`*^9, 
   3.70985440104986*^9}, {3.711139916302588*^9, 
   3.7111399211229963`*^9}},ExpressionUUID->"0e713f4a-831d-4872-849a-\
9fca1fec2071"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FigCurveAnchor", "[", 
     RowBox[{"Points_List", ",", 
      RowBox[{"InterpolationFunctionPair", ":", 
       RowBox[{"{", 
        RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
      ",", 
      RowBox[{"Name", ":", 
       RowBox[{"(", 
        RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CoordinateIndexName", ":", 
         RowBox[{"(", 
          RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
        RowBox[{"x", ":", "FigCoordinatePattern"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{"FigCurveAnchor", "[", 
     RowBox[{"Points", ",", "InterpolationFunctionPair", ",", "Name", ",", 
      RowBox[{"{", 
       RowBox[{"CoordinateIndexName", ",", "x", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52219633125*^9, 3.522196341078125*^9}, {
   3.522196396234375*^9, 3.522196469515625*^9}, {3.522196565890625*^9, 
   3.52219656940625*^9}, {3.583347774771744*^9, 3.58334778885196*^9}, {
   3.5833520134765024`*^9, 3.583352026736521*^9}, {3.5833520943366156`*^9, 
   3.5833521264766607`*^9}, {3.58335591533827*^9, 3.58335592922829*^9}, {
   3.583355961678335*^9, 3.583355987418371*^9}, {3.5835089821272354`*^9, 
   3.58350899404392*^9}, {3.5913934729327726`*^9, 3.591393668213916*^9}, {
   3.5913937186956043`*^9, 3.5913938085361624`*^9}, {3.5913938508278365`*^9, 
   3.591393876193481*^9}, {3.591394001368101*^9, 3.5913940030061035`*^9}, {
   3.5913940370297637`*^9, 3.591394118071906*^9}, {3.5913942191600833`*^9, 
   3.591394249564537*^9}, {3.5913942930886135`*^9, 3.5913943096246424`*^9}, {
   3.634757018542799*^9, 3.634757032146023*^9}, {3.6347571925455046`*^9, 
   3.634757295677286*^9}, 3.634757853144265*^9, {3.634757939038016*^9, 
   3.6347579427820225`*^9}, 3.634758044993402*^9, {3.7098543995678573`*^9, 
   3.70985440104986*^9}, {3.7111399343986197`*^9, 3.7111399505914483`*^9}, {
   3.711139984583908*^9, 3.7111399951451263`*^9}, {3.7111400918028965`*^9, 
   3.711140095016502*^9}},ExpressionUUID->"1579c434-6461-4294-9358-\
a7c2d64e6ec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CoordinateIndexName", ":", 
        RowBox[{"(", 
         RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
       RowBox[{"x", ":", "FigCoordinatePattern"}], ",", 
       RowBox[{"RootFindingParameters", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", 
       RowBox[{"iRoot", ":", 
        RowBox[{"(", "_Integer", ")"}], ":", 
        RowBox[{"-", "1"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fRc", ",", "xc", ",", "uRule", ",", "u", ",", "u0", ",", "u1", ",", 
       "CoordinateIndex", ",", "CanvasPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fRc", "=", 
       RowBox[{"LinearInterpolationFunctionsRxRy", "[", "Points", "]"}]}], 
      ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"AD", " ", 
        RowBox[{"HOC", " ", "--"}], " ", "perhaps", " ", "to", " ", "be", " ",
         "revised", " ", "if", " ", "these", " ", "become", " ", "the", " ", 
        "stored", " ", "interpolation", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CoordinateIndex", "=", 
       RowBox[{
       "FigResolveCoordinateIndex", "[", "CoordinateIndexName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xc", "=", 
       RowBox[{"FigResolveCoordinate", "[", 
        RowBox[{"x", ",", "CoordinateIndex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"recover", " ", "curve", " ", "parameter"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u0", ",", "u1"}], "}"}], "=", "RootFindingParameters"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"uRule", "=", "\[IndentingNewLine]", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"fRc", "[", 
               RowBox[{"[", "CoordinateIndex", "]"}], "]"}], "[", "u", "]"}], 
             "-", "xc"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "u0", ",", "u1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u", "=", 
          RowBox[{"Last", "[", 
           RowBox[{"uRule", "[", 
            RowBox[{"[", "iRoot", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"CanvasPoint", "=", 
          RowBox[{"InterpolationFunction", "[", "u", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{"Name", ",", "Right", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"+", "1"}]}], "}"}], ",", "Center", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "Left", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VectorArcTan", "[", 
            RowBox[{"TangentFunction", "[", "u", "]"}], "]"}]}], " ", 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"InterpolatingFunction", "::", "dmval"}], "}"}]}], "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "allow", " ", "anchors", " ", "past", " ", "end", " ", "of", " ", 
         "line"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52219633125*^9, 3.522196341078125*^9}, {
   3.522196396234375*^9, 3.522196469515625*^9}, {3.522196565890625*^9, 
   3.52219656940625*^9}, {3.583347774771744*^9, 3.58334778885196*^9}, {
   3.5833520134765024`*^9, 3.583352026736521*^9}, {3.5833520943366156`*^9, 
   3.5833521264766607`*^9}, {3.58335591533827*^9, 3.58335592922829*^9}, {
   3.583355961678335*^9, 3.583355987418371*^9}, {3.5835089821272354`*^9, 
   3.58350899404392*^9}, {3.5913934729327726`*^9, 3.591393668213916*^9}, {
   3.5913937186956043`*^9, 3.5913938085361624`*^9}, {3.5913938508278365`*^9, 
   3.591393876193481*^9}, {3.591394001368101*^9, 3.5913940030061035`*^9}, {
   3.5913940370297637`*^9, 3.591394118071906*^9}, {3.5913942191600833`*^9, 
   3.591394249564537*^9}, {3.5913942930886135`*^9, 3.5913943096246424`*^9}, {
   3.634757018542799*^9, 3.634757032146023*^9}, {3.6347571925455046`*^9, 
   3.634757295677286*^9}, 3.634757853144265*^9, {3.634757939038016*^9, 
   3.6347579427820225`*^9}, 3.634758044993402*^9, {3.7098543995678573`*^9, 
   3.70985440104986*^9}, {3.7111398367892485`*^9, 3.711139905398169*^9}, {
   3.711139971245885*^9, 3.7111399751770916`*^9}, {3.7111401031753163`*^9, 
   3.711140124172953*^9}, {3.711140341387735*^9, 3.7111403786406*^9}, {
   3.7111404096222544`*^9, 3.711140411806258*^9}, {3.71114044670352*^9, 
   3.711140468886759*^9}, {3.711140590348572*^9, 3.711140610566208*^9}, {
   3.7111406611258965`*^9, 
   3.711140709985182*^9}},ExpressionUUID->"8c001baf-c0a9-48aa-9591-\
03fc7e710f0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchors at ends of curve -- Tail/Head", "Subsection",
 CellChangeTimes->{{3.5833507512405577`*^9, 3.5833507735017967`*^9}, {
  3.5833508423759174`*^9, 3.5833508476487265`*^9}, {3.5833513293755445`*^9, 
  3.583351331005547*^9}, {3.583351391005631*^9, 3.583351403445648*^9}, {
  3.5833514363856945`*^9, 
  3.5833514429457035`*^9}},ExpressionUUID->"ba3f1f8f-f208-4fd9-8446-\
909f492b9281"],

Cell["Argument: None", "Text",
 CellChangeTimes->{{3.5162890259375*^9, 3.5162890281875*^9}, {
  3.583351454075719*^9, 
  3.583351455265721*^9}},ExpressionUUID->"c9991a1b-f1e2-4a86-81e6-\
0c3f292c94b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Tail", ",", "None"}], "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "0"}], 
      "]"}], ",", "Right"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Head", ",", "None"}], "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "1"}], 
      "]"}], ",", "Left"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51517464803125*^9, 3.515174666234375*^9}, {
  3.5151749220625*^9, 3.515174944015625*^9}, {3.51525866915625*^9, 
  3.515258669703125*^9}, {3.51544000385975*^9, 3.5154400110785*^9}, {
  3.515448814344125*^9, 3.515448817391*^9}, {3.515885061484375*^9, 
  3.515885123609375*^9}, {3.515885158765625*^9, 3.515885177*^9}, {
  3.51588520975*^9, 3.515885211890625*^9}, {3.515885305546875*^9, 
  3.515885334171875*^9}, {3.5159692698125*^9, 3.515969316375*^9}, {
  3.5162888859375*^9, 3.516288899609375*^9}, {3.51628900478125*^9, 
  3.516289008140625*^9}, {3.51628907375*^9, 3.516289104984375*^9}, {
  3.518105316125*^9, 3.518105318203125*^9}, {3.51949590825*^9, 
  3.51949591465625*^9}, {3.519648480609375*^9, 3.5196484845625*^9}, {
  3.520542224234375*^9, 3.520542228875*^9}, {3.52054273165625*^9, 
  3.520542759203125*^9}},ExpressionUUID->"55941cf2-a011-4d99-b5e7-\
0273d2060e24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchor at enumerated point -- Point", "Subsection",
 CellChangeTimes->{{3.5833507512405577`*^9, 3.5833507735017967`*^9}, {
  3.5833508423759174`*^9, 3.5833508476487265`*^9}, {3.5833513293755445`*^9, 
  3.583351331005547*^9}, {3.583351391005631*^9, 3.583351403445648*^9}, {
  3.5833514363856945`*^9, 3.5833514429457035`*^9}, {3.583351498095781*^9, 
  3.583351526495821*^9}},ExpressionUUID->"6dbaaaba-c0e7-438e-b78f-\
6a8e6c9dffaf"],

Cell["Argument: None", "Text",
 CellChangeTimes->{{3.516289165328125*^9, 3.51628916840625*^9}, 
   3.516289318390625*^9, {3.5833515305258265`*^9, 
   3.58335153331583*^9}},ExpressionUUID->"41ad5978-0c0d-4de9-ab6a-\
3bd855d8a724"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Point", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"CurvePoint", "[", 
      RowBox[{"Points", ",", "k"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51628918009375*^9, 3.516289224453125*^9}, {
   3.51628926325*^9, 3.516289308546875*^9}, 3.5180189345625*^9, {
   3.5195154745625*^9, 3.5195154914375*^9}, {3.519515589265625*^9, 
   3.51951559771875*^9}, {3.51951568890625*^9, 3.519515698796875*^9}, {
   3.519515875859375*^9, 3.519515890453125*^9}, {3.519591909765625*^9, 
   3.519591910703125*^9}, 3.520542236609375*^9, 3.52054276034375*^9, {
   3.7098536780197897`*^9, 3.709853679798193*^9}, {3.709853748578714*^9, 
   3.7098537540075235`*^9}, {3.7098545945838003`*^9, 3.709854595098601*^9}, 
   3.7098546507438984`*^9},ExpressionUUID->"5800b731-bf5a-479c-a63b-\
fe6db1ee48e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bounding box (extremal values)", "Subsection",
 CellChangeTimes->{{3.515166499828125*^9, 
  3.515166506484375*^9}},ExpressionUUID->"887fa97e-feb8-4398-8917-\
22514c97723d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FigCurveBoundingBox", "[", 
     RowBox[{"CanvasCurve", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "..."}], "}"}]}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "CanvasCurve", "]"}], "<", "1"}], ")"}]}], ":=", 
   "None"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FigCurveBoundingBox", "[", 
     RowBox[{"CanvasCurve", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "..."}], "}"}]}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "CanvasCurve", "]"}], "\[GreaterEqual]", "1"}], 
     ")"}]}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"First", "/@", "CanvasCurve"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"First", "/@", "CanvasCurve"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"Last", "/@", "CanvasCurve"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Last", "/@", "CanvasCurve"}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516616575*^9, 3.51516620196875*^9}, {
   3.515166363734375*^9, 3.51516642103125*^9}, {3.5151665123125*^9, 
   3.51516652478125*^9}, 3.515167326484375*^9, {3.515167359171875*^9, 
   3.515167378671875*^9}, {3.515167540625*^9, 3.515167556453125*^9}, {
   3.515450416844125*^9, 3.515450418844125*^9}, {3.515683051140625*^9, 
   3.51568305628125*^9}},ExpressionUUID->"96054c7c-ebc5-482a-9a32-\
e396f805510c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard arrowhead options", "Subsection",
 CellChangeTimes->{{3.51568126209375*^9, 3.515681269890625*^9}, {
  3.5160463231145*^9, 
  3.516046323411375*^9}},ExpressionUUID->"fa0b5d91-2205-46eb-8b6a-\
567a5cebcda6"],

Cell["\<\
End-tagged versions are for bracket, with default equal head and tail \
parameters EndLength and EndLip\
\>", "Text",
 CellChangeTimes->{{3.5670374626436653`*^9, 3.567037476106489*^9}, {
  3.5670940329812355`*^9, 
  3.5670940443692555`*^9}},ExpressionUUID->"f36740db-66a6-480c-9edb-\
97467757f3c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigArrowheadOptions", "[", 
    RowBox[{
     RowBox[{"st", ":", "LogicalPattern"}], ",", 
     RowBox[{"sh", ":", "LogicalPattern"}], ",", 
     RowBox[{"len_", ":", "6"}], ",", 
     RowBox[{"lip_", ":", "3"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TailLength", "\[Rule]", "len"}], ",", 
     RowBox[{"TailLip", "\[Rule]", "lip"}], ",", 
     RowBox[{"ShowTail", "\[Rule]", "st"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HeadLength", "\[Rule]", "len"}], ",", 
     RowBox[{"HeadLip", "\[Rule]", "lip"}], ",", 
     RowBox[{"ShowHead", "\[Rule]", "sh"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigArrowheadOptions", "[", 
    RowBox[{
     RowBox[{"show", ":", "LogicalPattern"}], ",", "len_", ",", "lip_", ",", 
     "End"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TailLength", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TailLip", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"ShowTail", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HeadLength", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"HeadLip", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"ShowHead", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"EndLength", "\[Rule]", "len"}], ",", 
     RowBox[{"EndLip", "\[Rule]", "lip"}], ",", 
     RowBox[{"ShowEnd", "\[Rule]", "show"}]}], "\[IndentingNewLine]", "}"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515430903687875*^9, 3.515430989031625*^9}, {
   3.515431026844125*^9, 3.515431030625375*^9}, {3.515431105094125*^9, 
   3.5154311113285*^9}, 3.515609867390625*^9, {3.516046331536375*^9, 
   3.516046383911375*^9}, {3.516299224796875*^9, 3.516299225890625*^9}, {
   3.56703744241043*^9, 3.567037487322909*^9}, {3.567094048596863*^9, 
   3.567094080374119*^9}, {3.5670941662054696`*^9, 3.567094199573928*^9}, {
   3.567094579270195*^9, 
   3.5670945796913958`*^9}},ExpressionUUID->"b457ae4b-755f-485f-bd87-\
11ba88efe18a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckArrowheadOptions", "[", "Self_Object", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FigOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FigOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLip", ",", 
        RowBox[{"NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLip", ",", 
        RowBox[{"NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "ShowTail", ",", "LogicalPattern", ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "ShowHead", ",", "LogicalPattern", ",", "FigOptions"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515609878875*^9, 3.515609880859375*^9}, {
  3.515609969484375*^9, 3.51560997471875*^9}, {3.51561002109375*^9, 
  3.515610021390625*^9}, {3.515708373859375*^9, 3.515708374140625*^9}, {
  3.515708405015625*^9, 3.5157084079375*^9}, {3.567094109078169*^9, 
  3.567094113258977*^9}},ExpressionUUID->"7a724276-29d3-4483-bafe-\
d72073b4687e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckArrowheadOptions", "[", 
    RowBox[{"Self_Object", ",", "End"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "EndLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FigOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLength", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FigOptions"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLength", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FigOptions"}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "EndLip", ",", 
        RowBox[{"NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLip", ",", 
        RowBox[{"Automatic", "|", "NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLip", ",", 
        RowBox[{"Automatic", "|", "NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "ShowEnd", ",", "LogicalPattern", ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "ShowTail", ",", 
        RowBox[{"Automatic", "|", "LogicalPattern"}], ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "ShowHead", ",", 
        RowBox[{"Automatic", "|", "LogicalPattern"}], ",", "FigOptions"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515609878875*^9, 3.515609880859375*^9}, {
  3.515609969484375*^9, 3.51560997471875*^9}, {3.51561002109375*^9, 
  3.515610021390625*^9}, {3.515708373859375*^9, 3.515708374140625*^9}, {
  3.515708405015625*^9, 3.5157084079375*^9}, {3.567037274023734*^9, 
  3.567037355939478*^9}, {3.567037393348344*^9, 3.567037437200021*^9}, {
  3.56709408645813*^9, 3.5670941397946234`*^9}, {3.567094211305149*^9, 
  3.567094258011631*^9}},ExpressionUUID->"7977a511-b899-422e-8747-\
0a516b28dce1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arrowhead generation", "Subsection",
 CellChangeTimes->{{3.51543692048475*^9, 
  3.515436924094125*^9}},ExpressionUUID->"a2c9d2d3-88ce-4089-8f14-\
9219f1fc0c51"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"BasicArrowheadPoints", "::", "usage"}], "=", 
    "\"\<BasicArrowheadPoints[anchor,headlength,{headlipl,headlipr},sense] \
generates the points for an arrowhead with location and orientation given by \
anchor.\>\""}], ";"}], "*)"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"da5249fd-61ef-4813-8a89-490bb1181379"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicArrowheadPoints", "[", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"HeadLength_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"HeadLipL_", "?", "NumericQ"}], ",", 
       RowBox[{"HeadLipR_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Sense", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "|", "1"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P", ",", "theta"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "=", 
       RowBox[{"(", 
        RowBox[{"a", "@", 
         RowBox[{"GetPoint", "[", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"(", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "+", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"N", "@", "theta"}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"HeadLength", ",", "HeadLipL"}], "}"}], "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Sense"}], ",", 
             RowBox[{"+", "1"}]}], "}"}], "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"HeadLipL", ">", "0"}], ",", "1", ",", "0"}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", "P", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"P", "+", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"N", "@", "theta"}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"HeadLength", ",", "HeadLipR"}], "}"}], "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Sense"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"HeadLipR", ">", "0"}], ",", "1", ",", "0"}], "]"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515433515266*^9, 3.515433532406625*^9}, {
   3.51543358142225*^9, 3.51543369329725*^9}, {3.515436948812875*^9, 
   3.515436980016*^9}, {3.51543703835975*^9, 3.51543713579725*^9}, {
   3.515437198344125*^9, 3.515437203437875*^9}, {3.515437434594125*^9, 
   3.51543759873475*^9}, {3.515437720187875*^9, 3.515437721656625*^9}, {
   3.515437809937875*^9, 3.51543781460975*^9}, 3.51568263378125*^9, {
   3.515682783328125*^9, 3.515682784953125*^9}, {3.51951328603125*^9, 
   3.519513362078125*^9}},ExpressionUUID->"999a9aa2-bec6-4878-9ee3-\
1c176d4d9005"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveArrowheadPoints", "[", 
    RowBox[{
     RowBox[{"TailAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"HeadAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     "FullOptions_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ShowTail", "/.", "FullOptions"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BasicArrowheadPoints", "[", 
          RowBox[{"TailAnchor", ",", 
           RowBox[{"(", 
            RowBox[{"TailLength", "/.", "FullOptions"}], ")"}], ",", 
           RowBox[{"UpgradePair", "[", 
            RowBox[{"(", 
             RowBox[{"TailLip", "/.", "FullOptions"}], ")"}], "]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ShowHead", "/.", "FullOptions"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BasicArrowheadPoints", "[", 
          RowBox[{"HeadAnchor", ",", 
           RowBox[{"(", 
            RowBox[{"HeadLength", "/.", "FullOptions"}], ")"}], ",", 
           RowBox[{"UpgradePair", "[", 
            RowBox[{"(", 
             RowBox[{"HeadLip", "/.", "FullOptions"}], ")"}], "]"}], ",", 
           RowBox[{"+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51543307960975*^9, 3.5154332384535*^9}, {
  3.51543331317225*^9, 3.515433417641*^9}, {3.51543349635975*^9, 
  3.515433497281625*^9}, {3.515437939750375*^9, 3.515438047656625*^9}, {
  3.515438849906625*^9, 3.515438850625375*^9}, {3.51544736198475*^9, 
  3.515447362531625*^9}, {3.51544749329725*^9, 3.515447497312875*^9}, {
  3.515447902156625*^9, 3.5154479028285*^9}, {3.51553712946875*^9, 
  3.515537154546875*^9}, {3.51560043484375*^9, 3.515600446765625*^9}, {
  3.51560995946875*^9, 3.515609960328125*^9}, {3.515682415078125*^9, 
  3.515682442609375*^9}, {3.51568250925*^9, 3.515682521015625*^9}, {
  3.515682551234375*^9, 3.5156826011875*^9}, {3.51568278784375*^9, 
  3.5156827915*^9}, {3.515708374296875*^9, 3.51570837440625*^9}, {
  3.5670375679438505`*^9, 
  3.5670375855094814`*^9}},ExpressionUUID->"337e38a1-411f-4a6e-952d-\
35cd1aec7f32"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveArrowheadPoints", "[", 
    RowBox[{
     RowBox[{"TailAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"HeadAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"ReversedSide", ":", "LogicalPattern"}], ",", "FullOptions_List",
      ",", "End"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "UsedTailLength", ",", "UsedHeadLength", ",", "UsedTailLip", ",", 
       "UsedHeadLip", ",", "UsedShowTail", ",", "UsedShowHead"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"UsedShowTail", "=", 
         RowBox[{"ResolveOption", "[", 
          RowBox[{"ShowTail", ",", 
           RowBox[{"{", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"ShowEnd", "/.", "FullOptions"}], ")"}]}], "}"}], ",", 
           "FullOptions"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{"UsedShowTail", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UsedTailLength", "=", 
            RowBox[{"ResolveOption", "[", 
             RowBox[{"TailLength", ",", 
              RowBox[{"{", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"EndLength", "/.", "FullOptions"}], ")"}]}]}], 
               "}"}], ",", "FullOptions"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"UsedTailLip", "=", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"ReversedSide", ",", "Reverse", ",", "Identity"}], 
              "]"}], "@", 
             RowBox[{"UpgradePair", "[", 
              RowBox[{"ResolveOption", "[", 
               RowBox[{"TailLip", ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"EndLip", "/.", "FullOptions"}], ")"}]}], "}"}], 
                ",", "FullOptions"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"BasicArrowheadPoints", "[", 
            RowBox[{
            "TailAnchor", ",", "UsedTailLength", ",", "UsedTailLip", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UsedShowHead", "=", 
         RowBox[{"ResolveOption", "[", 
          RowBox[{"ShowHead", ",", 
           RowBox[{"{", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"ShowEnd", "/.", "FullOptions"}], ")"}]}], "}"}], ",", 
           "FullOptions"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{"UsedShowHead", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UsedHeadLength", "=", 
            RowBox[{"ResolveOption", "[", 
             RowBox[{"HeadLength", ",", 
              RowBox[{"{", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"EndLength", "/.", "FullOptions"}], ")"}]}]}], 
               "}"}], ",", "FullOptions"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"UsedHeadLip", "=", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"ReversedSide", ",", "Reverse", ",", "Identity"}], 
              "]"}], "@", 
             RowBox[{"UpgradePair", "[", 
              RowBox[{"ResolveOption", "[", 
               RowBox[{"HeadLip", ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"EndLip", "/.", "FullOptions"}], ")"}]}], "}"}], 
                ",", "FullOptions"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"BasicArrowheadPoints", "[", 
            RowBox[{
            "HeadAnchor", ",", "UsedHeadLength", ",", "UsedHeadLip", ",", 
             RowBox[{"+", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51543307960975*^9, 3.5154332384535*^9}, {
   3.51543331317225*^9, 3.515433417641*^9}, {3.51543349635975*^9, 
   3.515433497281625*^9}, {3.515437939750375*^9, 3.515438047656625*^9}, {
   3.515438849906625*^9, 3.515438850625375*^9}, {3.51544736198475*^9, 
   3.515447362531625*^9}, {3.51544749329725*^9, 3.515447497312875*^9}, {
   3.515447902156625*^9, 3.5154479028285*^9}, {3.51553712946875*^9, 
   3.515537154546875*^9}, {3.51560043484375*^9, 3.515600446765625*^9}, {
   3.51560995946875*^9, 3.515609960328125*^9}, {3.515682415078125*^9, 
   3.515682442609375*^9}, {3.51568250925*^9, 3.515682521015625*^9}, {
   3.515682551234375*^9, 3.5156826011875*^9}, {3.51568278784375*^9, 
   3.5156827915*^9}, {3.515708374296875*^9, 3.51570837440625*^9}, {
   3.5670375679438505`*^9, 3.5670375855094814`*^9}, {3.567037680591648*^9, 
   3.5670377900258403`*^9}, {3.5670937497783384`*^9, 3.567093837232092*^9}, {
   3.5670938814269695`*^9, 3.5670940214684153`*^9}, {3.567094276404063*^9, 
   3.567094349817792*^9}, {3.567094810509401*^9, 3.567094811585803*^9}, {
   3.5670948550318794`*^9, 3.56709486119389*^9}, 3.5670949372128234`*^9, {
   3.5670950192221675`*^9, 3.567095034385394*^9}, 
   3.5670951692788305`*^9},ExpressionUUID->"710d1db2-19a7-4d23-9a24-\
5bd24c129dcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve extraction from graphics", "Subsection",
 CellChangeTimes->{{3.51603981358325*^9, 
  3.516039817817625*^9}},ExpressionUUID->"6cd4da06-9712-437d-9abd-\
1850084c62be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "nocurve"}], "=", "\"\<No curves found.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "fewcurve"}], "=", 
   "\"\<Requested Line->`1` is greater than the number `2` of curves found.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "shortcurve"}], "=", 
   "\"\<Curve obtained `1` has fewer than two points and therefore may be \
unsuitable for use as an argument to functions or objects.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516040455755125*^9, 3.5160405058645*^9}, {
   3.516040619067625*^9, 3.516040684473875*^9}, {3.51604075527075*^9, 
   3.516040808692625*^9}, {3.51604095052075*^9, 3.516040967442625*^9}, 
   3.516041153973875*^9},ExpressionUUID->"a7191430-34bf-4ff3-8238-\
914902054d37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Point2D3DPattern", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GrabPoints", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Line", "\[Rule]", "1"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "[", 
    RowBox[{
     RowBox[{"G", ":", 
      RowBox[{"(", 
       RowBox[{"_Graphics", "|", "_Graphics3D"}], ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FullOptions", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Opts", ",", 
           RowBox[{"Options", "[", "GrabPoints", "]"}]}], "}"}], "]"}]}], ",",
        "LineSet", ",", "CurveSet", ",", "Curve"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"validate", " ", "options"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"GrabPoints", ",", "Line", ",", 
        RowBox[{"Join", "|", "All", "|", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", "_Integer", ")"}], "?", "Positive"}], ")"}]}], ",", 
        "FullOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"grab", " ", "all", " ", "curves"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "use", " ", "Normal", " ", "to", " ", "resolve", " ", 
        "GraphicsComplex", " ", "into", " ", "Line", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", ".", "g", "."}], ",", " ", 
          RowBox[{"in", " ", "output", " ", "of", " ", "ContourPlot"}]}], 
         ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LineSet", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "G", "]"}], ",", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"Point2D3DPattern", ".."}], "}"}], "]"}], "|", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Point2D3DPattern", ".."}], "}"}], ".."}], "}"}], 
           "]"}]}], ",", "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveSet", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"LineSet", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"c", ":", 
              RowBox[{"{", 
               RowBox[{"Point2D3DPattern", ".."}], "}"}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", "c", "}"}]}], ",", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"cc", ":", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Point2D3DPattern", ".."}], "}"}], ".."}], "}"}]}], 
             "]"}], "\[RuleDelayed]", "cc"}]}], "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveSet", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"CurveSet", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "CurveSet", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"FigMessage", "[", 
          RowBox[{"GrabPoints", ",", "\"\<nocurve\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"process", " ", "resulting", " ", "curve", " ", "set"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Line", "/.", "FullOptions"}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"case", ":", 
          RowBox[{"grab", " ", "specific", " ", "curve"}]}], "*)"}], 
        "\[IndentingNewLine]", "_Integer", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "CurveSet", "]"}], "<", 
            RowBox[{"(", 
             RowBox[{"Line", "/.", "FullOptions"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FigMessage", "[", 
             RowBox[{"GrabPoints", ",", "\"\<fewcurve\>\"", ",", 
              RowBox[{"(", 
               RowBox[{"Line", "/.", "FullOptions"}], ")"}], ",", 
              RowBox[{"Length", "[", "CurveSet", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Curve", "=", 
          RowBox[{"CurveSet", "[", 
           RowBox[{"[", 
            RowBox[{"(", 
             RowBox[{"Line", "/.", "FullOptions"}], ")"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Curve", "]"}], "<", "2"}], ",", 
           RowBox[{"FigMessage", "[", 
            RowBox[{"GrabPoints", ",", "\"\<shortcurve\>\"", ",", "Curve"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "Curve"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"case", ":", 
          RowBox[{"merge", " ", "all", " ", "curves"}]}], "*)"}], 
        "\[IndentingNewLine]", "Join", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Curve", "=", 
          RowBox[{"Join", "@@", "CurveSet"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Curve", "]"}], "<", "2"}], ",", 
           RowBox[{"FigMessage", "[", 
            RowBox[{"GrabPoints", ",", "\"\<shortcurve\>\"", ",", "Curve"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "Curve"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"case", ":", 
          RowBox[{"return", " ", "curve", " ", "list"}]}], "*)"}], 
        "\[IndentingNewLine]", "All", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "Curve", "]"}], "<", "2"}], ",", 
             RowBox[{"FigMessage", "[", 
              RowBox[{"GrabPoints", ",", "\"\<shortcurve\>\"", ",", "Curve"}],
               "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Curve", ",", "CurveSet"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "CurveSet"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "[", 
    RowBox[{
     RowBox[{"CG", ":", 
      RowBox[{"(", "_ContourGraphics", ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"GrabPoints", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", "CG", "]"}], ",", "Opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5182738013125*^9, 3.518273890390625*^9}, {
  3.538849909703125*^9, 3.538849945859375*^9}, {3.538862665125*^9, 
  3.53886271709375*^9}},ExpressionUUID->"9e3ea4af-e7c1-48a1-9b1f-\
d318020f98d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["List manipulation for curves", "Section",
 CellChangeTimes->{{3.56650866302003*^9, 
  3.5665086673568373`*^9}},ExpressionUUID->"41af34dd-f204-4731-8cba-\
bfedb2d9cd81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SplitByDelimiter", "[", 
    RowBox[{"l_List", ",", "d_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "SplitList", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SplitList", "=", 
       RowBox[{"Split", "[", 
        RowBox[{"l", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], ",", "d"}], "]"}]}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{"SplitList", ",", 
        RowBox[{"Except", "[", 
         RowBox[{"{", "d", "}"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PurgeOfDelimiter", "[", 
    RowBox[{"l_List", ",", "d_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"l", ",", 
       RowBox[{"Except", "[", "d", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5665084698292904`*^9, 3.5665086055027285`*^9}, {
  3.5665087929994583`*^9, 3.5665088313599253`*^9}, {3.566508929983299*^9, 
  3.5665089701533694`*^9}},ExpressionUUID->"0f0de0a5-c073-4fee-b2a9-\
8637a7d65e55"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SplitByDelimiter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "Split", ",", "4", ",", "Split", ",", "Split"}], 
    "}"}], ",", "Split"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PurgeOfDelimiter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "Split", ",", "4", ",", "Split", ",", "Split"}], 
    "}"}], ",", "Split"}], "]"}]}], "Input",
 CellChangeTimes->{{3.566508838598338*^9, 3.5665088580515723`*^9}, {
  3.5665099813471456`*^9, 
  3.566509984576351*^9}},ExpressionUUID->"775213dd-0b62-4d91-9194-\
6acb7f40e32a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5665088584571733`*^9, {3.5665089365197105`*^9, 3.566508973382575*^9}, 
   3.566509984841552*^9},ExpressionUUID->"e9c2e1ff-6fd0-481f-b1c0-\
cf49428d26f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5665088584571733`*^9, {3.5665089365197105`*^9, 3.566508973382575*^9}, 
   3.566509984841552*^9},ExpressionUUID->"43c9a27d-6bd6-4cf6-b22b-\
22a2f6b9a611"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppendFirst", "[", "l_List", "]"}], ":=", 
   RowBox[{"Append", "[", 
    RowBox[{"l", ",", 
     RowBox[{"First", "[", "l", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566509986058354*^9, 3.5665100052619877`*^9}, {
  3.566510035744441*^9, 
  3.5665100359160414`*^9}},ExpressionUUID->"3f2456ef-ecf1-43ff-bd6c-\
df7b5dfcec15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendFirst", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.5665100133428016`*^9, 
  3.5665100210648155`*^9}},ExpressionUUID->"cea61754-d874-40ae-8c7f-\
5edbe43d4afd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.5665100212832155`*^9, 
  3.566510037944045*^9}},ExpressionUUID->"b1ba9b71-ce63-42fd-b4ab-\
a687f30924b8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End package", "Section",
 CellChangeTimes->{{3.514823047703125*^9, 
  3.51482305353125*^9}},ExpressionUUID->"bc9488d0-f4f2-4362-b194-\
7782d02d070f"],

Cell[CellGroupData[{

Cell["Exit private context", "Subsection",
 CellChangeTimes->{{3.514823086015625*^9, 
  3.5148231094375*^9}},ExpressionUUID->"624a67f1-14b4-417d-9bb1-d24c34a59989"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"40950cd5-425c-4006-a27e-5764d045ff06"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exit package context", "Subsection",
 CellChangeTimes->{{3.514823092890625*^9, 
  3.51482312965625*^9}},ExpressionUUID->"8b096421-c5ed-4306-92cd-\
1b3e8062c7f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<$*\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"a1553bee-01e2-4cda-a256-14ad4c274d92"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->"EditBar",
WindowSize->{1434., 766.5},
WindowMargins->{{3, Automatic}, {Automatic, 18.75}},
WindowFrame->"Normal",
ShowSelection->True,
Magnification->1.2000000476837158`,
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9ebd9c75-a393-4316-bcf0-7bb648190cea"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 89, 0, 88, "Section",ExpressionUUID->"8b06d835-ca23-4649-b341-e2c6dd6b0072"],
Cell[671, 24, 3008, 70, 244, "Input",ExpressionUUID->"0432d776-9f62-4378-8f17-2251ee80b92c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3716, 99, 87, 0, 88, "Section",ExpressionUUID->"8500306f-5309-4fa4-a94f-0fe8ac50e766"],
Cell[CellGroupData[{
Cell[3828, 103, 103, 0, 47, "Subsection",ExpressionUUID->"27af69a8-3a7c-497b-a168-025c1127263e"],
Cell[3934, 105, 1527, 24, 55, "Input",ExpressionUUID->"7cbde085-3728-45cb-a91f-61d316bb3c61",
 InitializationCell->True],
Cell[5464, 131, 242, 6, 55, "Input",ExpressionUUID->"5aa1a9ed-2130-4fca-b068-e0b8330001c3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5743, 142, 98, 0, 47, "Subsection",ExpressionUUID->"323e4ee6-2179-4271-8255-28610275ce8b"],
Cell[5844, 144, 241, 5, 55, "Input",ExpressionUUID->"548ec37e-fa4d-4180-a5af-c293de7aea89",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6122, 154, 159, 3, 47, "Subsection",ExpressionUUID->"5b95c0e7-ead6-47bf-bc51-0696d6f56221"],
Cell[6284, 159, 221, 4, 55, "Input",ExpressionUUID->"3f25264f-770a-40d1-9895-c7aec37e37d6",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6554, 169, 313, 5, 88, "Section",ExpressionUUID->"c62091e9-a749-49c7-952a-cea1abb21a6c"],
Cell[CellGroupData[{
Cell[6892, 178, 172, 3, 47, "Subsection",ExpressionUUID->"4d8547ee-ea55-449f-861a-e7f035e734f0"],
Cell[7067, 183, 458, 13, 80, "Input",ExpressionUUID->"aaa64ffe-500c-4b03-871e-fb98780c5852",
 InitializationCell->True],
Cell[7528, 198, 412, 12, 80, "Input",ExpressionUUID->"46c235a7-4077-4d0c-9332-f406abd1a235",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[7977, 215, 165, 3, 47, "Subsection",ExpressionUUID->"4dd6a85d-a63f-46c6-bb81-33b5a5a3186e"],
Cell[8145, 220, 329, 7, 54, "Text",ExpressionUUID->"15f1d8bb-db70-4d83-b8b6-04430dfc7914"],
Cell[8477, 229, 837, 25, 55, "Input",ExpressionUUID->"69bcd6db-a049-4cb2-a744-d5168e5d64be",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9351, 259, 158, 3, 47, "Subsection",ExpressionUUID->"25f278a2-36e3-4099-95cf-15f7dd8909c8"],
Cell[9512, 264, 422, 13, 55, "Input",ExpressionUUID->"02d35cec-f403-4773-8521-7a2e838ee975",
 InitializationCell->True],
Cell[9937, 279, 818, 27, 55, "Input",ExpressionUUID->"5393dc3d-90a1-4a00-9d13-e785496d3a98",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10792, 311, 279, 4, 47, "Subsection",ExpressionUUID->"746b32b5-a1fa-4760-8976-91c9cad06d60"],
Cell[11074, 317, 347, 8, 54, "Text",ExpressionUUID->"ac09b5cf-ac8d-4503-b401-1ad60124409d"],
Cell[11424, 327, 1878, 54, 80, "Input",ExpressionUUID->"682543b7-081f-4599-b3de-1e01e2a8b72c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13351, 387, 154, 2, 88, "Section",ExpressionUUID->"597513ae-ec61-4327-8e7e-02237e64a943"],
Cell[CellGroupData[{
Cell[13530, 393, 104, 0, 47, "Subsection",ExpressionUUID->"4d020102-9393-4ff0-a19d-dc7d6b3f59be"],
Cell[13637, 395, 947, 29, 80, "Input",ExpressionUUID->"14e15596-68f2-4a55-b4bc-129550a535e1",
 InitializationCell->True],
Cell[14587, 426, 1884, 58, 103, "Input",ExpressionUUID->"409e9c99-41df-454f-b285-50c707ea9a6d",
 InitializationCell->True],
Cell[16474, 486, 463, 14, 55, "Input",ExpressionUUID->"8fc8b59e-cd59-423a-bacc-a6f1a74368ab",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16974, 505, 168, 3, 47, "Subsection",ExpressionUUID->"054c678b-7b17-4884-8cf3-bf84e65878b9"],
Cell[17145, 510, 153, 3, 33, "Text",ExpressionUUID->"1a330b16-d6b7-4097-b0ed-f52dbedec146"],
Cell[17301, 515, 1444, 39, 150, "Input",ExpressionUUID->"3ec1e1da-1dfb-43b1-b7ff-da5de00fcb4e",
 InitializationCell->True],
Cell[18748, 556, 695, 14, 136, "Text",ExpressionUUID->"e581c467-d76e-4d15-bef2-953e31886a95"],
Cell[19446, 572, 4564, 129, 455, "Input",ExpressionUUID->"3f88e183-8f29-40c2-a03b-60351d4f2402",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24059, 707, 157, 2, 88, "Section",ExpressionUUID->"3fb422f7-34e5-45a9-ba42-4adbebb3eea7"],
Cell[CellGroupData[{
Cell[24241, 713, 219, 4, 47, "Subsection",ExpressionUUID->"7f8f4404-fdb2-48b1-84db-a55c1e136641"],
Cell[24463, 719, 318, 8, 54, "Text",ExpressionUUID->"1328f93a-f502-4b85-b6c4-e8ac752d749f"],
Cell[24784, 729, 422, 11, 55, "Input",ExpressionUUID->"e72ae4bf-7ba2-42c5-b68e-6b2959c4f9e7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[25243, 745, 147, 3, 47, "Subsection",ExpressionUUID->"220d66c5-7fe0-4b41-b996-c79302ffa734"],
Cell[25393, 750, 248, 6, 33, "Text",ExpressionUUID->"e4c26aea-197f-42ba-a6d1-2326f3a27dce"],
Cell[25644, 758, 754, 21, 80, "Input",ExpressionUUID->"a5ef9613-ea83-4eb1-ac41-ec37787ed464",
 InitializationCell->True],
Cell[26401, 781, 247, 6, 33, "Text",ExpressionUUID->"dd27db5e-0cfb-455f-b0ec-efdaede14794"],
Cell[26651, 789, 873, 25, 80, "Input",ExpressionUUID->"ffc2a010-81f3-4e28-86e4-6a5832525bd2",
 InitializationCell->True],
Cell[27527, 816, 918, 26, 103, "Input",ExpressionUUID->"5e70be12-b702-46e7-9247-e0afdf0cbb16",
 InitializationCell->True],
Cell[28448, 844, 883, 25, 103, "Input",ExpressionUUID->"e7ff3dc5-adee-4814-8a7a-a847be3fb749",
 InitializationCell->True],
Cell[29334, 871, 923, 26, 103, "Input",ExpressionUUID->"b88d4355-ebd3-45e5-b608-c65bb4346b36",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30306, 903, 255, 4, 88, "Section",ExpressionUUID->"b3f396e4-d7b9-4d65-9b0a-0af3db7522fd"],
Cell[CellGroupData[{
Cell[30586, 911, 320, 5, 47, "Subsection",ExpressionUUID->"844cb412-d655-4434-92e1-43a73d497d73"],
Cell[30909, 918, 458, 8, 33, "Text",ExpressionUUID->"a191442b-e957-414c-92df-8bdae7c0fd8c"],
Cell[31370, 928, 1250, 37, 127, "Input",ExpressionUUID->"233df456-6195-488d-8ec1-0efd2a3963ca",
 InitializationCell->True],
Cell[32623, 967, 1056, 20, 55, "Input",ExpressionUUID->"7a012d56-331d-4d27-bd70-d6701b758e89",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[33716, 992, 209, 4, 47, "Subsection",ExpressionUUID->"ceff645e-1060-45e9-8085-806ec0cab9ea"],
Cell[33928, 998, 761, 14, 95, "Text",ExpressionUUID->"dd9b043f-fdfb-474a-b7c9-1b4a2ec35fe4"],
Cell[34692, 1014, 2284, 64, 150, "Input",ExpressionUUID->"3eabd834-23d8-4b22-b9e7-6d0516163c14",
 InitializationCell->True],
Cell[36979, 1080, 201, 3, 33, "Text",ExpressionUUID->"ed5c4429-6c9f-4663-b7ea-2c33698881fd"],
Cell[37183, 1085, 1724, 47, 244, "Input",ExpressionUUID->"0b3e10a2-8396-4dcd-a757-641173459304",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[38944, 1137, 289, 3, 47, "Subsection",ExpressionUUID->"bf32a4d5-aae9-4d01-9f6e-232ab7cd365f"],
Cell[39236, 1142, 873, 22, 55, "Input",ExpressionUUID->"c00fceff-65c7-4a8d-b170-417de8cc6e30",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40158, 1170, 213, 4, 88, "Section",ExpressionUUID->"cd14d738-076d-4103-8665-e8fe1fdcae0f"],
Cell[40374, 1176, 284, 6, 33, "Text",ExpressionUUID->"aa49749b-0f18-4d8b-b469-3fc3f4f55026"],
Cell[CellGroupData[{
Cell[40683, 1186, 190, 3, 47, "Subsection",ExpressionUUID->"4cd66662-0e4d-4577-91cf-97ff2b1f14d3"],
Cell[40876, 1191, 2650, 77, 174, "Input",ExpressionUUID->"c8ef580a-4b2e-45b6-97cf-9a84e5777166",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[43563, 1273, 213, 4, 47, "Subsection",ExpressionUUID->"8a29953a-ffd5-4da8-88a3-e64517e6f865"],
Cell[43779, 1279, 1961, 55, 127, "Input",ExpressionUUID->"0c8bcf3e-ac3e-4053-a0b8-ae4d45f9f61a",
 InitializationCell->True],
Cell[45743, 1336, 201, 3, 33, "Text",ExpressionUUID->"97cbea6d-2000-4a2d-ba40-9202dc994624"],
Cell[45947, 1341, 1852, 48, 244, "Input",ExpressionUUID->"b4f6d0f3-7b69-4f70-8677-7322c7ef6a03",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47848, 1395, 160, 3, 88, "Section",ExpressionUUID->"da8a7640-0e41-4723-8ce9-e10aef3b3298"],
Cell[48011, 1400, 244, 4, 33, "Text",ExpressionUUID->"d1c9531c-1440-42ff-9244-419e69b6a2e4"],
Cell[CellGroupData[{
Cell[48280, 1408, 165, 3, 47, "Subsection",ExpressionUUID->"4b9c6edd-eaee-4b18-8526-5f91992ada9a"],
Cell[48448, 1413, 317, 9, 33, "Text",ExpressionUUID->"16046e26-52f0-4e70-8a9f-44c64a416371"],
Cell[48768, 1424, 438, 11, 55, "Input",ExpressionUUID->"a91dc002-d55b-4ba5-8dca-db186b70ac26",
 InitializationCell->True],
Cell[49209, 1437, 1104, 33, 150, "Input",ExpressionUUID->"5d8cf0b6-b26e-4c9e-8aac-d6b2483ef9b9",
 InitializationCell->True],
Cell[50316, 1472, 994, 32, 127, "Input",ExpressionUUID->"ee4b2479-30a4-4e61-ad98-10de1f9c434c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51347, 1509, 162, 3, 47, "Subsection",ExpressionUUID->"8df153fa-5fc9-4a82-a833-4ecb68a37a1d"],
Cell[51512, 1514, 336, 8, 55, "Input",ExpressionUUID->"dbc8d15d-f406-4788-96e1-d2345ab63df1",
 InitializationCell->True],
Cell[51851, 1524, 627, 16, 80, "Input",ExpressionUUID->"d8a08419-811b-4c0a-a2cb-c0dd703c09a5",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52527, 1546, 303, 5, 88, "Section",ExpressionUUID->"4969ee0d-7f2f-4400-a1a7-a4e03e8d4820"],
Cell[CellGroupData[{
Cell[52855, 1555, 321, 5, 47, "Subsection",ExpressionUUID->"191a5e99-43ab-41bb-a550-aecc0d8470a7"],
Cell[53179, 1562, 2202, 63, 150, "Input",ExpressionUUID->"3c025dec-8170-4d34-9e70-73395dc0fb58",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[55418, 1630, 177, 3, 47, "Subsection",ExpressionUUID->"0466a1aa-1d99-446c-9184-ee66e26aae0f"],
Cell[55598, 1635, 579, 17, 198, "Text",ExpressionUUID->"72c68f54-3713-4dee-a446-a0d32ce77b71"],
Cell[56180, 1654, 2039, 60, 127, "Input",ExpressionUUID->"9159f2ea-3c30-4795-baf3-3cfa52d7e647",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[58256, 1719, 180, 2, 47, "Subsection",ExpressionUUID->"8517de0e-6569-4125-bd74-1cb15f9d7a22"],
Cell[58439, 1723, 553, 10, 54, "Text",ExpressionUUID->"424d210a-cdb1-462f-bd3d-e352562e9bec"],
Cell[58995, 1735, 3093, 92, 127, "Input",ExpressionUUID->"38ac8673-986e-4b41-b6ab-d8d80573febb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[62125, 1832, 205, 3, 47, "Subsection",ExpressionUUID->"7f3bace2-c98e-453e-9f72-e035a68faf24"],
Cell[62333, 1837, 273, 6, 33, "Text",ExpressionUUID->"4fa1e9fe-ffdb-4610-8ac9-a9c0487ee614"],
Cell[62609, 1845, 1176, 34, 80, "Input",ExpressionUUID->"42f91e3f-8743-4493-99eb-16a1d1a7f1ab",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[63822, 1884, 328, 5, 47, "Subsection",ExpressionUUID->"231182e7-b90a-4c25-ae3f-0b6ef7c04883"],
Cell[64153, 1891, 2956, 80, 127, "Input",ExpressionUUID->"85e37387-dd84-42ed-898c-d1b1a33a073f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[67146, 1976, 205, 3, 47, "Subsection",ExpressionUUID->"425d3d91-add6-4ff7-84ab-7fca8959119e"],
Cell[67354, 1981, 710, 13, 75, "Text",ExpressionUUID->"d462fb70-a53f-425d-8b08-3f50ebdb7d56"],
Cell[68067, 1996, 436, 8, 33, "Text",ExpressionUUID->"cd14afed-11c6-42f1-bca0-94459be6a40d"],
Cell[68506, 2006, 4239, 118, 221, "Input",ExpressionUUID->"c1571acb-c147-4aee-bb26-d0bdc9e0dfa3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[72782, 2129, 175, 3, 47, "Subsection",ExpressionUUID->"edbf93da-bd00-47b5-bc12-0319f5bd946b"],
Cell[72960, 2134, 326, 7, 54, "Text",ExpressionUUID->"14ab2b9f-d408-404d-8b58-83c7276965d7"],
Cell[73289, 2143, 748, 15, 55, "Input",ExpressionUUID->"39037e7f-6d5f-48e2-b431-497492ee088d",
 InitializationCell->True],
Cell[74040, 2160, 3452, 79, 596, "Input",ExpressionUUID->"1842d6e7-0205-449c-a592-f2a2103222b7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[77529, 2244, 160, 3, 47, "Subsection",ExpressionUUID->"dae6e2ce-9c90-4940-a8b5-e3509f1a7586"],
Cell[77692, 2249, 175, 3, 33, "Text",ExpressionUUID->"90e37eff-d7e8-410c-b192-ed244d306081"],
Cell[77870, 2254, 1739, 43, 314, "Input",ExpressionUUID->"1660b61f-bb6d-480e-89ca-cbb2daa3f384",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[79646, 2302, 170, 3, 47, "Subsection",ExpressionUUID->"d3db13c8-9fc5-4c98-a0d8-7b4a5d0414d6"],
Cell[79819, 2307, 1218, 36, 80, "Input",ExpressionUUID->"c195e96c-075b-45ad-bd1c-d236e968698c",
 InitializationCell->True],
Cell[81040, 2345, 2290, 59, 197, "Input",ExpressionUUID->"0343383c-c517-40d8-a256-87a2da2ba6b8",
 InitializationCell->True],
Cell[83333, 2406, 177, 3, 33, "Text",ExpressionUUID->"2e679560-f799-413a-9978-f1b1bc131487"],
Cell[83513, 2411, 2318, 51, 291, "Input",ExpressionUUID->"3c1a43ef-97b4-4e48-884c-50034a54a186",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85880, 2468, 274, 4, 88, "Section",ExpressionUUID->"5fc14890-069c-405f-afa0-f638f7f5479d"],
Cell[86157, 2474, 2373, 36, 404, "Text",ExpressionUUID->"53ffffb5-0818-445e-9cb4-aa15b8bf4f5c"],
Cell[88533, 2512, 423, 8, 75, "Text",ExpressionUUID->"97acfb9b-e7b2-4459-8965-77bcb23f9ee8"],
Cell[CellGroupData[{
Cell[88981, 2524, 164, 2, 47, "Subsection",ExpressionUUID->"d7b6ac20-dfbf-4350-b533-ea3833a632d7"],
Cell[89148, 2528, 417, 8, 54, "Text",ExpressionUUID->"8bf8a1ab-2247-404a-bf1e-09263d052af4"],
Cell[89568, 2538, 852, 23, 150, "Input",ExpressionUUID->"991715bf-ba9f-460c-8427-b3017936153d",
 InitializationCell->True],
Cell[90423, 2563, 1853, 49, 267, "Input",ExpressionUUID->"02474cad-029a-489a-a29b-93ef01389a2f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[92313, 2617, 225, 4, 47, "Subsection",ExpressionUUID->"a380a186-0162-406b-a519-91cca1467c6e"],
Cell[92541, 2623, 1458, 39, 221, "Input",ExpressionUUID->"3d8afee7-cab1-45e1-ac73-f94ee02fe18d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[94024, 2666, 597, 18, 36, "Input",ExpressionUUID->"b2d9a979-b36e-4fac-8a6f-530f686c5e88"],
Cell[94624, 2686, 327, 10, 36, "Output",ExpressionUUID->"37f65caf-037e-4cc5-8ed9-39b348fc603b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95012, 2703, 170, 3, 88, "Section",ExpressionUUID->"37225bb2-d265-4afe-b3d9-facf8beba937"],
Cell[CellGroupData[{
Cell[95207, 2710, 171, 3, 47, "Subsection",ExpressionUUID->"3ef2ced8-a5dc-4628-9bad-342d878058e9"],
Cell[95381, 2715, 578, 16, 55, "Input",ExpressionUUID->"bd8ceb63-716e-4be9-a5e0-1a7e8789849f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[95996, 2736, 177, 3, 47, "Subsection",ExpressionUUID->"01ea9b72-98dc-419e-b8ee-398ba4a4e3d2"],
Cell[96176, 2741, 390, 12, 80, "Input",ExpressionUUID->"f9aab622-8215-459e-b311-d68ccf5a5155",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[96603, 2758, 251, 4, 47, "Subsection",ExpressionUUID->"422130ac-c03e-4a59-a822-3da098ea415e"],
Cell[96857, 2764, 609, 15, 80, "Input",ExpressionUUID->"c4a922a3-ad46-42ef-8889-f8c03596e92c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[97503, 2784, 198, 2, 47, "Subsection",ExpressionUUID->"93583acd-124e-4427-99ff-4d51c443bb24"],
Cell[97704, 2788, 453, 8, 54, "Text",ExpressionUUID->"075a172e-2790-49d0-bee3-96236b6b031a"],
Cell[98160, 2798, 153, 3, 33, "Text",ExpressionUUID->"ec4f886c-041c-47aa-a0c3-2de6c93cdc1d"],
Cell[98316, 2803, 2033, 58, 127, "Input",ExpressionUUID->"ae24056b-9377-48b9-9b6a-b614ad996ad0",
 InitializationCell->True],
Cell[100352, 2863, 183, 3, 33, "Text",ExpressionUUID->"ca48d755-cb8e-4e07-b916-bf9723a86ea6"],
Cell[100538, 2868, 739, 18, 80, "Input",ExpressionUUID->"d2e6cdff-d228-4056-ad7f-0c0383659f06",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[101314, 2891, 198, 2, 47, "Subsection",ExpressionUUID->"19367298-6d27-4738-9eb3-3546ff854236"],
Cell[101515, 2895, 153, 3, 33, "Text",ExpressionUUID->"587e0f7f-82e0-47aa-bdf3-a82102082fd1"],
Cell[101671, 2900, 2152, 58, 150, "Input",ExpressionUUID->"6ee15a68-bea9-4b45-8338-679c9cb3af4f",
 InitializationCell->True],
Cell[103826, 2960, 183, 3, 33, "Text",ExpressionUUID->"a5caf2a9-74ef-4d1a-ab06-6630d19666f3"],
Cell[104012, 2965, 839, 19, 80, "Input",ExpressionUUID->"7e25327e-0833-4870-a3fa-ee11ba519b8f",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104900, 2990, 163, 3, 88, "Section",ExpressionUUID->"55ca212a-8061-4119-a86b-8487a7ec2f65"],
Cell[CellGroupData[{
Cell[105088, 2997, 212, 4, 47, "Subsection",ExpressionUUID->"673c594a-37af-42c9-b867-8aa006d0f39d"],
Cell[105303, 3003, 1029, 21, 55, "Input",ExpressionUUID->"acde4043-b29b-4a43-9fb8-3f476e160137",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[106369, 3029, 168, 3, 47, "Subsection",ExpressionUUID->"9647cacc-7d36-4c65-8fdd-1ae26076d57c"],
Cell[106540, 3034, 353, 7, 33, "Text",ExpressionUUID->"97ad8d2c-bc00-4058-a968-1950d1929bdc"],
Cell[106896, 3043, 597, 15, 55, "Input",ExpressionUUID->"d1b6a2af-7aad-4091-ae5e-79f20098b7c5",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[107530, 3063, 308, 5, 47, "Subsection",ExpressionUUID->"7412832a-e299-41c2-9535-804d3c7effb6"],
Cell[107841, 3070, 1111, 28, 80, "Input",ExpressionUUID->"fc679e6f-db08-4de4-938c-b89291c1cdac",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109001, 3104, 362, 6, 88, "Section",ExpressionUUID->"9029cb78-6555-4809-a05b-038ca30af5d7"],
Cell[CellGroupData[{
Cell[109388, 3114, 161, 3, 47, "Subsection",ExpressionUUID->"1ac65988-63d7-4d9e-948b-e5bad3c9f92b"],
Cell[109552, 3119, 1477, 38, 127, "Input",ExpressionUUID->"1b2cde44-c8a7-439f-aff7-38b1a461dcde",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[111066, 3162, 169, 3, 47, "Subsection",ExpressionUUID->"9c781b72-03b3-499b-a727-d00c406a7dd3"],
Cell[111238, 3167, 401, 8, 54, "Text",ExpressionUUID->"63a16512-0218-4cef-a7d7-089e33397da0"],
Cell[111642, 3177, 175, 3, 33, "Text",ExpressionUUID->"c3c95ba5-bfe7-4819-836e-0d8db1599c76"],
Cell[111820, 3182, 3066, 73, 455, "Input",ExpressionUUID->"18d408a8-975e-4292-a455-e6e87b6c43e3",
 InitializationCell->True],
Cell[114889, 3257, 160, 3, 33, "Text",ExpressionUUID->"7c9b8bfb-27ee-4e9a-97b6-f2efdc07d295"],
Cell[115052, 3262, 5381, 105, 408, "Input",ExpressionUUID->"c42cf060-04d7-48c2-8ec4-c5eb16536aa0",
 InitializationCell->True],
Cell[120436, 3369, 168, 3, 35, "Text",ExpressionUUID->"13ef4a8c-5559-41ac-920d-7467f28351b5"],
Cell[120607, 3374, 5487, 107, 359, "Input",ExpressionUUID->"2cf635ad-5e26-49d4-94cc-bc109eb42bc0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[126131, 3486, 189, 3, 73, "Subsection",ExpressionUUID->"bc6c8c2c-27ed-40b6-b9b0-f08cf23b81e4"],
Cell[126323, 3491, 302, 7, 82, "Text",ExpressionUUID->"a745c6e0-e5a8-4b5b-a7f9-3f923696e96e"],
Cell[126628, 3500, 178, 3, 35, "Text",ExpressionUUID->"e1444801-8a4e-4f08-9264-20405bec94a4"],
Cell[126809, 3505, 540, 13, 36, "Input",ExpressionUUID->"cad749e8-2009-4294-a6fa-aafbd1e462ed",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[127386, 3523, 369, 6, 51, "Subsection",ExpressionUUID->"f207f47b-677b-4af0-a386-3e0ee3429e61"],
Cell[127758, 3531, 1207, 21, 83, "Input",ExpressionUUID->"4c142c50-7678-4680-b73e-f8b94400c2ba",
 InitializationCell->True],
Cell[128968, 3554, 1750, 36, 175, "Input",ExpressionUUID->"e6dabc90-1baf-4b0a-a227-bf58f4aa1750",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[130755, 3595, 164, 3, 73, "Subsection",ExpressionUUID->"9001db16-9dfc-4ba0-8eac-802accec4de9"],
Cell[130922, 3600, 406, 9, 147, "Text",ExpressionUUID->"b3f844f5-a258-4499-9448-f9ab2060ac50"],
Cell[131331, 3611, 177, 3, 35, "Text",ExpressionUUID->"ec9e6aa8-5f74-40d1-8f65-b54e3ffd3c4e"],
Cell[131511, 3616, 596, 15, 36, "Input",ExpressionUUID->"e4f31443-c54d-4fb3-9c70-e73920150f2c",
 InitializationCell->True],
Cell[132110, 3633, 233, 6, 35, "Text",ExpressionUUID->"3c28b024-15bd-4603-8fd2-5bd444327d8a"],
Cell[132346, 3641, 1050, 28, 129, "Input",ExpressionUUID->"e327ad35-c076-4c29-abb7-3428adcd2cd5",
 InitializationCell->True],
Cell[133399, 3671, 270, 6, 35, "Text",ExpressionUUID->"c1a3e333-5b3c-4fd7-af01-6092b8ab20f4"],
Cell[133672, 3679, 1047, 28, 129, "Input",ExpressionUUID->"6db39fca-9aca-4e89-8fe4-c2b1a1e10cf6",
 InitializationCell->True],
Cell[134722, 3709, 259, 6, 35, "Text",ExpressionUUID->"5e931837-fee9-4eea-9169-7eb0afb38638"],
Cell[134984, 3717, 490, 12, 36, "Input",ExpressionUUID->"e1a763f1-094b-4596-9eb9-19623aecc636",
 InitializationCell->True],
Cell[135477, 3731, 300, 5, 35, "Text",ExpressionUUID->"68d4fa72-2b3a-4526-8a9c-4577d62fe881"],
Cell[135780, 3738, 768, 19, 36, "Input",ExpressionUUID->"ecd29be6-740b-40af-a415-0318c3e6520c",
 InitializationCell->True],
Cell[136551, 3759, 203, 3, 35, "Text",ExpressionUUID->"086a3630-051b-41d2-84d0-9995791d85f6"],
Cell[136757, 3764, 1710, 43, 221, "Input",ExpressionUUID->"b48c954a-d25b-45bf-9354-001e0d8b68a0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[138504, 3812, 225, 4, 73, "Subsection",ExpressionUUID->"315a16a7-7bf8-455a-8ffd-19365dfe98ed"],
Cell[138732, 3818, 164, 2, 35, "Text",ExpressionUUID->"893319f7-c5f2-4e09-b028-84c8e6c0203b"],
Cell[138899, 3822, 1397, 36, 60, "Input",ExpressionUUID->"b429441f-b60a-4653-9a3f-b7589f1d4d51",
 InitializationCell->True],
Cell[140299, 3860, 365, 8, 35, "Text",ExpressionUUID->"ff6f5481-0f29-4a48-96e8-eb57ae0bf04f"],
Cell[140667, 3870, 6027, 167, 474, "Input",ExpressionUUID->"7460a864-dce1-4d88-b39f-205c330b60d6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[146731, 4042, 210, 3, 73, "Subsection",ExpressionUUID->"90f821f2-b9a5-4a62-87f9-087404e52d13"],
Cell[146944, 4047, 293, 5, 50, "Text",ExpressionUUID->"4f722cb1-4fb3-4a7c-aaaf-e640a11f4801"],
Cell[147240, 4054, 351, 7, 58, "Text",ExpressionUUID->"67ed1771-6925-4989-b61a-b69aed3240cd"],
Cell[147594, 4063, 2085, 47, 152, "Input",ExpressionUUID->"83fade24-20fd-4f48-a3d1-7268706e1029",
 InitializationCell->True],
Cell[149682, 4112, 1535, 41, 129, "Input",ExpressionUUID->"e9607b60-e9a2-488e-8466-62860abdb8d0",
 InitializationCell->True],
Cell[151220, 4155, 623, 10, 81, "Text",ExpressionUUID->"2ebeeaba-db8e-492f-826b-4432b170a2ae"],
Cell[151846, 4167, 2974, 61, 336, "Input",ExpressionUUID->"6393b46a-38b3-4bdf-805f-2bac89c50777",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[154857, 4233, 261, 4, 51, "Subsection",ExpressionUUID->"119def20-e74c-4f49-82dd-93c3e038f11d"],
Cell[155121, 4239, 1901, 53, 175, "Input",ExpressionUUID->"eb772ea5-a470-40e3-937f-2b7f32740c6d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[157059, 4297, 162, 3, 73, "Subsection",ExpressionUUID->"d14cb426-a917-4473-8770-d181b23bddd9"],
Cell[157224, 4302, 240, 4, 50, "Text",ExpressionUUID->"b9cffe91-6e02-42b5-97ad-5dc6aa5924ff"],
Cell[157467, 4308, 195, 3, 35, "Text",ExpressionUUID->"7f1f7cde-148b-42e0-b634-a9939cdc75bd"],
Cell[157665, 4313, 2391, 56, 175, "Input",ExpressionUUID->"b44dd5cc-d4b5-4dd3-b47e-8fc5f423881e",
 InitializationCell->True],
Cell[160059, 4371, 1719, 46, 152, "Input",ExpressionUUID->"0e30c5f1-9c58-4485-884b-120129fcb209",
 InitializationCell->True],
Cell[161781, 4419, 926, 17, 148, "Text",ExpressionUUID->"367fda31-d9f2-4831-9785-c10aedb9c052"],
Cell[162710, 4438, 451, 10, 82, "Text",ExpressionUUID->"6796f733-1303-4aa1-b021-e57a12f47c19"],
Cell[163164, 4450, 667, 12, 116, "Text",ExpressionUUID->"c4a25967-c964-4b26-aebd-2628957bee43"],
Cell[163834, 4464, 2080, 40, 552, "Program",ExpressionUUID->"97703f55-f5d9-4692-90b6-cfb7ca53da60"],
Cell[165917, 4506, 648, 11, 58, "Text",ExpressionUUID->"a31b350c-c8da-4fbc-9e5b-1157416b8869"],
Cell[166568, 4519, 8963, 213, 773, "Input",ExpressionUUID->"943b1d9e-debf-4fae-91eb-fee55293f537",
 InitializationCell->True],
Cell[175534, 4734, 191, 3, 35, "Text",ExpressionUUID->"10624c2f-9137-43e5-a2f0-7e8faaf8f543"],
Cell[175728, 4739, 3140, 77, 290, "Input",ExpressionUUID->"fe4d46a4-25d5-465f-bb60-8f41a74dd336",
 InitializationCell->True],
Cell[178871, 4818, 380, 9, 58, "Text",ExpressionUUID->"1539d336-3366-4704-ae27-4361a55e98ab"],
Cell[179254, 4829, 5166, 122, 451, "Input",ExpressionUUID->"eba71194-cce8-49de-8ec6-90d0fa139378",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[184457, 4956, 307, 5, 61, "Subsection",ExpressionUUID->"6855f0a2-aced-475d-8145-d65ea6df9e01"],
Cell[184767, 4963, 347, 7, 103, "Text",ExpressionUUID->"f06a1957-99fb-4adc-8ebe-a4d936cf15bd"],
Cell[185117, 4972, 2092, 57, 198, "Input",ExpressionUUID->"35bd0df5-0357-46fe-b125-bad891509c84",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[187258, 5035, 346, 5, 91, "Section",ExpressionUUID->"9436bc2c-5a58-4537-a88b-0615f8eb7d7b"],
Cell[CellGroupData[{
Cell[187629, 5044, 227, 4, 61, "Subsection",ExpressionUUID->"eab35f1d-7b7a-4c68-9ad1-d64d543f907f"],
Cell[187859, 5050, 714, 13, 58, "Text",ExpressionUUID->"6e7e72f8-ec0b-4f60-a3f9-f6212eacfeb5"],
Cell[188576, 5065, 2292, 51, 198, "Input",ExpressionUUID->"a5f88697-d8c7-4310-b9b0-362422f6ed87",
 InitializationCell->True],
Cell[190871, 5118, 3213, 69, 359, "Input",ExpressionUUID->"4a25313d-05de-4bb5-bcfc-daebe52a3b5b",
 InitializationCell->True],
Cell[194087, 5189, 2498, 57, 221, "Input",ExpressionUUID->"5717155a-3261-4bf0-b1eb-9a0f4292f210",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[196622, 5251, 210, 4, 51, "Subsection",ExpressionUUID->"c5a8f3bf-142d-475d-9a2f-fac178e1b1df"],
Cell[196835, 5257, 1713, 39, 152, "Input",ExpressionUUID->"b46e65f5-e5f6-4264-8ad2-b4437021e4ba",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[198585, 5301, 167, 3, 73, "Subsection",ExpressionUUID->"b271bbc9-2798-49b3-92a8-e1c3bc2cf6ac"],
Cell[198755, 5306, 183, 3, 35, "Text",ExpressionUUID->"4f27f78d-8627-49a9-8dbc-aee5b9fc9b98"],
Cell[198941, 5311, 889, 22, 152, "Input",ExpressionUUID->"921df90d-9c98-4de0-99a9-0afe4005b576",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[199867, 5338, 221, 4, 73, "Subsection",ExpressionUUID->"ee1987dc-d220-4ff3-926b-79b05188eafd"],
Cell[200091, 5344, 183, 3, 35, "Text",ExpressionUUID->"3151d00b-35bc-4bd3-943d-64c500b9aa63"],
Cell[200277, 5349, 939, 22, 152, "Input",ExpressionUUID->"7e33fd43-0b1a-4a4d-8df7-d710babdda97",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[201253, 5376, 291, 4, 51, "Subsection",ExpressionUUID->"42533957-f700-4762-b8a8-3e4b38b77eb7"],
Cell[201547, 5382, 1288, 31, 175, "Input",ExpressionUUID->"7dd0dcb7-f208-4bc2-af9b-dc58c78ed1b4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[202872, 5418, 239, 4, 51, "Subsection",ExpressionUUID->"d13d086d-626c-4878-bdf3-7ed6e1f82970"],
Cell[203114, 5424, 1113, 27, 129, "Input",ExpressionUUID->"c18aba31-17ff-4806-9493-221125f0faa0",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[204276, 5457, 200, 3, 109, "Section",ExpressionUUID->"02b01af3-b007-4e61-81b4-ff7d1677ce0e"],
Cell[CellGroupData[{
Cell[204501, 5464, 205, 3, 51, "Subsection",ExpressionUUID->"7bb03c93-0b31-41eb-b777-696879545d30"],
Cell[204709, 5469, 1711, 41, 106, "Input",ExpressionUUID->"a99f6009-ad9f-4ae8-b359-f3bb1f9474a4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[206457, 5515, 211, 3, 51, "Subsection",ExpressionUUID->"962a3146-39fb-4e35-bfa2-0d6ef9f94334"],
Cell[206671, 5520, 1164, 28, 198, "Input",ExpressionUUID->"db645404-d0fa-4500-bb6a-0de957e49236",
 InitializationCell->True],
Cell[207838, 5550, 1499, 36, 175, "Input",ExpressionUUID->"b47a2ff1-ff7e-40b4-bbc7-8d246daf030e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[209374, 5591, 311, 5, 73, "Subsection",ExpressionUUID->"eb23eaa0-c86a-4a33-94d7-6ad9117cca07"],
Cell[209688, 5598, 515, 9, 35, "Text",ExpressionUUID->"c3a4942e-9246-4b22-8306-32a8f83abfe6"],
Cell[210206, 5609, 370, 8, 36, "Input",ExpressionUUID->"5fc87673-89fa-4461-a27d-d2377d7c978e",
 InitializationCell->True],
Cell[210579, 5619, 7985, 171, 888, "Input",ExpressionUUID->"31f6d5f2-0e2f-4e6d-82da-4eedfd0e3ec3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[218601, 5795, 297, 5, 51, "Subsection",ExpressionUUID->"d105aff9-a39a-4077-9215-59051d8589a3"],
Cell[218901, 5802, 5011, 113, 635, "Input",ExpressionUUID->"40b753a6-40bd-46e5-b10f-03581097ea3f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[223949, 5920, 262, 4, 73, "Subsection",ExpressionUUID->"8389f1db-b38f-4147-a7a3-f6ed2ffb532e"],
Cell[224214, 5926, 572, 12, 126, "Text",ExpressionUUID->"ab580001-ed81-489d-b40f-ca2a87793ed8"],
Cell[224789, 5940, 3266, 73, 474, "Input",ExpressionUUID->"63938740-489f-44b0-bc04-51ea1b9bb387",
 InitializationCell->True],
Cell[228058, 6015, 723, 16, 194, "Text",ExpressionUUID->"facbe1ca-c57e-437a-8467-daed48b58e5b"],
Cell[228784, 6033, 3071, 73, 382, "Input",ExpressionUUID->"270ba7f2-54bd-4c3a-9b28-1d882e7f7f56",
 InitializationCell->True],
Cell[231858, 6108, 162, 3, 35, "Text",ExpressionUUID->"ae1911d4-0209-48f3-bef3-091906a37d48"],
Cell[232023, 6113, 551, 14, 60, "Input",ExpressionUUID->"e12c4aca-79ed-4233-bb28-c12b953faaba",
 InitializationCell->True],
Cell[232577, 6129, 1914, 49, 244, "Input",ExpressionUUID->"67be76ff-6c59-4ad8-9a7f-0caff2aec96a",
 InitializationCell->True],
Cell[234494, 6180, 158, 3, 35, "Text",ExpressionUUID->"9a333f1f-0c51-40ab-84b8-991801f040ad"],
Cell[234655, 6185, 581, 13, 60, "Input",ExpressionUUID->"d9438c2c-73a0-4b20-b45a-e834c48b1491",
 InitializationCell->True],
Cell[235239, 6200, 1489, 35, 244, "Input",ExpressionUUID->"9ec51478-8b7d-425b-9c4b-c6d4bff7273b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[236765, 6240, 213, 6, 51, "Subsection",ExpressionUUID->"96c92f09-199d-4601-a29b-eea0d31de146"],
Cell[236981, 6248, 629, 15, 36, "Input",ExpressionUUID->"23b9e74b-ddf1-4eef-871d-1c48425513c9",
 InitializationCell->True],
Cell[237613, 6265, 1194, 29, 83, "Input",ExpressionUUID->"890216dd-f9af-4de6-bfaa-6fed8d3ba3b6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[238844, 6299, 180, 3, 61, "Subsection",ExpressionUUID->"4b1b2b1b-ebe3-42e2-b30e-b3bc3d731510"],
Cell[239027, 6304, 307, 8, 81, "Text",ExpressionUUID->"5348deef-b22c-4fef-851c-ec6130345979"],
Cell[239337, 6314, 933, 22, 129, "Input",ExpressionUUID->"135bd993-7478-45ec-8385-cad0185c97c6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[240307, 6341, 359, 5, 61, "Subsection",ExpressionUUID->"5b633170-b2a3-46c1-b405-220908dd3675"],
Cell[240669, 6348, 248, 4, 35, "Text",ExpressionUUID->"acaac66f-022d-4746-ba1e-083f7f0764b9"],
Cell[240920, 6354, 890, 22, 60, "Input",ExpressionUUID->"f9ba3b2f-150d-4d80-b9aa-e53d1c90babc",
 InitializationCell->True],
Cell[241813, 6378, 303, 5, 35, "Text",ExpressionUUID->"29037edf-6991-4561-bfa2-553370660b92"],
Cell[242119, 6385, 2377, 53, 198, "Input",ExpressionUUID->"ab9b8320-6a64-4b5f-81e7-640d306d0bf5",
 InitializationCell->True],
Cell[244499, 6440, 532, 10, 35, "Text",ExpressionUUID->"9b0c022f-477e-455e-8031-68ee42e4bbae"],
Cell[245034, 6452, 2037, 50, 244, "Input",ExpressionUUID->"925b6722-ad41-4dd1-95ca-b7800382c7ab",
 InitializationCell->True],
Cell[247074, 6504, 952, 17, 103, "Text",ExpressionUUID->"38537657-6d59-43c0-89bf-194b32deedd6"],
Cell[248029, 6523, 5108, 110, 566, "Input",ExpressionUUID->"0e713f4a-831d-4872-849a-9fca1fec2071",
 InitializationCell->True],
Cell[253140, 6635, 2355, 46, 129, "Input",ExpressionUUID->"1579c434-6461-4294-9358-a7c2d64e6ec8",
 InitializationCell->True],
Cell[255498, 6683, 5926, 129, 566, "Input",ExpressionUUID->"8c001baf-c0a9-48aa-9591-03fc7e710f0f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[261461, 6817, 398, 6, 61, "Subsection",ExpressionUUID->"ba3f1f8f-f208-4fd9-8446-909f492b9281"],
Cell[261862, 6825, 201, 4, 35, "Text",ExpressionUUID->"c9991a1b-f1e2-4a86-81e6-0c3f292c94b8"],
Cell[262066, 6831, 1970, 43, 106, "Input",ExpressionUUID->"55941cf2-a011-4d99-b5e7-0273d2060e24",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[264073, 6879, 442, 6, 61, "Subsection",ExpressionUUID->"6dbaaaba-c0e7-438e-b78f-6a8e6c9dffaf"],
Cell[264518, 6887, 229, 4, 35, "Text",ExpressionUUID->"41ad5978-0c0d-4de9-ab6a-3bd855d8a724"],
Cell[264750, 6893, 1146, 23, 60, "Input",ExpressionUUID->"5800b731-bf5a-479c-a63b-fe6db1ee48e0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[265933, 6921, 178, 3, 51, "Subsection",ExpressionUUID->"887fa97e-feb8-4398-8917-22514c97723d"],
Cell[266114, 6926, 1958, 54, 129, "Input",ExpressionUUID->"96054c7c-ebc5-482a-9a32-e396f805510c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[268109, 6985, 220, 4, 61, "Subsection",ExpressionUUID->"fa0b5d91-2205-46eb-8b6a-567a5cebcda6"],
Cell[268332, 6991, 308, 7, 35, "Text",ExpressionUUID->"f36740db-66a6-480c-9edb-97467757f3c1"],
Cell[268643, 7000, 2113, 45, 221, "Input",ExpressionUUID->"b457ae4b-755f-485f-bd87-11ba88efe18a",
 InitializationCell->True],
Cell[270759, 7047, 2044, 43, 290, "Input",ExpressionUUID->"7a724276-29d3-4483-bafe-d72073b4687e",
 InitializationCell->True],
Cell[272806, 7092, 3129, 65, 382, "Input",ExpressionUUID->"7977a511-b899-422e-8747-0a516b28dce1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[275972, 7162, 167, 3, 51, "Subsection",ExpressionUUID->"a2c9d2d3-88ce-4089-8f14-9219f1fc0c51"],
Cell[276142, 7167, 393, 9, 83, "Input",ExpressionUUID->"da5249fd-61ef-4813-8a89-490bb1181379",
 InitializationCell->True],
Cell[276538, 7178, 2925, 75, 267, "Input",ExpressionUUID->"999a9aa2-bec6-4878-9ee3-1c176d4d9005",
 InitializationCell->True],
Cell[279466, 7255, 3066, 62, 520, "Input",ExpressionUUID->"337e38a1-411f-4a6e-952d-35cd1aec7f32",
 InitializationCell->True],
Cell[282535, 7319, 6124, 126, 681, "Input",ExpressionUUID->"710d1db2-19a7-4d23-9a24-5bd24c129dcf",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[288696, 7450, 177, 3, 51, "Subsection",ExpressionUUID->"6cd4da06-9712-437d-9abd-1850084c62be"],
Cell[288876, 7455, 893, 21, 83, "Input",ExpressionUUID->"a7191430-34bf-4ff3-8238-914902054d37",
 InitializationCell->True],
Cell[289772, 7478, 8024, 203, 1026, "Input",ExpressionUUID->"9e3ea4af-e7c1-48a1-9b1f-d318020f98d4",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[297845, 7687, 174, 3, 76, "Section",ExpressionUUID->"41af34dd-f204-4731-8cba-bfedb2d9cd81"],
Cell[298022, 7692, 1478, 39, 221, "Input",ExpressionUUID->"0f0de0a5-c073-4fee-b2a9-8637a7d65e55",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[299525, 7735, 596, 16, 160, "Input",ExpressionUUID->"775213dd-0b62-4d91-9194-6acb7f40e32a"],
Cell[300124, 7753, 324, 9, 103, "Output",ExpressionUUID->"e9c2e1ff-6fd0-481f-b1c0-cf49428d26f3"],
Cell[300451, 7764, 261, 6, 36, "Output",ExpressionUUID->"43c9a27d-6bd6-4cf6-b22b-22a2f6b9a611"]
}, Open  ]],
Cell[300727, 7773, 412, 11, 36, "Input",ExpressionUUID->"3f2456ef-ecf1-43ff-bd6c-df7b5dfcec15",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[301164, 7788, 251, 6, 97, "Input",ExpressionUUID->"cea61754-d874-40ae-8c7f-5edbe43d4afd"],
Cell[301418, 7796, 221, 5, 103, "Output",ExpressionUUID->"b1ba9b71-ce63-42fd-b4ab-a687f30924b8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[301688, 7807, 155, 3, 252, "Section",ExpressionUUID->"bc9488d0-f4f2-4362-b194-7782d02d070f"],
Cell[CellGroupData[{
Cell[301868, 7814, 164, 2, 51, "Subsection",ExpressionUUID->"624a67f1-14b4-417d-9bb1-d24c34a59989"],
Cell[302035, 7818, 154, 4, 36, "Input",ExpressionUUID->"40950cd5-425c-4006-a27e-5764d045ff06",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[302226, 7827, 167, 3, 51, "Subsection",ExpressionUUID->"8b096421-c5ed-4306-92cd-1b3e8062c7f3"],
Cell[302396, 7832, 464, 13, 83, "Input",ExpressionUUID->"a1553bee-01e2-4cda-a256-14ad4c274d92",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

